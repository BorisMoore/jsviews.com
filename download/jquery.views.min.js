/*! JsViews v1.0.0-alpha: http://github.com/BorisMoore/jsviews and http://jsviews.com/jsviews
informal pre V1.0 commit counter: 54 (Beta Candidate) */
(function(n,t,i){"use strict";function fr(n){var t=this.linkedElem;t&&et({target:t[0]},i,n)}function et(n,r,u){var w,tt,l,e,b,a,o,k,s,v,it,d,nt,f,h,y,p=n.target,ut=p._jsvBnd,ft=/&(\d+)\+?/g;if(ut)while(v=ft.exec(ut))if((v=c[v[1]])&&(h=v.to)){if(e=v.linkCtx,s=e.view,f=e.tag,k=t(p),d=s.hlp(pt),nt=s.hlp(wt),l=ot(p),w=dt[l],u===i&&(u=rt(l)?l(p):w?k[w]():k.attr(l)),a=h[1],h=h[0],a&&(b=rt(a)?a:s.getRsc("converters",a)),b&&(u=b.call(f,u)),it=s.linkCtx,s.linkCtx=e,y={change:"change",oldValue:e._val,value:u},(!d||!(tt=d.call(e,n,y)===!1))&&(!f||!f.onBeforeChange||!(tt=f.onBeforeChange(n,y)===!1))&&u!==i&&(o=h[0],u!==i&&o)){if(o=o._jsvOb?o._ob:o,f&&(f._.chging=!0),g(o).setProperty(h[2]||h[1],u),nt&&nt.call(e,n,y),f){if(f.onAfterChange)f.onAfterChange(n,y);delete f._.chging}e._val=u}s.linkCtx=it}}function vu(n,t,u){var c,e,f,p,o=this,y=o.data,a=o.elem,l=o.convert,w=a.parentNode,k=w,s=o.view,d=s.ctx,b=s.linkCtx,v=s.hlp(pt);if(s.linkCtx=o,w&&(!v||!(t&&v.call(o,n,t)===!1))&&!(t&&n.data.prop!=="*"&&n.data.prop!==t.path)){if(t&&(o.eventArgs=t),t||o._initVal){if(delete o._initVal,e=u.call(s.tmpl,y,s,r),c=yu(e,o,f=o.tag,o.attr||ot(a,!0,l!==i)),e&&e.error!==i)e=e.error;else if(f){if(e=e[0]?e:[e],p=t&&f.onUpdate&&f.onUpdate(n,t,e)===!1,yr(f,e),p||c==="none"){c===h&&f.onBeforeLink&&f.onBeforeLink();ct(f,f.tagCtx);ei(o,y,a);s.linkCtx=b;return}if(f._.chging)return;e=f.tagName.slice(-1)===":"?r._cnvt(f.tagName.slice(0,-1),s,e[0]):r._tag(f,s,s.tmpl,e,!0)}else u._tag&&(l=l===""?"true":l,e=l?r._cnvt(l,s,e):r._tag(u._tag,s,s.tmpl,e,!0),f=s._.tag,c=o.attr||c);er(e,o,c,f)&&t&&(v=s.hlp(wt))&&v.call(o,n,t)}f&&(f.contents=hi,f.nodes=ci,f.childTags=li,f.update=fr,f.refresh=pr,ct(f,f.tagCtx));ei(o,y,a);s.linkCtx=b}}function yu(n,r,u,f){var e,h,c,o,s=u&&u.parentElem||r.elem;if(n!==i){if(o=t(s),f=u&&u.attr||f,rt(n)&&k(r.expr+": missing parens"),f==="visible"&&(f="css-display"),c=/^css-/.test(f)&&f.slice(4))e=t.style(s,c),+n===n&&(e=parseInt(e));else if(f!=="link"){if(f==="value")s.type===bt&&(e=o.prop(f=p));else if(f===ft)if(s.value===""+n)e=o.prop(p);else return f;e===i&&(h=dt[f],e=h?o[h]():o.attr(f))}r._val=e}return f}function er(n,r,u,f){var tt,o,c,k,it,w,a,b,v,y,d=n!==i,rt=r.data,e=f&&f.parentElem||r.elem,g=t(e),s=r.view,nt=r._val,ut=s.ctx,et=s.linkCtx,l=f||u===h;if(f&&(f.parentElem=f.parentElem||r.expr||f._elCnt?e:e.parentNode,o=f._prv,c=f._nxt),!d){u===h&&f&&f.onBeforeLink&&f.onBeforeLink();return}if(/^css-/.test(u))r.attr==="visible"&&(n=n?pu(e):"none"),(l=l||nt!==n)&&t.style(e,u.slice(4),n);else if(u!=="link"){if(u===p)w=1,n=n&&n!=="false";else if(u===ft)if(e.value===""+n)n=!0,w=1,u=p;else{ei(r,rt,e);return}else(u==="selected"||u==="disabled"||u==="multiple"||u==="readonly")&&(n=n&&n!=="false"?u:null);(tt=dt[u])?u===h?(s.linkCtx=r,s.ctx=r.ctx,f&&f._.inline?(it=f.nodes(!0),f._elCnt&&(o&&o!==c?yi(o,c,e,f._tgId,"^",!0):(a=e._dfr)&&(b=f._tgId+"^",v=a.indexOf("#"+b)+1,y=a.indexOf("/"+b),v&&y>0&&(v+=b.length,y>v&&(e._dfr=a.slice(0,v)+a.slice(y),br(a.slice(v,y))))),o=o?o.previousSibling:c?c.previousSibling:e.lastChild),t(it).remove(),f&&f.onBeforeLink&&f.onBeforeLink(),k=s.link(s.data,e,o,c,n,f&&{tag:f._tgId,lazyLink:f.tagCtx.props.lazyLink})):(d&&g.empty(),f&&f.onBeforeLink&&f.onBeforeLink(),d&&(k=s.link(rt,e,o,c,n,f&&{tag:f._tgId}))),s.linkCtx=et,s.ctx=ut):(l=l||nt!==n)&&(u==="text"&&e.children&&!e.children[0]?e.textContent!==i?e.textContent=n:e.innerText=n===null?"":n:g[tt](n)):(l=l||nt!==n)&&g[w?"prop":"attr"](u,n===i&&!w?null:n);r._val=n}return k||l}function or(n,t){var i=this,r=i.hlp(pt),u=i.hlp(wt);if(!r||r.call(this,n,t)!==!1){if(t){var o=t.change,f=t.index,e=t.items;switch(o){case"insert":i.addViews(f,e);break;case"remove":i.removeViews(f,e.length);break;case"move":i.refresh();break;case"refresh":i.refresh()}}u&&u.call(this,n,t)}}function pu(t){var i,u,f=n.getComputedStyle,r=(t.currentStyle||f.call(n,t,"")).display;return r!=="none"||(r=ir[u=t.nodeName])||(i=e.createElement(u),e.body.appendChild(i),r=(f?f.call(n,i,""):i.currentStyle).display,ir[u]=r,e.body.removeChild(i)),r}function ui(n){var f,e,u=n.data,r=n._.bnd;if(!n._.useKey&&r)if((e=n._.bndArr)&&(t([e[1]]).off(yt,e[0]),n._.bndArr=i),r!==!!r&&r._.inline)u?r._.arrVws[n._.id]=n:delete r._.arrVws[n._.id];else if(u){f=function(t){t.data&&t.data.off||or.apply(n,arguments)};t([u]).on(yt,f);n._.bndArr=[f,u]}}function ot(n,t,i){var u=n.nodeName.toLowerCase(),r=f.merge[u]||n.contentEditable==="true"&&{to:h,from:h};return r?t?u==="input"&&n.type===ft?ft:r.to:r.from:t?i?"text":h:""}function sr(n,r,u,f,e,o,s){var p,c,v,w,b,l=n.parentElem,h=n._prv,a=n._nxt,y=n._elCnt;if(h&&h.parentNode!==l&&k("Missing parentNode"),s){w=n.nodes();y&&h&&h!==a&&yi(h,a,l,n._.id,"_",!0);n.removeViews(i,i,!0);c=a;y&&(h=h?h.previousSibling:a?a.previousSibling:l.lastChild);t(w).remove();for(b in n._.bnds)lt(b)}else{if(r){if(v=f[r-1],!v)return!1;h=v._nxt}y?(c=h,h=c?c.previousSibling:l.lastChild):c=h.nextSibling}p=u.render(e,o,n._.useKey&&s,n,s||r,!0);n.link(e,l,h,c,p,v)}function fi(n,t,r){var u,f,e;return r?(e="^`",f=t._.tag||{_:{inline:!0,bnd:r},tagCtx:{view:t},flow:!0},u=f._tgId,u||(c[u=rr++]=f,f._tgId=""+u)):(e="_`",a[u=t._.id]=t),"#"+u+e+(n!=i?n:"")+"/"+u+e}function ei(n,t,r){var e,l,f,u=n.tag,a=n.convertBack,o=[],h=n._bndId||""+rr++,v=n._hdlr;if(delete n._bndId,u&&(o=u.depends||o,o=rt(o)?u.depends(u):o,f=u.linkedElem),(!n._depends||""+n._depends!=""+o)&&(n._depends&&g._apply(!1,[t],n._depends,v,!0),e=g._apply(!1,[t],n.fn.paths,o,v,n._ctxCb),e.elem=r,e.linkCtx=n,e._tgId=h,r._jsvBnd=r._jsvBnd||"",r._jsvBnd+="&"+h,n._depends=o,n.view._.bnds[h]=h,c[h]=e,f&&(e.to=[[],a]),(f||a!==i)&&vr(e,u&&u.convertBack||a),u)){if(u.onAfterBind)u.onAfterBind(e);u.flow||u._.inline||(r.setAttribute(s,(r.getAttribute(s)||"")+"#"+h+"^/"+h+"^"),u._tgId=""+h)}if(f&&f[0])for(u._.radio&&(f=f.children("input[type=radio]")),l=f.length;l--;)f[l]._jsvBnd=f[l]._jsvBnd||r._jsvBnd+"+",f[l]._jsvLnkdEl=u}function hr(n,t,i,r,u,f,e){return oi(this,n,t,i,r,u,f,e)}function oi(n,r,u,o,s,h,c,v){if(n&&r){if(r=r.jquery?r:t(r),!w){w=e.body;t(w).on(ki,et).on("blur","[contenteditable]",function(n){var t=f.noValidate;f.noValidate=!0;et(n);f.noValidate=t})}for(var k,nt,tt,g,p,d,y,it,rt=fi,ft=o&&o.target==="replace",ut=r.length;ut--;)if(y=r[ut],""+n===n)p=b(y),it=p.ctx,p.ctx=o,st(n,y,p,u),p.ctx=it;else{if(h=h||b(y),n.markup!==i)h.link===!1&&(o=o||{},o.link=rt=!1),ft&&(d=y.parentNode),tt=n.render(u,o,s,h,i,rt),d?(c=y.previousSibling,v=y.nextSibling,t.cleanData([y],!0),d.removeChild(y),y=d):(c=v=i,t(y).empty());else if(n!==!0)break;if(y._dfr&&!v){for(g=l(y._dfr,1,ur),k=0,nt=g.length;k<nt;k++)p=g[k],(p=a[p.id])&&p.data!==i&&p.parent.removeViews(p._.key,i,!0);y._dfr=""}h.link(u,y,c,v,tt,i,o)}}return r}function wu(n,r,u,h,y,p,w,d){function cu(n,t,r,u,e,o,h,c,l,a,v,p,w){var b,d="";return w?(oi=0,n):(g=c||l||"",u=u||a,r=r||p,vi&&!r&&(u||g||o)&&(vi=i,rt=bt.shift()),u=u||r,u&&(oi=0,vi=i,f.noValidate||(r||p?ri[rt]||/;svg;|;math;/.test(";"+bt.join(";")+";")||(b="'<"+rt+".../"):ri[u]?b="'<\/"+u:bt.length&&u===rt||(b="Mismatch: '<\/"+u),b&&ni(b+">' in:\n"+y)),ur=ut,rt=bt.shift(),ut=ii[rt],a=a?"<\/"+a+">":"",ur&&(lt+=vt,vt="",ut?lt+="-":(d=a+gi+"@"+lt+di+(v||""),lt=ou.shift()))),ut?(o?vt+=o:t=a||p||"",g&&(t+=g,vt&&(t+=" "+s+'="'+vt+'"',vt=""))):t=o?t+d+e+gi+o+di+h+g:d||n,oi&&o&&ni(" No {^{ tags within elem markup ("+oi+' ). Use data-link="..."'),g&&(oi=g,bt.unshift(rt),rt=g.slice(1),bt[0]&&bt[0]===eu[rt]&&k("Parent of <tr> must be <tbody>"),vi=ri[rt],(ut=ii[rt])&&!ur&&(ou.unshift(lt),lt=""),ur=ut,lt&&ut&&(lt+="+")),t)}function pi(n,t){var o,l,u,e,f,v,s,h=[];if(n){for(n._tkns.charAt(0)==="@"&&(t=nt.previousSibling,nt.parentNode.removeChild(nt),nt=i),pt=n.length;pt--;){if(et=n[pt],u=et.ch,o=et.path)for(ft=o.length-1;l=o.charAt(ft--);)l==="+"?o.charAt(ft)==="-"?(ft--,t=t.previousSibling):t=t.parentNode:t=t.lastChild;u==="^"?(g=c[f=et.id])&&(s=t&&(!nt||nt.parentNode!==t),(!nt||s)&&(g.parentElem=t),et.elCnt&&s&&(t._dfr=(et.open?"#":"/")+f+u+(t._dfr||"")),h.push([s?null:nt,et])):(tt=a[f=et.id])&&(tt.parentElem||(tt.parentElem=t||nt&&nt.parentNode||r,tt._.onRender=fi,tt._.onArrayChange=or,ui(tt)),e=tt.parentElem,et.open?(tt._elCnt=et.elCnt,t?t._dfr="#"+f+u+(t._dfr||""):(tt._prv||(e._dfr=ht(e._dfr,"#"+f+u)),tt._prv=nt)):(t&&(!nt||nt.parentNode!==t)?(t._dfr="/"+f+u+(t._dfr||""),tt._nxt=i):nt&&(tt._nxt||(e._dfr=ht(e._dfr,"/"+f+u)),tt._nxt=nt),si=tt.linkCtx,(v=tt.ctx&&tt.ctx.onAfterCreate||vu)&&v.call(si,tt)))}for(pt=h.length;pt--;)sr.push(h[pt])}return!n||n.elCnt}function au(n){var t,i;if(n)for(pt=n.length,ft=0;ft<pt;ft++)if(et=n[ft],at.id)at.id=at.id!==et.id&&at.id;else if(i=g=c[et.id].linkCtx.tag,!g.flow){if(!yr){for(t=1;i=i.parent;)t++;ir=ir||t}(yr||t===ir)&&(!wr||g.tagName===wr)&&vr.push(g)}}function gr(){for(hr=ti?r.querySelectorAll(it):t(it,r).get(),dt=hr.length,u&&u.innerHTML&&(bi=ti?u.querySelectorAll(it):t(it,u).get(),u=bi.length?bi[bi.length-1]:u),ir=0,yt=0;yt<dt;yt++)if(nt=hr[yt],u&&!ru)ru=nt===u;else if(h&&nt===h)break;else nt.parentNode&&hu(l(nt,i,vr&&lu))&&!at&&nt.getAttribute(v)&&sr.push([nt]);if(lr(u,ut),lr(h,ut),at){wt&&wt.resolve();return}for(ut&&lt+vt&&(nt=h,lt&&(h?pi(l(lt+"+",1),h):pi(l(lt,1),r)),pi(l(vt,1),r),h&&(ot=h.getAttribute(s),(dt=ot.indexOf(er)+1)&&(ot=ot.slice(dt+er.length-1)),h.setAttribute(s,vt+ot))),dt=sr.length,yt=0;yt<dt;yt++)nt=sr[yt],kt=nt[1],nt=nt[0],kt?(g=c[kt.id])&&((si=g.linkCtx)&&(g=si.tag,g.linkCtx=si),kt.open?(nt&&(g.parentElem=nt.parentNode,g._prv=nt),g._elCnt=kt.elCnt,!g||g.onBeforeLink&&g.onBeforeLink()===!1||g._.bound||(g._.bound=!0,tt=g.tagCtx.view,st(i,g._prv,tt,n,kt.id)),g._.linking=!0):(g._nxt=nt,g._.linking&&(br=g.tagCtx,tt=br.view,g.contents=hi,g.nodes=ci,g.childTags=li,g.update=fr,g.refresh=pr,delete g._.linking,g._.bound||(g._.bound=!0,st(i,g._prv,tt,n,kt.id)),ct(g,br)))):(tt=b(nt),st(nt.getAttribute(v),nt,tt,n,i,w));wt&&wt.resolve()}var oi,si,g,yt,dt,ft,pt,hr,nt,tt,et,kt,bi,ki,cr,nr,gt,vr,yr,wr,br,ir,at,nu,kr,iu,ai,rt,vi,yi,rr,ot,ut,ur,ei,vt,er,ru,wt,dr=this,fu=dr._.id+"_",lt="",sr=[],bt=[],ou=[],vu=dr.hlp(tu),hu=pi;if(p&&(wt=p.lazyLink&&t.Deferred(),p.tmpl?cr="/"+p._.id+"_":(at=p.get,p.tag&&(fu=p.tag+"^",p=!0)),p=p===!0),at&&(hu=au,vr=at.tags,yr=at.deep,wr=at.name),r=r?""+r===r?t(r)[0]:r.jquery?r[0]:r:dr.parentElem||e.body,rt=r.tagName.toLowerCase(),ut=!!ii[rt],u=u&&ar(u,ut),h=h&&ar(h,ut)||null,y!=i){if(rr=e.createElement("div"),yi=rr,er=vt="",ei=r.namespaceURI==="http://www.w3.org/2000/svg"?"svg_ns":(ai=uu.exec(y))&&ai[1]||"",wi&&ai&&ai[2]&&k("Unsupported: "+ai[2]),ut){for(gt=h;gt&&!(nr=l(gt));)gt=gt.nextSibling;(ot=nr?nr._tkns:r._dfr)&&(ki=cr||"",(p||!cr)&&(ki+="#"+fu),ft=ot.indexOf(ki),ft+1&&(ft+=ki.length,er=vt=ot.slice(0,ft),ot=ot.slice(ft),nr?gt.setAttribute(s,ot):r._dfr=ot))}if(vi=i,y=(""+y).replace(su,cu),!f.noValidate&&bt.length&&ni("Mismatched '<"+rt+"...>' in:\n"+y),d)return;for(tr.appendChild(rr),ei=o[ei]||o.div,nu=ei[0],yi.innerHTML=ei[1]+y+ei[2];nu--;)yi=yi.lastChild;for(tr.removeChild(rr),kr=e.createDocumentFragment();iu=yi.firstChild;)kr.appendChild(iu);r.insertBefore(kr,h)}return wt?setTimeout(gr,0):gr(),wt&&wt.promise()}function st(n,t,r,f,e,o){var b,v,p,l,k,d,y,w,a,s,g;if(f=r.data===i?f||{}:r.data,e)s=c[e],s=s.linkCtx?s.linkCtx.tag:s,a=s.linkCtx||{data:f,elem:s._elCnt?s.parentElem:t,view:r,ctx:r.ctx,attr:h,fn:s._.bnd,tag:s,_bndId:e},cr(a,a.fn);else if(n&&t)for(b=r.tmpl,n=bu(n,ot(t)),nt.lastIndex=0;v=nt.exec(n);)g=nt.lastIndex,p=e?h:v[1],y=v[3],k=v[10],l=i,a={data:f,elem:s&&s._elCnt?s.parentElem:t,view:r,ctx:o||r.ctx,attr:p,_initVal:!v[2]},v[6]&&(!p&&(l=/:([\w$]*)$/.exec(k))&&(l=l[1],l!==i&&(d=-l.length-1,y=y.slice(0,d-1)+tt,k=k.slice(0,d))),l===null&&(l=i),a.convert=v[5]||""),a.expr=p+y,w=b.links[y],w||(b.links[y]=w=u.tmplFn(y,b,!0,l)),a.fn=w,p||l===i||(a.convertBack=l),cr(a,w),nt.lastIndex=g}function cr(n,t){function i(i,r){vu.call(n,i,r,t)}i.noArray=!0;n._ctxCb=ku(n.view);n._hdlr=i;i(!0)}function ht(n,t){var i;return n?(i=n.indexOf(t),i+1?n.slice(0,i)+n.slice(i+t.length):n):""}function si(n){return n&&(""+n===n?n:n.tagName==="SCRIPT"?n.type.slice(3):n.nodeType===1&&n.getAttribute(s)||"")}function l(n,t,i){function e(n,t,i,r,e,o){u.push({elCnt:f,id:r,ch:e,open:t,close:i,path:o,token:n})}var f,r,u=[];if(r=t?n:si(n))return u.elCnt=!n.type,f=r.charAt(0)==="@"||!n.type,u._tkns=r,r.replace(i||au,e),u}function lr(n,t){n&&(n.type==="jsv"?n.parentNode.removeChild(n):t&&n.getAttribute(v)===""&&n.removeAttribute(v))}function ar(n,t){for(var i=n;t&&i&&i.nodeType!==1;)i=i.previousSibling;return i&&(i.nodeType!==1?(i=e.createElement("SCRIPT"),i.type="jsv",n.parentNode.insertBefore(i,n)):si(i)||i.getAttribute(v)||i.setAttribute(v,"")),i}function bu(n,i){return n=t.trim(n).replace(fu,"\\$&"),n.slice(-1)!==tt?n=vt+":"+n+(i?":":"")+tt:n}function hi(n,r){n!==!!n&&(r=n,n=i);var f,u=t(this.nodes());return u[0]&&(f=r?u.filter(r):u,u=n&&r?f.add(u.find(r)):f),u}function ci(n,t,i){var r,u=this,f=u._elCnt,o=!t&&f,e=[];for(t=t||u._prv,i=i||u._nxt,r=o?t===u._nxt?u.parentElem.lastSibling:t:u._.inline===!1?t||u.linkCtx.elem.firstChild:t&&t.nextSibling;r&&(!i||r!==i);)(n||f||r.tagName!=="SCRIPT")&&e.push(r),r=r.nextSibling;return e}function li(n,t){n!==!!n&&(t=n,n=i);var r=this,o=r.link?r:r.tagCtx.view,u=r._prv,f=r._elCnt,e=[];return u&&o.link(i,r.parentElem,f?u.previousSibling:u,r._nxt,i,{get:{tags:e,deep:n,name:t,id:f&&r._tgId}}),e}function ct(n,t){var f,r,s,e,o,a,v,l,y=t.view,h=n.linkCtx=n.linkCtx||{tag:n,data:y.data,view:y,ctx:y.ctx};if(n.onAfterLink)n.onAfterLink(t,h);if(f=n.targetTag?n.targetTag.linkedElem:n.linkedElem,f&&(r=f[0])&&((s=n._.radio)&&(f=f.children("input[type=radio]")),s||!n._.chging)){if(e=u.cvt(n,n.convert)[0],s||r!==h.elem){for(v=f.length;v--;){if(r=f[v],l=r._jsvLnkdEl,n._.inline&&(!l||l!==n&&l.targetTag!==n))for(r._jsvLnkdEl=n,o=h.elem?h.elem._jsvBnd:n._prv._jsvBnd,r._jsvBnd=o+"+",o=o.slice(1).split("&"),a=o.length;a--;)vr(c[o[a]],n.convertBack);s&&(r[p]=e===r.value)}h._val=e}s||r.value===i||e===i||(r.type===bt?r[p]=e&&e!=="false":f.val(e))}}function vr(n,t){var e,f,s,i,o,r=n.linkCtx,h=r.data,u=r.fn.paths;if(n){for((e=u._jsvto)&&(u=e),f=u.length;f&&""+(i=u[--f])!==i;);i&&(!r.tag||r.tag.tagCtx.args.length)?(i=i.split("^").join("."),n.to=i.charAt(0)==="."?[[o=u[f-1],i.slice(1)],t]:[r._ctxCb(s=f?u[0].split("^").join("."):i)||[h,s],t],e&&o&&(n.to[0][0]=r._ctxCb(o,h))):n.to=[[],t]}}function yr(n,i){var u,f,e=n.tagCtx.view,o=n.tagCtxs||[n.tagCtx],s=o.length,h=!i;for(i=i||n._.bnd.call(e.tmpl,e.data,e,r);s--;)u=o[s],f=i[s],t.observable(u.props).setProperty(f.props),d(u.ctx,f.ctx),u.args=f.args,h&&(u.tmpl=f.tmpl);return o}function pr(n){var u,f,t=this,e=t.linkCtx,o=t.tagCtx.view;return t.disposed&&k("Removed tag"),n===i&&(n=r._tag(t,o,o.tmpl,yr(t),!0)),n+""===n&&(f=t._.inline?h:e.attr||ot(t.parentElem,!0),u=er(n,e,f,t)),ct(t,t.tagCtx),u||t}function ai(n){for(var u,t,i,f=[],e=n.length,r=e;r--;)f.push(n[r]);for(r=e;r--;)if(t=f[r],t.parentNode){if(i=t._jsvBnd)for(i=i.slice(1).split("&"),t._jsvBnd="",u=i.length;u--;)lt(i[u],t._jsvLnkdEl,t);br(si(t)+(t._dfr||""))}}function lt(n,i,r){var h,l,f,o,s,a,v,y,e=c[n];if(i)r===i.linkedElem[0]&&(delete r._jsvLnkdEl,delete i.linkedElem);else if(e){for(h in e.bnd)o=e.bnd[h],s=".obs"+e.cbId,t.isArray(o)?t([o]).off(yt+s).off(bi+s):t(o).off(bi+s),delete e.bnd[h];if(l=e.linkCtx){if(f=l.tag){if(a=f.tagCtxs)for(v=a.length;v--;)(y=a[v].map)&&y.unmap();f.onDispose&&f.onDispose();f._elCnt||(f._prv&&f._prv.parentNode.removeChild(f._prv),f._nxt&&f._nxt.parentNode.removeChild(f._nxt));f.disposed=!0}delete l.view._.bnds[n]}delete c[n];delete u._cbBnds[e.cbId]}}function vi(n,r){return n===i?(w&&(t(w).off(ki,et),w=i),n=!0,y.removeViews(),ai(e.body.getElementsByTagName("*"))):r&&(r=r.jquery?r:t(r),n===!0&&r.each(function(){for(var n;(n=b(this,!0))&&n.parent;)n.parent.removeViews(n._.key,i,!0);ai(this.getElementsByTagName("*"))})),r}function wr(n,t){return vi(this,n,t)}function ku(n){return n=n||t.view(),function(t,i){var f,u,e=[i];if(n&&t){if(t._jsvOb)return t._jsvOb.call(n.tmpl,i,n,r);if(t.charAt(0)==="~")return t.slice(0,4)==="~tag"&&(u=n.ctx,t.charAt(4)==="."&&(f=t.slice(5).split("."),u=u.tag),f)?u?[u,f.join("."),i]:[]:(t=t.slice(1).split("."),(i=n.hlp(t.shift()))&&(t.length&&e.unshift(t.join(".")),e.unshift(i)),i?e:[]);if(t.charAt(0)==="#")return t==="#data"?[]:[n,t.replace(ou,""),i]}}}function du(n){return n.type===bt?n[p]:n.value}function yi(n,t,i,r,u,f){var y,h,p,o,b,v,e,w=0,k=n===t;if(n){for(p=l(n)||[],y=0,h=p.length;y<h;y++){if(o=p[y],v=o.id,v===r&&o.ch===u)if(f)h=0;else break;k||(b=o.ch==="_"?a[v]:c[v].linkCtx.tag,o.open?b._prv=t:o.close&&(b._nxt=t));w+=v.length+2}w&&n.setAttribute(s,n.getAttribute(s).slice(w));e=t?t.getAttribute(s):i._dfr;(h=e.indexOf("/"+r+u)+1)&&(e=p._tkns.slice(0,w)+e.slice(h+(f?-1:r.length+1)));e&&(t?t.setAttribute(s,e):i._dfr=e)}else i._dfr=ht(i._dfr,"#"+r+u),f||t||(i._dfr=ht(i._dfr,"/"+r+u))}function br(n){var r,f,t,u;if(u=l(n,1,hu))for(r=0,f=u.length;r<f;r++)t=u[r],t.ch==="_"?(t=a[t.id])&&t.data!==i&&t.parent.removeViews(t._.key,i,!0):lt(t.id)}function gu(n,i,r,u){switch(u.change){case"set":for(var f=i.length;f--;)if(i[f].key===u.path)break;f===-1?u.path&&t.observable(i).insert({key:u.path,prop:u.value}):u.remove?t.observable(i).remove(f):t.observable(i[f]).setProperty("prop",u.value)}}function nf(n,i,r,u){var f;switch(u.change){case"set":u.path==="prop"?t.observable(n).setProperty(r.target.key,u.value):(t.observable(n).setProperty(u.oldValue,null),delete n[u.oldValue],t.observable(n).setProperty(u.value,r.target.prop));break;case"remove":f=u.items[0];t.observable(n).removeProperty(f.key);delete n[f.key];break;case"insert":f=u.items[0];f.key&&t.observable(n).setProperty(f.key,f.prop)}}function tf(n,t,i){return i.indexOf(".")<0&&t[n]}var at="JsViews requires ",w,b,nt,kr,vt,tt,dr,pi,wi,k,v,it,o,y,a,e=n.document,r=t.views,u=r.sub,f=r.settings,d=u.extend,rt=t.isFunction,gr=r.templates,nu=r.converters,g=t.observable,ut=g.observe,s="data-jsv",bi=u.propChng=u.propChng||"propertyChange",yt=u.arrChng=u.arrChng||"arrayChange",rf=u._cbBnds=u._cbBnds||{},ki="change.jsv",pt="onBeforeChange",wt="onAfterChange",tu="onAfterCreate",p="checked",bt="checkbox",ft="radio",di='"><\/script>',gi='<script type="jsv',kt="script,["+s+"]",h="html",dt={value:"val",input:"val",html:h,text:"text"},nr={from:"value",to:"value"},gt=0,iu=t.cleanData,ru=f.delimiters,ni=u.syntaxErr,uu=/<(?!script)(\w+)(?:[^>]*(on\w+)\s*=)?[^>]*>/,fu=/['"\\]/g,tr=e.createDocumentFragment(),ti=e.querySelector,ii={ol:1,ul:1,table:1,tbody:1,thead:1,tfoot:1,tr:1,colgroup:1,dl:1,select:1,optgroup:1,svg:1,svg_ns:1},eu={tr:"table"},ri={br:1,img:1,input:1,hr:1,area:1,base:1,col:1,link:1,meta:1,command:1,embed:1,keygen:1,param:1,source:1,track:1,wbr:1},ir={},c={},rr=1,ou=/^#(view\.?)?/,su=/(^|(\/>)|<\/(\w+)>|)(\s*)([#\/]\d+[_^])`(\s*)(<\w+(?=[\s\/>]))?|\s*(?:(<\w+(?=[\s\/>]))|<\/(\w+)>(\s*)|(\/>)\s*|(>))/g,ur=/(#)()(\d+)(_)/g,hu=/(#)()(\d+)([_^])/g,cu=/(?:(#)|(\/))(\d+)(_)/g,lu=/(#)()(\d+)(\^)/g,au=/(?:(#)|(\/))(\d+)([_^])([-+@\d]+)?/g;if(!t)throw at+"jQuery";if(!t.views)throw at+"JsRender";if(!t.observable)throw at+"jquery.observable";t.link||(u.onStoreItem=function(n,i,r){r&&n===gr&&(r.link=hr,r.unlink=wr,i&&(t.link[i]=function(){return hr.apply(r,arguments)},t.unlink[i]=function(){return wr.apply(r,arguments)}))},(f.delimiters=function(){var n=ru.apply(r,arguments);return kr=n[0],vt=n[1],tt=n[2],dr=n[3],pi=n[4],nt=new RegExp("(?:^|\\s*)([\\w-]*)(\\"+pi+")?(\\"+vt+u.rTag+"\\"+tt+")","g"),this})(),u.viewInfos=l,d(u.View.prototype,{addViews:function(n,t,i){var u,o,r=this,f=t.length,e=r.views;if(!r._.useKey&&f&&(i=r.tmpl)&&(o=e.length+f,sr(r,n,i,e,t,r.ctx)!==!1))for(u=n+f;u<o;u++)g(e[u]).setProperty("index",u);return r},removeViews:function(n,r,u){function o(n){var s,h,c,e,o,l,r=f[n];if(r&&r.link){if(s=r._.id,u||(l=r.nodes()),r.removeViews(i,i,!0),r.data=i,e=r._prv,o=r._nxt,c=r.parentElem,u||(r._elCnt&&yi(e,o,c,s,"_"),t(l).remove()),!r._elCnt)try{e.parentNode.removeChild(e);o.parentNode.removeChild(o)}catch(v){}ui(r);for(h in r._.bnds)lt(h);delete a[s]}}var e,l,s,h=this,c=!h._.useKey,f=h.views;if(c&&(s=f.length),n===i)if(c){for(e=s;e--;)o(e);h.views=[]}else{for(l in f)o(l);h.views={}}else if(r===i&&(c?r=1:(o(n),delete f[n])),c&&r){for(e=n+r;e-->n;)o(e);if(f.splice(n,r),s=f.length)while(n<s)g(f[n]).setProperty("index",n++)}return this},refresh:function(n){var t=this,i=t.parent;return i&&(sr(t,t.index,t.tmpl,i.views,t.data,n,!0),ui(t)),t},nodes:ci,contents:hi,childTags:li,link:wu}),y=new u.View(i,"top"),a={0:y},nu.merge=function(n){var t,i=this.linkCtx._val||"",r=this.tagCtx.props.toggle;return r&&(t=r.replace(/[\\^$.|?*+()[{]/g,"\\$&"),t="(\\s(?="+t+"$)|(\\s)|^)("+t+"(\\s|$))",i=i.replace(new RegExp(t),"$2"),n=i+(n?(i&&" ")+r:"")),n},r.tags("on",{attr:"none",onAfterLink:function(n,r){var a=this,c=t(r.elem),o=n.args,e=n.props.data,s=n.view,h=o.pop(),l=o[1]||null,f=n.props.context;if(e=e!==i?e:null,f||(f=/^(.*)[\.^][\w$]+$/.exec(n.params.args.slice(-1)[0]),f=f&&u.tmplFn("{:"+f[1]+"}",s.tmpl,!0)(r.data,s)),h&&h.call)c.on(o[0]||"click",l,e,function(n){h.call(f||r.data,n,{change:n.type,view:s,linkCtx:r})})},flow:!0}),d(r.tags["for"],{onArrayChange:function(n,t){var i,r=this,u=t.change;if(r.tagCtxs[1]&&(u==="insert"&&n.target.length===t.items.length||u==="remove"&&!n.target.length||u==="refresh"&&!t.oldItems.length!=!n.target.length))r.refresh();else for(i in r._.arrVws)i=r._.arrVws[i],i.data===n.target&&i._.onArrayChange.apply(i,arguments);n.done=!0},onAfterLink:function(){for(var u,o,i,f,e=this,r=e._ars||{},s=e.tagCtxs,c=s.length,h=e.selected||0,n=0;n<=h;n++)u=s[n],f=u.map?u.map.tgt:u.args.length?u.args[0]:u.view.data,(i=r[n])&&f!==i[0]&&(ut(i[0],i[1],!0),delete r[n]),!r[n]&&t.isArray(f)&&(ut(f,o=function(n,t){e.onArrayChange(n,t)}),r[n]=[f,o]);for(n=h+1;n<c;n++)(i=r[n])&&(ut(i[0],i[1],!0),delete r[n]);e._ars=r},onDispose:function(){var n,t=this;for(n in t._ars)ut(t._ars[n][0],t._ars[n][1],!0)}}),r.tags({props:t.extend({},r.tags["for"],u.DataMap(r.tags.props.getTgt,gu,nf,i,tf))}),d(t,{view:r.view=b=function(n,r,u){r!==!!r&&(u=r,r=i);var f,o,h,c,w,s,b,v,p=0,k=e.body;if(n&&n!==k&&y._.useKey>1&&(n=""+n===n?t(n)[0]:n.jquery?n[0]:n,n))if(r){for(v=ti?n.querySelectorAll(kt):t(kt,n).get(),s=v.length,h=0;h<s;h++)for(b=v[h],o=l(b,i,ur),c=0,w=o.length;c<w;c++)if(f=o[c],(f=a[f.id])&&(f=f&&u?f.get(!0,u):f,f))return f}else while(n){if(o=l(n,i,cu))for(s=o.length;s--;)if(f=o[s],f.open){if(p<1)return f=a[f.id],f&&u?f.get(u):f||y;p--}else p++;n=n.previousSibling||n.parentNode}return r?i:y},link:r.link=oi,unlink:r.unlink=vi,cleanData:function(n){n.length&&gt&&ai(n);iu.apply(t,arguments)}}),r.utility={validate:function(n){try{y.link(i,e.createElement("div"),i,i,n,i,i,1)}catch(t){return t.message}}},d(t.fn,{link:function(n,t,i,r,u,f,e){return oi(n,this,t,i,r,u,f,e)},unlink:function(n){return vi(n,this)},view:function(n){return b(this[0],n)}}),t.each([h,"replaceWith","empty","remove"],function(n,i){var r=t.fn[i];t.fn[i]=function(){var n;gt=1;try{n=r.apply(this,arguments)}finally{gt=0}return n}}),d(y,{tmpl:{links:{},tags:{}}}),y._.onRender=fi,f({wrapMap:o={option:[1,"<select multiple='multiple'>","<\/select>"],legend:[1,"<fieldset>","<\/fieldset>"],area:[1,"<map>","<\/map>"],param:[1,"<object>","<\/object>"],thead:[1,"<table>","<\/table>"],tr:[2,"<table><tbody>","<\/tbody><\/table>"],td:[3,"<table><tbody><tr>","<\/tr><\/tbody><\/table>"],col:[2,"<table><tbody><\/tbody><colgroup>","<\/colgroup><\/table>"],svg_ns:[1,"<svg>","<\/svg>"],div:jQuery.support.htmlSerialize?[0,"",""]:[1,"X<div>","<\/div>"]},linkAttr:v="data-link",merge:{input:{from:du,to:"value"},textarea:nr,select:nr,optgroup:{to:"label"}},jsrDbgMode:f.debugMode,debugMode:function(t){f.jsrDbgMode(t);t?n._jsv={views:a,bindings:c}:delete n._jsv},jsv:function(){f.debugMode(f._dbgMode);v=f.linkAttr;k=r._err;it=kt+",["+v+"]";wi=f.noDomLevel0;o.optgroup=o.option;o.tbody=o.tfoot=o.colgroup=o.caption=o.thead;o.th=o.td}}))})(this,this.jQuery);
/*
//# sourceMappingURL=jquery.views.min.js.map
*/