/*! jquery.views.js v0.9.73 (Beta): http://jsviews.com/ */
!function(e){var t=(0,eval)("this"),n=t.jQuery;"function"==typeof define&&define.amd?define(["jquery","./jsrender","./jquery.observable"],e):"object"==typeof exports?module.exports=n?e(n):function(t){return e(t)}:e(!1)}(function(e,t,n){"use strict";function i(t,n,i){var r,a,o,l,s,d,v,p,c,g,u,h,_,m,b,k,x,C=t.target,y=C._jsvBnd;if(y)for(;g=rt.exec(y);)if((g=We[g[1]])&&(b=g.to)){if(l=g.linkCtx,c=l.view,m=l.tag,p=e(C),h=c.hlp(we),_=c.hlp(je),o=f(C),r=Pe[o],void 0===i&&(i=ae(o)?o(C):r?p[r]():p.attr(o)),d=b[1],b=b[0],b=b+""===b?[l.data,b]:b,d&&(s=ae(d)?d:c.getRsc("converters",d)),"SELECT"===l.elem.nodeName&&(l.elem._jsvSel=i=i||(l.elem.multiple?[]:i)),s&&(i=s.call(m,i)),u=c.linkCtx,c.linkCtx=l,k={change:"change",oldValue:l._val,value:i},!(h&&(a=h.call(l,t,k)===!1)||m&&m.onBeforeChange&&(a=m.onBeforeChange(t,k)===!1)||void 0===i)&&(v=b[0],void 0!==i&&v)){if(v._jsv)for(x=v,v=l.data;x&&x.sb;)v=l._ctxCb(x,v),x=x.sb;m&&(m._.chging=!0),K(v).setProperty(b[2]||b[1],i),_&&_.call(l,t,k),m&&(m.onAfterChange&&m.onAfterChange(t,k),m._.chging=void 0),l._val=i}c.linkCtx=u}}function r(e,t,n){var i,r,o,s,d,v,p=this,g=p.tag,u=p.data,h=p.elem,_=p.convert,m=h.parentNode,b=p.view,k=b.linkCtx,x=b.hlp(we);if(b.linkCtx=p,!(!m||x&&t&&x.call(p,e,t)===!1||t&&"*"!==e.data.prop&&e.data.prop!==t.path)){if(t&&(p.eventArgs=t),t||p._toLk){if(p._toLk=0,n._er)try{r=n(u,b)}catch(C){d=n._er,v=Z(C,b,new Function("data,view","return "+d+";")(u,b)),r=[{props:{},args:[v]}]}else r=n(u,b,J);if(i=a(r,p,g=p.tag,p.attr||f(h,!0,void 0!==_)),g){if(s=d||g._er,r=r[0]?r:[r],o=!s&&t&&g.onUpdate&&g.onUpdate(e,t,r)===!1,B(g,r,s),o||i===Ne)return i===fe&&g.onBeforeLink&&g.onBeforeLink(),j(g),c(p,u,h),void(b.linkCtx=k);if(g._.chging)return;r=":"===g.tagName?J._cnvt(g.cvt,b,r[0]):J._tag(g,b,b.tmpl,r,!0,v)}else n._tag&&(_=""===_?Ie:_,r=_?J._cnvt(_,b,r[0]||r):J._tag(n._tag,b,b.tmpl,r,!0,v),q(g=p.tag,!0),i=p.attr||i);l(r,p,i,g)&&t&&(x=b.hlp(je))&&x.call(p,e,t),p._noUpd=0,g&&(g._er=d,j(g,t))}c(p,u,h),b.linkCtx=k}}function a(t,n,i,r){var a,o,l,s,d=i&&i.parentElem||n.elem;if(void 0!==t){if(s=e(d),r=i&&i.attr||r,ae(t)&&Z(n.expr+": missing parens"),l=/^css-/.test(r)&&r.slice(4))a=e.style(d,l),+t===t&&(a=parseInt(a));else if("link"!==r){if("value"===r)d.type===Le&&(a=s.prop(r=Ee));else if(r===Be){if(d.value!==""+t)return r;a=s.prop(Ee)}void 0===a&&(o=Pe[r],a=o?s[o]():s.attr(r))}n._val=a}return r}function o(e,t){e._df=t,e[(t?"set":"remove")+"Attribute"](De,"")}function l(t,n,i,r){var a,l,s,d,f,v,p,g,u,h,_,m,b,k,x=i!==Ne&&void 0!==t&&!n._noUpd,C=n.data,y=r&&r.parentElem||n.elem,w=y.parentNode,j=e(y),A=n.view,E=n._val,L=A.linkCtx,B=r||i===fe;if(r&&(r.parentElem=r.parentElem||n.expr||r._elCnt?y:w,l=r._prv,s=r._nxt),!x)return void(i===fe&&r&&r.onBeforeLink&&r.onBeforeLink());if("visible"===i&&(i="css-display"),/^css-/.test(i))"visible"===n.attr&&(b=(y.currentStyle||at.call($,y,"")).display,t?(t=y._jsvd||b,t!==Ne||(t=Qe[m=y.nodeName])||(_=te.createElement(m),te.body.appendChild(_),t=Qe[m]=(_.currentStyle||at.call($,_,"")).display,te.body.removeChild(_))):(y._jsvd=b,t=Ne)),(B=B||E!==t)&&e.style(y,i.slice(4),t);else if("link"!==i){if(/^data-/.test(i)&&e.data(y,i.slice(5),t),i===Ee)v=!0,t=t&&"false"!==t;else if(i===Be){if(y.value!==""+t)return void c(n,C,y);t=v=!0,i=Ee}else"selected"===i||"disabled"===i||"multiple"===i||"readonly"===i?t=t&&"false"!==t?i:null:"value"===i&&"SELECT"===y.nodeName&&(y._jsvSel=H(t)?t:""+t);(a=Pe[i])?i===fe?(A.linkCtx=n,r&&r._.inline?(f=r.nodes(!0),r._elCnt&&(l&&l!==s?M(l,s,y,r._tgId,"^",!0):(p=y._df)&&(g=r._tgId+"^",u=p.indexOf("#"+g)+1,h=p.indexOf("/"+g),u&&h>0&&(u+=g.length,h>u&&(o(y,p.slice(0,u)+p.slice(h)),D(p.slice(u,h))))),l=l?l.previousSibling:s?s.previousSibling:y.lastChild),e(f).remove(),r&&r.onBeforeLink&&r.onBeforeLink(),d=A.link(A.data,y,l,s,t,r&&{tag:r._tgId,lazyLink:r.tagCtx.props.lazyLink})):(x&&j.empty(),r&&r.onBeforeLink&&r.onBeforeLink(),x&&(d=A.link(C,y,l,s,t,r&&{tag:r._tgId}))),A.linkCtx=L):((B=B||E!==t)&&("text"===i&&y.children&&!y.children[0]?void 0!==y.textContent?y.textContent=t:y.innerText=null===t?"":t:j[a](t)),!(k=w._jsvSel)||"value"!==i&&j.attr("value")||(y.selected=e.inArray(""+t,H(k)?k:[k])>-1)):(B=B||E!==t)&&j[v?"prop":"attr"](i,void 0!==t||v?t:null),n._val=t}return d||B}function s(e,t){var n=this,i=n.hlp(we),r=n.hlp(je);if(!i||i.call(this,e,t)!==!1){if(t){var a=t.change,o=t.index,l=t.items;switch(a){case"insert":n.addViews(o,l);break;case"remove":n.removeViews(o,l.length);break;case"move":n.refresh();break;case"refresh":n.refresh()}}r&&r.call(this,e,t)}}function d(t){var n,i,r=t.type,a=t.data,o=t._.bnd;!t._.useKey&&o&&((i=t._.bndArr)&&(e([i[1]]).off(de,i[0]),t._.bndArr=void 0),o!==!!o?r?o._.arrVws[t._.id]=t:delete o._.arrVws[t._.id]:r&&a&&(n=function(e){e.data&&e.data.off||s.apply(t,arguments)},e([a]).on(de,n),t._.bndArr=[n,a]))}function f(e,t,n){var i=e.nodeName.toLowerCase(),r=ne.merge[i]||e.contentEditable===Ie&&{to:fe,from:fe};return r?t?"input"===i&&e.type===Be?Be:r.to:r.from:t?n?"text":fe:""}function v(t,n,i,r,a,o,l){var s,d,f,v,p,c=t.parentElem,g=t._prv,u=t._nxt,h=t._elCnt;if(g&&g.parentNode!==c&&Z("Missing parentNode"),l){v=t.nodes(),h&&g&&g!==u&&M(g,u,c,t._.id,"_",!0),t.removeViews(void 0,void 0,!0),d=u,h&&(g=g?g.previousSibling:u?u.previousSibling:c.lastChild),e(v).remove();for(p in t._.bnds)N(p)}else{if(n){if(f=r[n-1],!f)return!1;g=f._nxt}h?(d=g,g=d?d.previousSibling:c.lastChild):d=g.nextSibling}s=i.render(a,o,t._.useKey&&l,t,l||n,!0),t.link(a,c,g,d,s,f)}function p(e,t,n){var i,r;return n?(r="^`",q(n,!0),i=n._tgId,i||(We[i=Xe++]=n,n._tgId=""+i)):(r="_`",q(ke[i=t._.id]=t)),"#"+i+r+(void 0!=e?e:"")+"/"+i+r}function c(e,t,n){var i,r,a,o,l,s=e.tag,d=e.convertBack,f=[],v=e._bndId||""+Xe++,p=e._hdl;if(e._bndId=void 0,s&&(f=s.depends||f,f=ae(f)?s.depends(s):f,a=s.linkedElem),!e._depends||""+e._depends!=""+f){for(e._depends&&K._apply(!1,[t],e._depends,p,!0),o=e.fn.deps.slice(),r=o.length;r--;)l=o[r],l._jsv&&(o[r]=re({},l));i=K._apply(!1,[t],o,f,p,e._ctxCb),i.elem=n,i.linkCtx=e,i._tgId=v,n._jsvBnd=n._jsvBnd||"",n._jsvBnd+="&"+v,e._depends=f,e.view._.bnds[v]=v,We[v]=i,a&&(i.to=[[],d]),(a||void 0!==d)&&L(i,s&&s.convertBack||d),s&&(s.onAfterBind&&s.onAfterBind(i),s.flow||s._.inline||(n.setAttribute(Ce,(n.getAttribute(Ce)||"")+"#"+v+"^/"+v+"^"),s._tgId=""+v))}if(a&&a[0])for(s._.radio&&(a=a.find(Se)),r=a.length;r--;)a[r]._jsvBnd=a[r]._jsvBnd||n._jsvBnd+"+",a[r]._jsvLkEl=s}function g(e,t,n,i,r,a,o){return u(this,e,t,n,i,r,a,o)}function u(t,n,r,a,l,s,d,f){if(a===!0?(l=a,a=void 0):a="object"!=typeof a?void 0:re({},a),t&&n){n=n.jquery?n:e(n),ge||(ge=te.body,e(ge).on(ye,i).on("blur","[contenteditable]",i));for(var v,c,g,u,h,m,b,k,C,y=p,w=a&&"replace"===a.target,j=n.length;j--;){if(b=n[j],s=s||he(b),(C=s===ee)&&(ee.data=(ee.ctx=a||{}).root=r),""+t===t)_(t,b,s,void 0,!0,r,a);else{if(void 0!==t.markup)w&&(m=b.parentNode),g=t.render(r,a,l,s,void 0,y),m?(d=b.previousSibling,f=b.nextSibling,e.cleanData([b],!0),m.removeChild(b),b=m):(d=f=void 0,e(b).empty());else{if(t!==!0||s!==ee)break;k={lnk:1}}if(b._df&&!f){for(u=x(b._df,!0,Ze),v=0,c=u.length;c>v;v++)h=u[v],(h=ke[h.id])&&void 0!==h.data&&h.parent.removeViews(h._.key,void 0,!0);o(b)}s.link(r,b,d,f,g,k,a)}C&&(ee.data=ee.ctx=void 0)}}return n}function h(t,n,i,r,a,l,f,v){function c(e,t,n,i,r,o,l,s,d,f,v,p,c,g){var u,h,_="";return g?(m=0,e):(A=d||f||"",i=i||v,n=n||c,Y&&!n&&(!e||i||A||o&&!m)&&(Y=void 0,G=Be.shift()),i=i||n,i&&(m=0,Y=void 0,K&&(n||c?Je[G]||/;svg;|;math;/.test(";"+Be.join(";")+";")||(u="'<"+G+".../"):Je[i]?u="'</"+i:Be.length&&i===G||(u="Mismatch: '</"+i),u&&ve(u+">' in:\n"+a)),oe=ae,G=Be.shift(),ae=Ke[G],v=v?"</"+v+">":"",oe&&(Ee+=se,se="",ae?Ee+="-":(_=v+Me+"@"+Ee+Ve+(p||""),Ee=Se.shift()))),ae?(o?se+=o:t=v||c||"",A&&(t+=A,se&&(t+=" "+Ce+'="'+se+'"',se=""))):t=o?t+_+r+(m?"":Me+o+Ve)+s+A:_||e,K&&l&&(m&&ve("{^{ within elem markup ("+m+' ). Use data-link="..."'),"#"===o.charAt(0)?Be.unshift(o.slice(1)):o.slice(1)!==(h=Be.shift())&&ve("Closing tag for {^{...}} under different elem: <"+h+">")),A&&(m=A,Be.unshift(G),G=A.slice(1),K&&Be[0]&&Be[0]===He[G]&&Z("Parent of <tr> must be <tbody>"),Y=Je[G],(ae=Ke[G])&&!oe&&(Se.unshift(Ee),Ee=""),oe=ae,Ee&&ae&&(Ee+="+")),t)}function g(e,t){var i,r,a,l,f,v,c,g=[];if(e){for("@"===e._tkns.charAt(0)&&(t=T.previousSibling,T.parentNode.removeChild(T),T=void 0),S=e.length;S--;){if(V=e[S],a=V.ch,i=V.path)for(B=i.length-1;r=i.charAt(B--);)"+"===r?"-"===i.charAt(B)?(B--,t=t.previousSibling):t=t.parentNode:t=t.lastChild;"^"===a?(A=We[f=V.id])&&(c=t&&(!T||T.parentNode!==t),(!T||c)&&(A.parentElem=t),V.elCnt&&c&&o(t,(V.open?"#":"/")+f+a+(t._df||"")),g.push([c?null:T,V])):(I=ke[f=V.id])&&(I.parentElem||(I.parentElem=t||T&&T.parentNode||n,I._.onRender=p,I._.onArrayChange=s,d(I)),l=I.parentElem,V.open?(I._elCnt=V.elCnt,t&&!T?o(t,"#"+f+a+(t._df||"")):(I._prv||o(l,b(l._df,"#"+f+a)),I._prv=T)):(!t||T&&T.parentNode===t?T&&(I._nxt||o(l,b(l._df,"/"+f+a)),I._nxt=T):(o(t,"/"+f+a+(t._df||"")),I._nxt=void 0),w=I.linkCtx,(v=I.ctx&&I.ctx.onAfterCreate||Ne)&&v.call(w,I)))}for(S=g.length;S--;)Le.push(g[S])}return!e||e.elCnt}function u(e){var t,n,i;if(e)for(S=e.length,B=0;S>B;B++)if(V=e[B],n=A=We[V.id].linkCtx.tag,i=A.tagName===F,!A.flow||i){if(!R){for(t=1;n=n.parent;)t++;H=H||t}!R&&t!==H||F&&!i||$.push(A)}}function h(){var o,l,s="",d={},v=me+(ye?",["+De+"]":"");for(N=ze?n.querySelectorAll(v):e(v,n).get(),L=N.length,i&&i.innerHTML&&(D=ze?i.querySelectorAll(v):e(v,i).get(),i=D.length?D[D.length-1]:i),H=0,E=0;L>E;E++)if(T=N[E],i&&!fe)fe=T===i;else{if(r&&T===r){ye&&(s+=k(T));break}if(T.parentNode)if(ye){if(s+=k(T),T._df){for(o=E+1;L>o&&T.contains(N[o]);)o++;d[o-1]=T._df}d[E]&&(s+=d[E]||"")}else ue&&(V=x(T,void 0,tt))&&(V=V[0])&&(ce=ce?V.id!==ce&&ce:V.open&&V.id),!ce&&Te(x(T))&&T.getAttribute(_e)&&Le.push([T])}if(ye&&(s+=n._df||"",(l=s.indexOf("#"+ye.id)+1)&&(s=s.slice(l+ye.id.length)),l=s.indexOf("/"+ye.id),l+1&&(s=s.slice(0,l)),u(x(s,void 0,nt))),void 0===a&&n.getAttribute(_e)&&Le.push([n]),C(i,ae),C(r,ae),ye)return void(ge&&ge.resolve());for(ae&&Ee+se&&(T=r,Ee&&(r?g(x(Ee+"+",!0),r):g(x(Ee,!0),n)),g(x(se,!0),n),r&&(s=r.getAttribute(Ce),(L=s.indexOf(de)+1)&&(s=s.slice(L+de.length-1)),r.setAttribute(Ce,se+s))),L=Le.length,E=0;L>E;E++)T=Le[E],M=T[1],T=T[0],M?(A=We[M.id])&&((w=A.linkCtx)&&(A=w.tag,A.linkCtx=w),M.open?(T&&(A.parentElem=T.parentNode,A._prv=T),A._elCnt=M.elCnt,A.onBeforeLink&&A.onBeforeLink(),I=A.tagCtx.view,_(void 0,A._prv,I,M.id)):(A._nxt=T,A._.unlinked&&(z=A.tagCtx,I=z.view,j(A)))):_(T.getAttribute(_e),T,he(T),void 0,ue,t,f);ge&&ge.resolve()}var m,w,A,E,L,B,S,N,T,I,V,M,D,q,P,U,O,$,R,F,z,K,H,J,Q,W,X,G,Y,ee,ie,re,ae,oe,le,se,de,fe,ce,ge,ue,ye,we=this,je=we._.id+"_",Ee="",Le=[],Be=[],Se=[],Ne=we.hlp(Ae),Te=g;if(l&&(ge=l.lazyLink&&e.Deferred(),l.tmpl?P="/"+l._.id+"_":(ue=l.lnk,l.tag&&(je=l.tag+"^",l=!0),(ye=l.get)&&(Te=u,$=ye.tags,R=ye.deep,F=ye.name)),l=l===!0),n=n?""+n===n?e(n)[0]:n.jquery?n[0]:n:we.parentElem||te.body,K=!ne.noValidate&&n.contentEditable!==Ie,G=n.tagName.toLowerCase(),ae=!!Ke[G],i=i&&y(i,ae),r=r&&y(r,ae)||null,void 0!=a){if(ie=te.createElement("div"),ee=ie,de=se="",le="http://www.w3.org/2000/svg"===n.namespaceURI?"svg_ns":(X=pe.exec(a))&&X[1]||"",xe&&X&&X[2]&&Z("Unsupported: "+X[2]),ae){for(O=r;O&&!(U=x(O));)O=O.nextSibling;(re=U?U._tkns:n._df)&&(q=P||"",(l||!P)&&(q+="#"+je),B=re.indexOf(q),B+1&&(B+=q.length,de=se=re.slice(0,B),re=re.slice(B),U?O.setAttribute(Ce,re):o(n,re)))}if(Y=void 0,a=(""+a).replace(Ye,c),K&&Be.length&&ve("Mismatched '<"+G+"...>' in:\n"+a),v)return;for(Fe.appendChild(ie),le=be[le]||be.div,J=le[0],ee.innerHTML=le[1]+a+le[2];J--;)ee=ee.lastChild;for(Fe.removeChild(ie),Q=te.createDocumentFragment();W=ee.firstChild;)Q.appendChild(W);n.insertBefore(Q,r)}return ge?setTimeout(h,0):h(),ge&&ge.promise()}function _(e,t,n,i,r,a,o){var l,s,d,v,p,c,g,u,h,_,b,k,x=[];if(i)h=We[i],h=h.linkCtx?h.linkCtx.tag:h,u=h.linkCtx||{data:n.data,elem:h._elCnt?h.parentElem:t,view:n,ctx:n.ctx,attr:fe,fn:h._.bnd,tag:h,_bndId:i},m(u,u.fn);else if(e&&t){for(a=r?a:n.data,l=n.tmpl,e=w(e,f(t)),k=ue.lastIndex=0;s=ue.exec(e);)x.push(s),k=ue.lastIndex;for(k<e.length&&ve(e);s=x.shift();){for(_=ue.lastIndex,d=s[1],c=s[3];x[0]&&"else"===x[0][4];)c+="}{"+x.shift()[3],b=!0;b&&(c+="}{{/"+s[4]+"}"),p=s[9],u={data:a,elem:t,view:n,ctx:o,attr:d,isLk:r,_toLk:1,_noUpd:s[2]},s[6]&&(v=s[10],u.convert=s[5]||"",!d&&void 0!==v&&f(t)?u.convertBack=v=v.slice(1):v=void 0),u.expr=d+c,g=l.links[c],g||(l.links[c]=g=ie.tmplFn(c,l,!0,v,b)),u.fn=g,m(u,g),ue.lastIndex=_}}}function m(e,t){function n(n,i){r.call(e,n,i,t)}n.noArray=!0,e.isLk&&q(e.view=new ie.View(ie.extendCtx(e.ctx,e.view.ctx),"link",e.view,e.data,e.expr,void 0,p)),e._ctxCb=I(e.view),e._hdl=n,n(!0)}function b(e,t){var n;return e?(n=e.indexOf(t),n+1?e.slice(0,n)+e.slice(n+t.length):e):""}function k(e){return e&&(""+e===e?e:e.tagName===Te?e.type.slice(3):1===e.nodeType&&e.getAttribute(Ce)||"")}function x(e,t,n){function i(e,t,n,i,a,l){o.push({elCnt:r,id:i,ch:a,open:t,close:n,path:l,token:e})}var r,a,o=[];return(a=t?e:k(e))?(r=o.elCnt=e.tagName!==Te,r="@"===a.charAt(0)||r,o._tkns=a,a.replace(n||it,i),o):void 0}function C(e,t){e&&("jsv"===e.type?e.parentNode.removeChild(e):t&&""===e.getAttribute(_e)&&e.removeAttribute(_e))}function y(e,t){for(var n=e;t&&n&&1!==n.nodeType;)n=n.previousSibling;return n&&(1!==n.nodeType?(n=te.createElement(Te),n.type="jsv",e.parentNode.insertBefore(n,e)):k(n)||n.getAttribute(_e)||n.setAttribute(_e,"")),n}function w(t,n){return t=e.trim(t).replace(ce,"\\$&"),t.slice(-1)!==X?t=W+":"+t+(n?":":"")+X:t}function j(t,n){var i,r,a,o,l,s,d,f,v=t.tagCtx,p=v.view,c=v.props,g=t.linkCtx=t.linkCtx||{tag:t,data:p.data,view:p,ctx:p.ctx};if(t.onAfterLink&&t.onAfterLink(v,g,n),t._.unlinked=void 0,i=t.targetTag?t.targetTag.linkedElem:t.linkedElem,!t.noVal&&(r=i&&i[0])){if((a=t._.radio)&&(i=i.find(Se)),a||!t._.chging){if(o=t.cvtArgs()[0],a||r!==g.elem){for(l=i.length;l--;)r=i[l],s=r._jsvLkEl,t._.inline&&(!s||s!==t&&s.targetTag!==t)&&(r._jsvLkEl=t,L(We[t._tgId],t.convertBack),r._jsvBnd="&"+t._tgId+"+"),a&&(r[Ee]=o===r.value);g._val=o}void 0!==o&&(a||void 0===r.value?r.contentEditable===Ie&&(r.innerHTML=o):r.type===Le?r[Ee]=o&&"false"!==o:i.val(o))}t.setSize&&(c.height&&i.height(c.height),c.width&&i.width(c.width)),c["class"]&&i.addClass(c["class"]),c.id&&(i[0].id=c.id),c.name&&i.attr("name",c.name)}(r=r||":"===t.tagName&&g.elem)&&(d=r._jsvTr,f=c.trigger,d!==f&&(r._jsvTr=f,i=i||e(r),E(i,d,"off"),E(i,f,"on")))}function A(e){setTimeout(function(){i(e)},0)}function E(e,t,n){t&&(t=""+t===t?t:"keydown",e[n](t,"keydown"===t?A:i))}function L(e,t){var n,i,r,a,o,l=e.linkCtx,s=l.data,d=l.fn.paths;if(e&&d)if(d=(n=d._jsvto)||d[0],i=d&&d.length,!i||l.tag&&!l.tag.tagCtx.args.length)e.to=[[],t];else{if(a=d[i-1],a._jsv){for(o=a;a.sb&&a.sb._jsv;)r=a=a.sb;r=a.sb||r&&r.path,a=r?r.slice(1):o.path}e.to=r?[[o,a],t]:[l._ctxCb(r=a.split("^").join("."))||[s,r],t]}}function B(e,t,n){var i,r,a=e.tagCtx.view,o=e.tagCtxs||[e.tagCtx],l=o.length,s=!t;if(t=t||e._.bnd.call(a.tmpl,(e.linkCtx||a).data,a,J),n)o=e.tagCtxs=t,e.tagCtx=o[0];else for(;l--;)i=o[l],r=t[l],K(i.props).setProperty(r.props),re(i.ctx,r.ctx),i.args=r.args,s&&(i.tmpl=r.tmpl);return ie._ths(e,o[0]),o}function S(e){for(var t,n,i,r=[],a=e.length,o=a;o--;)r.push(e[o]);for(o=a;o--;)if(n=r[o],n.parentNode){if(i=n._jsvBnd)for(i=i.slice(1).split("&"),n._jsvBnd="",t=i.length;t--;)N(i[t],n._jsvLkEl,n);D(k(n)+(n._df||""))}}function N(t,n,i){var r,a,o,l,s,d,f,v,p,c,g,u,h=We[t];if(n)i===n.linkedElem[0]&&(i._jsvLkEl=void 0,n.linkedElem=void 0);else if(h){delete We[t];for(r in h.bnd)l=h.bnd[r],s=h.cbId,H(l)?e([l]).off(de+s).off(se+s):e(l).off(se+s),delete h.bnd[r];if(a=h.linkCtx){if(o=a.tag){if(d=o.tagCtxs)for(f=d.length;f--;)(v=d[f].map)&&v.unmap();p=o.linkedElem,c=p&&p[0]||a.elem,(g=c&&c._jsvTr)&&(E(p||e(c),g,"off"),c._jsvTr=void 0),o.onDispose&&o.onDispose(),o._elCnt||(o._prv&&o._prv.parentNode.removeChild(o._prv),o._nxt&&o._nxt.parentNode.removeChild(o._nxt))}u=a.view,"link"===u.type?u.parent.removeViews(u._.key,void 0,!0):delete u._.bnds[t]}ie._cbBnds[h.cbId]=void 0}}function T(t){t?(t=t.jquery?t:e(t),t.each(function(){for(var e;(e=he(this,!0))&&e.parent;)e.parent.removeViews(e._.key,void 0,!0);S(this.getElementsByTagName("*"))}),S(t)):(ge&&(e(ge).off(ye,i).off("blur","[contenteditable]",i),ge=void 0),ee.removeViews(),S(te.body.getElementsByTagName("*")))}function I(e){return function(t,n){var i,r,a=[n];if(e&&t){if(t._jsv)return t._jsv.call(e.tmpl,n,e,J);if("~"===t.charAt(0))return"~tag"===t.slice(0,4)&&(r=e.ctx,"."===t.charAt(4)&&(i=t.slice(5).split("."),r=r.tag),i)?r?[r,i.join("."),n]:[]:(t=t.slice(1).split("."),(n=e.hlp(t.shift()))&&(t.length&&a.unshift(t.join(".")),a.unshift(n)),n?a:[]);if("#"===t.charAt(0))return"#data"===t?[]:[e,t.replace(Ge,""),n]}}}function V(e){return e.type===Le?e[Ee]:e.value}function M(e,t,n,i,r,a){var l,s,d,f,v,p,c,g=0,u=e===t;if(e){for(d=x(e)||[],l=0,s=d.length;s>l;l++){if(f=d[l],p=f.id,p===i&&f.ch===r){if(!a)break;s=0}u||(v="_"===f.ch?ke[p]:We[p].linkCtx.tag,f.open?v._prv=t:f.close&&(v._nxt=t)),g+=p.length+2}g&&e.setAttribute(Ce,e.getAttribute(Ce).slice(g)),c=t?t.getAttribute(Ce):n._df,(s=c.indexOf("/"+i+r)+1)&&(c=d._tkns.slice(0,g)+c.slice(s+(a?-1:i.length+1))),c&&(t?t.setAttribute(Ce,c):o(n,c))}else o(n,b(n._df,"#"+i+r)),a||t||o(n,b(n._df,"/"+i+r))}function D(e){var t,n,i,r;if(r=x(e,!0,et))for(t=0,n=r.length;n>t;t++)i=r[t],"_"===i.ch?(i=ke[i.id])&&i.type&&i.parent.removeViews(i._.key,void 0,!0):N(i.id)}function q(t,n){t.contents=function(t,n){t!==!!t&&(n=t,t=void 0);var i,r=e(this.nodes());return r[0]&&(i=n?r.filter(n):r,r=t&&n?i.add(r.find(n)):i),r},t.nodes=function(e,t,n){var i,r=this,a=r._elCnt,o=!t&&a,l=[];for(t=t||r._prv,n=n||r._nxt,i=o?t===r._nxt?r.parentElem.lastSibling:t:r._.inline===!1?t||r.linkCtx.elem.firstChild:t&&t.nextSibling;i&&(!n||i!==n);)(e||a||i.tagName!==Te)&&l.push(i),i=i.nextSibling;return l},t.childTags=function(e,t){e!==!!e&&(t=e,e=void 0);var n=this,i=n.link?n:n.tagCtx.view,r=n._prv,a=n._elCnt,o=[];return i.link(void 0,n.parentElem,a?r&&r.previousSibling:r,n._nxt,void 0,{get:{tags:o,deep:e,name:t,id:n.link?n._.id+"_":n._tgId+"^"}}),o},t.refresh=function(e){var t,n,i=this,r=i.linkCtx,a=i.tagCtx.view;return i.disposed&&Z("Removed tag"),void 0===e&&(e=J._tag(i,a,a.tmpl,B(i),!0)),e+""===e&&(n=i._.inline?fe:r.attr||f(i.parentElem,!0),t=l(e,r,n,i)),j(i),t||i},t.update=function(e){var t=this.linkedElem;t&&i({target:t[0]},void 0,e)},n?t.domChange=function(){var t=this.parentElem,n=e.hasData(t)&&e._data(t).events,i="jsv-domchange";n&&n[i]&&e(t).triggerHandler(i,arguments)}:(t.addViews=function(e,t,n){var i,r,a=this,o=t.length,l=a.views;if(!a._.useKey&&o&&(n=a.tmpl)&&(r=l.length+o,r===a.data.length&&v(a,e,n,l,t,a.ctx)!==!1))for(i=e+o;r>i;i++)K(l[i]).setProperty("index",i);return a},t.removeViews=function(t,n,i){function r(t){var n,r,a,o,l,s,f=v[t];if(f&&f.link){if(n=f._.id,i||(s=f.nodes()),f.removeViews(void 0,void 0,!0),f.type=void 0,o=f._prv,l=f._nxt,a=f.parentElem,i||(f._elCnt&&M(o,l,a,n,"_"),e(s).remove()),!f._elCnt)try{o.parentNode.removeChild(o),l.parentNode.removeChild(l)}catch(p){}d(f);for(r in f._.bnds)N(r);delete ke[n]}}var a,o,l,s=this,f=!s._.useKey,v=s.views;if(f&&(l=v.length),void 0===t)if(f){for(a=l;a--;)r(a);s.views=[]}else{for(o in v)r(o);s.views={}}else if(void 0===n&&(f?n=1:(r(t),delete v[t])),f&&n&&l-n===s.data.length){for(a=t+n;a-->t;)r(a);if(v.splice(t,n),l=v.length)for(;l>t;)K(v[t]).setProperty("index",t++)}return this},t.refresh=function(){var e=this,t=e.parent;return t&&(v(e,e.index,e.tmpl,t.views,e.data,void 0,!0),d(e)),e},t.link=h)}function P(e,t,n){if("set"===n.change){for(var i=e.tgt,r=i.length;r--&&i[r].key!==n.path;);-1===r?n.path&&!n.remove&&K(i).insert({key:n.path,prop:n.value}):n.remove?K(i).remove(r):K(i[r]).setProperty("prop",n.value)}}function U(e,t,n){var i,r=e.src,a=n.change;"set"===a?"prop"===n.path?K(r).setProperty(t.target.key,n.value):(K(r).setProperty(n.oldValue,null),delete r[n.oldValue],K(r).setProperty(n.value,t.target.prop)):"remove"===a?(i=n.items[0],K(r).removeProperty(i.key),delete r[i.key]):"insert"===a&&(i=n.items[0],i.key&&K(r).setProperty(i.key,i.prop))}function O(e){return e.indexOf(".")<0}var $=(0,eval)("this"),R=e===!1;t=t||R&&$.jsrender,e=e||$.jQuery;var F="JsViews requires ";if(!e||!e.fn)throw F+"jQuery";t&&!t.fn&&t.views.sub._jq(e);var z,K,H=e.isArray,J=e.views;if(!J||!J.settings)throw F+"JsRender";var Q,W,X,G,Y,Z,ee,te=$.document,ne=J.settings,ie=J.sub,re=ie.extend,ae=e.isFunction,oe=J.converters,le=J.tags,se=ie.propChng=ie.propChng||"propertyChange",de=ie.arrChng=ie.arrChng||"arrayChange",fe="html",ve=ie.syntaxErr,pe=/<(?!script)(\w+)(?:[^>]*(on\w+)\s*=)?[^>]*>/,ce=/['"\\]/g;if(e.link)return e;var ge,ue,he,_e,me,be,ke,xe,Ce="data-jsv",ye="change.jsv",we="onBeforeChange",je="onAfterChange",Ae="onAfterCreate",Ee="checked",Le="checkbox",Be="radio",Se="input[type=radio]",Ne="none",Te="SCRIPT",Ie="true",Ve='"></script>',Me='<script type="jsv',De=Ce+"-df",qe="script,["+Ce+"]",Pe={value:"val",input:"val",html:fe,text:"text"},Ue={from:"value",to:"value"},Oe=0,$e=e.cleanData,Re=ne.delimiters,Fe=te.createDocumentFragment(),ze=te.querySelector,Ke={ol:1,ul:1,table:1,tbody:1,thead:1,tfoot:1,tr:1,colgroup:1,dl:1,select:1,optgroup:1,svg:1,svg_ns:1},He={tr:"table"},Je={br:1,img:1,input:1,hr:1,area:1,base:1,col:1,link:1,meta:1,command:1,embed:1,keygen:1,param:1,source:1,track:1,wbr:1},Qe={},We={},Xe=1,Ge=/^#(view\.?)?/,Ye=/((\/>)|<\/(\w+)>|)(\s*)([#\/]\d+(?:_|(\^)))`(\s*)(<\w+(?=[\s\/>]))?|\s*(?:(<\w+(?=[\s\/>]))|<\/(\w+)>(\s*)|(\/>)\s*|(>)|$)/g,Ze=/(#)()(\d+)(_)/g,et=/(#)()(\d+)([_^])/g,tt=/(?:(#)|(\/))(\d+)(_)/g,nt=/(#)()(\d+)(\^)/g,it=/(?:(#)|(\/))(\d+)([_^])([-+@\d]+)?/g,rt=/&(\d+)\+?/g,at=$.getComputedStyle;if(K=e.observable,!K)throw F+"JsObservable";return z=K.observe,ie.onStore.template=function(t,n){n.link=g,t&&(e.link[t]=function(){return g.apply(n,arguments)})},ie.viewInfos=x,(ne.delimiters=function(){var e=Re.apply(0,arguments);return Q=e[0],W=e[1],X=e[2],G=e[3],Y=e[4],ue=new RegExp("(?:^|\\s*)([\\w-]*)(\\"+Y+")?(\\"+W+ie.rTag+"(:\\w*)?\\"+X+")","g"),this})(),oe.merge=function(e){var t,n=this.linkCtx._val||"",i=this.tagCtx.props.toggle;return i&&(t=i.replace(/[\\^$.|?*+()[{]/g,"\\$&"),t="(\\s(?="+t+"$)|(\\s)|^)("+t+"(\\s|$))",n=n.replace(new RegExp(t),"$2"),e=n+(e?(n&&" ")+i:"")),e},le("on",{attr:Ne,init:function(e){var t=this,n=e.props,i=e.content,r=n.elem;t._.inline&&(t.attr=fe,r=(r||"span")+">",t.template="<"+r+(n.label||i.markup||e.params.args[0])+"</"+r)},render:function(){var e=this.tagCtx;return e.render(e.view,!0)},onAfterLink:function(t,n){var i,r,a=this,o=0,l=t.args,s=l.length,d=t.props,f=d.data,v=t.view,p=d.context;for(a.activeElem=a.activeElem||e(a._.inline?(a._elCnt&&Z('Use data-link="{on...}"'),a.nodes()[0]):n.elem);s>o&&!(r=ae(i=l[o++])););r&&(r=l.slice(o),l=l.slice(0,o-1),p||(p=/^(.*)[\.^][\w$]+$/.exec(t.params.args.slice(-r.length-1)[0]),p=p&&ie.tmplFn("{:"+p[1]+"}",v.tmpl,!0)(n.data,v)),a._evs&&a.onDispose(),a.activeElem.on(a._evs=l[0]||"click",a._sel=l[1],void 0==f?null:f,a._hlr=function(e){return i.apply(p||n.data,[].concat(r,e,{change:e.type,view:v,linkCtx:n},r.slice.call(arguments,1)))}))},onUpdate:function(){return!1},onDispose:function(){this.activeElem.off(this._evs,this._sel,this._hlr)},flow:!0}),re(le["for"],{onArrayChange:function(e,t,n,i){var r,a=e.target,o=a.length,l=this,s=t.change;if(l._.noVws||l.tagCtxs[1]&&("insert"===s&&o===t.items.length||"remove"===s&&!o||"refresh"===s&&!t.oldItems.length!=!o))l.refresh();else for(r in l._.arrVws)r=l._.arrVws[r],r.data===a&&r._.onArrayChange.apply(r,arguments);l.domChange(n,i,t),e.done=!0},onAfterLink:function(e,t){var n,i,r,a,o=this,l=o._ars||{},s=o.tagCtxs,d=s.length,f=o.selected||0;for(n=0;f>=n;n++)e=s[n],a=e.map?e.map.tgt:e.args.length?e.args[0]:e.view.data,(r=l[n])&&a!==r[0]&&(z(r[0],r[1],!0),delete l[n]),!l[n]&&H(a)&&(z(a,i=function(n,i){var r=e;o.onArrayChange(n,i,r,t)}),l[n]=[a,i]);for(n=f+1;d>n;n++)(r=l[n])&&(z(r[0],r[1],!0),delete l[n]);o._ars=l},onDispose:function(){var e,t=this;for(e in t._ars)z(t._ars[e][0],t._ars[e][1],!0)}}),re(le["if"],{onUpdate:function(e,t,n){var i,r,a;for(i=0;(r=this.tagCtxs[i])&&r.args.length;i++)if(r=r.args[0],a=!r!=!n[i].args[0],!this.convert&&r||a)return a;return!1},onAfterLink:function(e,t,n){n&&this.domChange(e,t,n)}}),le("props",{baseTag:"for",dataMap:J.map({getTgt:le.props.dataMap.getTgt,obsSrc:P,obsTgt:U,tgtFlt:O}),flow:!0}),re(e,{view:J.view=he=function(t,n,i){function r(e,t){if(e)for(o=x(e,t,Ze),s=0,d=o.length;d>s&&(!(a=ke[o[s].id])||!(a=a&&i?a.get(!0,i):a));s++);}n!==!!n&&(i=n,n=void 0);var a,o,l,s,d,f,v,p=0,c=te.body;if(t&&t!==c&&ee._.useKey>1&&(t=""+t===t?e(t)[0]:t.jquery?t[0]:t)){if(n){if(r(t._df,!0),!a)for(v=ze?t.querySelectorAll(qe):e(qe,t).get(),f=v.length,l=0;!a&&f>l;l++)r(v[l]);return a}for(;t;){if(o=x(t,void 0,tt))for(f=o.length;f--;)if(a=o[f],a.open){if(1>p)return a=ke[a.id],a&&i?a.get(i):a||ee;p--}else p++;t=t.previousSibling||t.parentNode}}return ee},link:J.link=u,unlink:J.unlink=T,cleanData:function(t){t.length&&Oe&&S(t),$e.apply(e,arguments)}}),re(e.fn,{link:function(e,t,n,i,r,a,o){return u(e,this,t,n,i,r,a,o)},unlink:function(){return T(this)},view:function(e,t){return he(this[0],e,t)}}),e.each([fe,"replaceWith","empty","remove"],function(t,n){var i=e.fn[n];e.fn[n]=function(){var e;Oe=1;try{e=i.apply(this,arguments)}finally{Oe=0}return e}}),q(re(ee=ie.topView,{tmpl:{links:{}}})),ke={0:ee},ne({wrapMap:be={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],svg_ns:[1,"<svg>","</svg>"],div:e.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},linkAttr:_e="data-link",merge:{input:{from:V,to:"value"},textarea:Ue,select:Ue,optgroup:{to:"label"}},jsrDbgMode:ne.debugMode,debugMode:function(e){ne._dbgMode=e!==!1,ne._dbgMode?$._jsv={views:ke,bindings:We}:$._jsv&&($._jsv=void 0)},jsv:function(){ne.debugMode(ne._dbgMode),_e=ne.linkAttr,Z=J._err,me=qe+",["+_e+"]",xe=ne.noDomLevel0,be.optgroup=be.option,be.tbody=be.tfoot=be.colgroup=be.caption=be.thead,be.th=be.td}}),e});
//# sourceMappingURL=jquery.views.min.js.map