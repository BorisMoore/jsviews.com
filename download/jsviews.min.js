/*! jsviews.js v1.0.0-beta.65 (Beta Candidate) single-file version: http://jsviews.com/ */
/*! includes JsRender, JsObservable and JsViews - see: http://jsviews.com/#download */
!function(e){var t=(0,eval)("this"),n=t.jQuery;"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=n?e(n):function(t){return e(t)}:e(!1)}(function(e){"use strict";function t(e,t){return function(){var n,r=this,i=r.base;return r.base=e,n=t.apply(r,arguments),r.base=i,n}}function n(e,n){return Me(n)&&(n=t(e?e._d?e:t(a,e):a,n),n._d=1),n}function r(e,t){for(var r in t.props)ot.test(r)&&(e[r]=n(e[r],t.props[r]))}function i(e){return e}function a(){return""}function o(e){try{throw"dbg breakpoint"}catch(t){}return this.base?this.baseApply(arguments):e}function s(e){Ue._dbgMode=e!==!1}function l(t){this.name=(e.link?"JsViews":"JsRender")+" Error",this.message=t||this.name}function d(e,t){var n;for(n in t)e[n]=t[n];return e}function c(e,t,n){return(0!==this||e)&&(Ke=e?e.charAt(0):Ke,Je=e?e.charAt(1):Je,ze=t?t.charAt(0):ze,Qe=t?t.charAt(1):Qe,We=n||We,e="\\"+Ke+"(\\"+We+")?\\"+Je,t="\\"+ze+"\\"+Qe,Te="(?:(?:(\\w+(?=[\\/\\s\\"+ze+"]))|(?:(\\w+)?(:)|(>)|!--((?:[^-]|-(?!-))*)--|(\\*)))\\s*((?:[^\\"+ze+"]|\\"+ze+"(?!\\"+Qe+"))*?)",Oe.rTag=Te+")",Te=new RegExp(e+Te+"(\\/)?|(?:\\/(\\w+)))"+t,"g"),Ve=new RegExp("<.*>|([^\\\\]|^)[{}]|"+e+".*"+t)),[Ke,Je,ze,Qe,We]}function f(e,t){t||(t=e,e=void 0);var n,r,i,a,o=this,s=!t||"root"===t;if(e){if(a=o.type===t?o:void 0,!a)if(n=o.views,o._.useKey){for(r in n)if(a=n[r].get(e,t))break}else for(r=0,i=n.length;!a&&i>r;r++)a=n[r].get(e,t)}else if(s)for(;o.parent.parent;)a=o=o.parent;else for(;o&&!a;)a=o.type===t?o:void 0,o=o.parent;return a}function p(){var e=this.get("item");return e?e.index:void 0}function u(){return this.index}function v(e){var t,n=this,r=n.linkCtx,i=(n.ctx||{})[e];return void 0===i&&r&&r.ctx&&(i=r.ctx[e]),void 0===i&&(i=Pe[e]),i&&Me(i)&&!i._wrp&&(t=function(){return i.apply(this&&this!==je?this:n,arguments)},t._wrp=!0,d(t,i)),t||i}function g(e,t,n,i){var a,o,s="number"==typeof n&&t.tmpl.bnds[n-1],l=t.linkCtx;return void 0!==i?n=i={props:{},args:[i]}:s&&(n=s(t.data,t,Se)),o=n.args[0],(e||s)&&(a=l&&l.tag,a||(a=d(new Oe._tg,{_:{inline:!l,bnd:s,unlinked:!0},tagName:":",cvt:e,flow:!0,tagCtx:n}),l&&(l.tag=a,a.linkCtx=l),n.ctx=R(n.ctx,(l?l.view:t).ctx)),a._er=i&&o,r(a,n),n.view=t,a.ctx=n.ctx||{},n.ctx=void 0,t._.tag=a,o=a.cvtArgs(a.convert||"true"!==e&&e)[0],o=s&&t._.onRender?t._.onRender(o,t,s):o,t._.tag=void 0),void 0!=o?o:""}function h(e){var t=this,n=t.tagCtx,r=n.view,i=n.args;return e=t.convert||e,e=e&&(""+e===e?r.getRsc("converters",e)||T("Unknown converter: '"+e+"'"):e),i=i.length||n.index?e?i.slice():i:[r.data],e&&(e.depends&&(t.depends=Oe.getDeps(t.depends,t,e.depends,e)),i[0]=e.apply(t,i)),i}function _(e,t){for(var n,r,i=this;void 0===n&&i;)r=i.tmpl&&i.tmpl[e],n=r&&r[t],i=i.parent;return n||Se[e][t]}function m(e,t,n,i,a,o){t=t||Ne;var s,l,d,c,f,p,u,v,g,h,_,m,b,x,y,w,k,C,A,j="",E=t.linkCtx||0,V=t.ctx,N=n||t.tmpl,S="number"==typeof i&&t.tmpl.bnds[i-1];for("tag"===e._is?(s=e,e=s.tagName,i=s.tagCtxs,d=s.template):(l=t.getRsc("tags",e)||T("Unknown tag: {{"+e+"}} "),d=l.template),void 0!==o?(j+=o,i=o=[{props:{},args:[]}]):S&&(i=S(t.data,t,Se)),v=i.length,u=0;v>u;u++)h=i[u],(!E||!E.tag||u&&!E.tag._.inline||s._er)&&((m=h.tmpl)&&(m=h.content=N.tmpls[m-1]),h.index=u,h.tmpl=d||m,h.render=I,h.view=t,h.ctx=R(h.ctx,V)),(n=h.props.tmpl)&&(n=""+n===n?t.getRsc("templates",n)||Re(n):n,h.tmpl=n),s||(s=new l._ctr,b=!!s.init,s.parent=p=V&&V.tag,s.tagCtxs=i,A=s.dataMap,E&&(s._.inline=!1,E.tag=s,s.linkCtx=E),(s._.bnd=S||E.fn)?s._.arrVws={}:s.dataBoundOnly&&T("{^{"+e+"}} tag must be data-bound")),i=s.tagCtxs,A=s.dataMap,h.tag=s,A&&i&&(h.map=i[u].map),s.flow||(_=h.ctx=h.ctx||{},c=s.parents=_.parentTags=V&&R(_.parentTags,V.parentTags)||{},p&&(c[p.tagName]=p),c[s.tagName]=_.tag=s);if((S||E)&&(t._.tag=s),!(s._er=o)){for(r(s,i[0]),s.rendering={},u=0;v>u;u++)h=s.tagCtx=i[u],k=h.props,w=s.cvtArgs(),(x=k.dataMap||A)&&(w.length||k.dataMap)&&(y=h.map,(!y||y.src!==w[0]||a)&&(y&&y.src&&y.unmap(),y=h.map=x.map(w[0],k,void 0,!s._.bnd)),w=[y.tgt]),s.ctx=h.ctx,u||(b&&(C=s.template,s.init(h,E,s.ctx),b=void 0,s.template!==C&&(s._.tmpl=s.template)),E&&(E.attr=s.attr=E.attr||s.attr),f=s.attr,s._.noVws=f&&f!==ct),g=void 0,s.render&&(g=s.render.apply(s,w)),w.length||(w=[t]),void 0===g&&(g=h.render(w.length?w[0]:t,!0)||(a?void 0:"")),j=j?j+(g||""):g;s.rendering=void 0}return s.tagCtx=i[0],s.ctx=s.tagCtx.ctx,s._.noVws&&s._.inline&&(j="text"===f?Fe.html(j):""),S&&t._.onRender?t._.onRender(j,t,S):j}function b(e,t,n,r,i,a,o,s){var l,d,c,f,u=this,v="array"===t;u.content=o,u.views=v?[]:{},u.parent=n,u.type=t||"top",u.data=r,u.tmpl=i,f=u._={key:0,useKey:v?0:1,id:""+lt++,onRender:s,bnds:{}},u.linked=!!s,n?(l=n.views,d=n._,d.useKey?(l[f.key="_"+d.useKey++]=u,u.index=vt,u.getIndex=p,c=d.tag,f.bnd=v&&(!c||!!c._.bnd&&c)):l.length===(f.key=u.index=a)?l.push(u):l.splice(a,0,u),u.ctx=e||n.ctx):u.ctx=e}function x(e){var t,n,r,i,a,o,s;for(t in ht)if(a=ht[t],(o=a.compile)&&(n=e[t+"s"]))for(r in n)i=n[r]=o(r,n[r],e,0),i._is=t,i&&(s=Oe.onStore[t])&&s(r,i,o)}function y(e,t,r){function i(){var t=this;t._={inline:!0,unlinked:!0},t.tagName=e}var a,o,s,l=new Oe._tg;if(Me(t)?t={depends:t.depends,render:t}:""+t===t&&(t={template:t}),o=t.baseTag){t.flow=!!t.flow,t.baseTag=o=""+o===o?r&&r.tags[o]||De[o]:o,l=d(l,o);for(s in t)l[s]=n(o[s],t[s])}else l=d(l,t);return void 0!==(a=l.template)&&(l.template=""+a===a?Re[a]||Re(a):a),l.init!==!1&&((i.prototype=l).constructor=l._ctr=i),r&&(l._parentTmpl=r),l}function w(e){return this.base.apply(this,e)}function k(t,n,r,i){function a(n){var a,s;if(""+n===n||n.nodeType>0&&(o=n)){if(!o)if(/^\.\/[^\\:*?"<>]*$/.test(n))(s=Re[t=t||n])?n=s:o=document.getElementById(n);else if(e.fn&&!Ve.test(n))try{o=e(document).find(n)[0]}catch(l){}o&&(i?n=o.innerHTML:(a=o.getAttribute(pt),a?a!==ut?(n=Re[a],delete Re[a]):e.fn&&(n=e.data(o)[ut]):(t=t||(e.fn?ut:n),n=k(t,o.innerHTML,r,i)),n.tmplName=t=t||a,t!==ut&&(Re[t]=n),o.setAttribute(pt,t),e.fn&&e.data(o,ut,n))),o=void 0}else n.fn||(n=void 0);return n}var o,s,l=n=n||"";return 0===i&&(i=void 0,l=a(l)),i=i||(n.markup?n:{}),i.tmplName=t,r&&(i._parentTmpl=r),!l&&n.markup&&(l=a(n.markup))&&l.fn&&(l=l.markup),void 0!==l?(l.fn||n.fn?l.fn&&(s=l):(n=A(l,i),N(l.replace(et,"\\$&"),n)),s||(x(i),s=d(function(){return n.render.apply(n,arguments)},n)),t&&!r&&t!==ut&&(gt[t]=s),s):void 0}function C(e){function t(t,n){this.tgt=e.getTgt(t,n)}return Me(e)&&(e={getTgt:e}),e.baseMap&&(e=d(d({},e.baseMap),e)),e.map=function(e,n){return new t(e,n)},e}function A(t,n){var r,i=Ue.wrapMap||{},a=d({tmpls:[],links:{},bnds:[],_is:"template",render:I},n);return a.markup=t,n.htmlTag||(r=rt.exec(t),a.htmlTag=r?r[1].toLowerCase():""),r=i[a.htmlTag],r&&r!==i.div&&(a.markup=e.trim(a.markup)),a}function j(e,t){function n(i,a,o){var s,l,d,c;if(i&&typeof i===ft&&!i.nodeType&&!i.markup&&!i.getTgt){for(d in i)n(d,i[d],a);return Se}return void 0===a&&(a=i,i=void 0),i&&""+i!==i&&(o=a,a=i,i=void 0),c=o?o[r]=o[r]||{}:n,l=t.compile,null===a?i&&delete c[i]:(a=l?l(i,a,o,0):a,i&&(c[i]=a)),l&&a&&(a._is=e),a&&(s=Oe.onStore[e])&&s(i,a,l),a}var r=e+"s";Se[r]=n}function I(e,t,n,r,i,a){var o,s,l,d,c,f,p,u,v=r,g="";if(t===!0?(n=t,t=void 0):typeof t!==ft&&(t=void 0),(l=this.tag)?(c=this,d=l._.tmpl||c.tmpl,v=v||c.view,arguments.length||(e=v)):d=this,d){if(!v&&e&&"view"===e._is&&(v=e),v&&e===v&&(e=v.data),d.fn||(d=l._.tmpl=Re[d]||Re(d)),f=!v,qe=qe||f,v||((t=t||{}).root=e),!qe||Ue.useViews||d.useViews||v&&v!==Ne)g=E(d,e,t,n,v,i,a,l);else{if(v?(p=v.data,u=v.index,v.index=vt):(v=Ne,v.data=e,v.ctx=t),$e(e)&&!n)for(o=0,s=e.length;s>o;o++)v.index=o,v.data=e[o],g+=d.fn(e[o],v,Se);else g+=d.fn(e,v,Se);v.data=p,v.index=u}f&&(qe=void 0)}return g}function E(e,t,n,r,i,a,o,s){function l(e){y=d({},n),y[x]=e}var c,f,p,u,v,g,h,_,m,x,y,w,k="";if(s&&(m=s.tagName,w=s.tagCtx,n=n?R(n,s.ctx):s.ctx,h=w.content,w.props.link===!1&&(n=n||{},n.link=!1),(x=w.props.itemVar)&&("~"!==x.charAt(0)&&V("Use itemVar='~myItem'"),x=x.slice(1))),i&&(h=h||i.content,o=o||i._.onRender,n=n||i.ctx),a===!0&&(g=!0,a=0),o&&(n&&n.link===!1||s&&s._.noVws)&&(o=void 0),_=o,o===!0&&(_=void 0,o=i._.onRender),n=e.helpers?R(e.helpers,n):n,y=n,$e(t)&&!r)for(p=g?i:void 0!==a&&i||new b(n,"array",i,t,e,a,h,o),x&&(p.it=x),x=p.it,c=0,f=t.length;f>c;c++)x&&l(t[c]),u=new b(y,"item",p,t[c],e,(a||0)+c,h,o),v=e.fn(t[c],u,Se),k+=p._.onRender?p._.onRender(v,u):v;else x&&l(t),p=g?i:new b(y,m||"data",i,t,e,a,h,o),s&&!s.flow&&(p.tag=s),k+=e.fn(t,p,Se);return _?_(k,p):k}function T(e,t,n){var r=Ue.onError(e,t,n);if(""+e===e)throw new Oe.Err(r);return!t.linkCtx&&t.linked?Fe.html(r):r}function V(e){T("Syntax error\n"+e)}function N(e,t,n,r,i){function a(t){t-=u,t&&g.push(e.substr(u,t).replace(Ge,"\\n"))}function o(t,n){t&&(t+="}}",V((n?"{{"+n+"}} block has {{/"+t+" without {{"+t:"Unmatched or missing {{/"+t)+", in template:\n"+e))}function s(s,l,p,_,m,b,x,y,w,k,C,A){b&&(m=":",_=ct),k=k||n&&!i;var j=(l||n)&&[[]],I="",E="",T="",N="",S="",L="",$="",R="",F=!k&&!m&&!x;p=p||(w=w||"#data",m),a(A),u=A+s.length,y?f&&g.push(["*","\n"+w.replace(/^:/,"ret+= ").replace(Ye,"$1")+";\n"]):p?("else"===p&&(nt.test(w)&&V('for "{{else if expr}}" use "{{else expr}}"'),j=h[7]&&[[]],h[8]=e.substring(h[8],A),h=v.pop(),g=h[2],F=!0),w&&M(w.replace(Ge," "),j,t).replace(tt,function(e,t,n,r,i,a,o,s){return r="'"+i+"':",o?(E+=a+",",N+="'"+s+"',"):n?(T+=r+a+",",L+=r+"'"+s+"',"):t?$+=a:("trigger"===i&&(R+=a),I+=r+a+",",S+=r+"'"+s+"',",c=c||ot.test(i)),""}).slice(0,-1),j&&j[0]&&j.pop(),d=[p,_||!!r||c||"",F&&[],B(N,S,L),B(E,I,T),$,R,j||0],g.push(d),F&&(v.push(h),h=d,h[8]=u)):C&&(o(C!==h[0]&&"else"!==h[0]&&C,h[0]),h[8]=e.substring(h[8],A),h=v.pop()),o(!h&&C),g=h[2]}var l,d,c,f=Ue.allowCode||t&&t.allowCode,p=[],u=0,v=[],g=p,h=[,,p];return f&&(t.allowCode=f),n&&(e=Ke+e+Qe),o(v[0]&&v[0][2].pop()[0]),e.replace(Te,s),a(e.length),(u=p[p.length-1])&&o(""+u!==u&&+u[8]===u[8]&&u[0]),n?(l=$(p,e,n),S(l,[p[0][7]])):l=$(p,t),l}function S(e,t){var n,r,i=0,a=t.length;for(e.deps=[];a>i;i++){r=t[i];for(n in r)"_jsvto"!==n&&r[n].length&&(e.deps=e.deps.concat(r[n]))}e.paths=r}function B(e,t,n){return[e.slice(0,-1),t.slice(0,-1),n.slice(0,-1)]}function L(e,t){return"\n	"+(t?t+":{":"")+"args:["+e[0]+"]"+(e[1]||!t?",\n	props:{"+e[1]+"}":"")+(e[2]?",\n	ctx:{"+e[2]+"}":"")}function M(e,t,n){function r(r,_,m,b,x,y,w,k,C,A,j,I,E,T,S,B,L,M,$,R){function F(e,n,r,o,s,l,f,p){var u="."===r;if(r&&(x=x.slice(n.length),u||(e=(o?'view.hlp("'+o+'")':s?"view":"data")+(p?(l?"."+l:o?"":s?"":"."+r)+(f||""):(p=o?"":s?l||"":r,"")),e+=p?"."+p:"",e=n+("view.data"===e.slice(0,9)?e.slice(5):e)),d)){if(O="linkTo"===i?a=t._jsvto=t._jsvto||[]:c.bd,U=u&&O[O.length-1]){if(U._jsv){for(;U.sb;)U=U.sb;U.bnd&&(x="^"+x.slice(1)),U.sb=x,U.bnd=U.bnd||"^"===x.charAt(0)}}else O.push(x);h[v]=$+(u?1:0)}return e}b=d&&b,b&&!k&&(x=b+x),y=y||"",m=m||_||I,x=x||C,A=A||L||"";var P,D,O,U,q;if(!w||l||s){if(d&&B&&!l&&!s&&(!i||o||a)&&(P=h[v-1],R.length-1>$-(P||0))){if(P=R.slice(P,$+r.length),D!==!0)if(O=a||f[v-1].bd,U=O[O.length-1],U&&U.prm){for(;U.sb&&U.sb.prm;)U=U.sb;q=U.sb={path:U.sb,bnd:U.bnd}}else O.push(q={path:O.pop()});B=Je+":"+P+" onerror=''"+ze,D=u[B],D||(u[B]=!0,u[B]=D=N(B,n,!0)),D!==!0&&q&&(q._jsv=D,q.prm=c.bd,q.bnd=q.bnd||q.path&&q.path.indexOf("^")>=0)}return l?(l=!E,l?r:I+'"'):s?(s=!T,s?r:I+'"'):(m?(h[v]=$++,c=f[++v]={bd:[]},m):"")+(M?v?"":(p=R.slice(p,$),(i?(i=o=a=!1,"\b"):"\b,")+p+(p=$+r.length,d&&t.push(c.bd=[]),"\b")):k?(v&&V(e),d&&t.pop(),i=x,o=b,p=$+r.length,b&&(d=c.bd=t[i]=[]),x+":"):x?x.split("^").join(".").replace(Xe,F)+(A?(c=f[++v]={bd:[]},g[v]=!0,A):y):y?y:S?(g[v]=!1,c=f[--v],S+(A?(c=f[++v],g[v]=!0,A):"")):j?(g[v]||V(e),","):_?"":(l=E,s=T,'"'))}V(e)}var i,a,o,s,l,d=t&&t[0],c={bd:d},f={0:c},p=0,u=n?n.links:d&&(d.links=d.links||{}),v=0,g={},h={};return(e+(n?" ":"")).replace(Ze,r)}function $(e,t,n){var r,i,a,o,s,l,d,c,f,p,u,v,g,h,_,m,b,x,y,w,k,C,j,I,E,T,N,B,M,R,F=0,P=Ue.useViews||t.useViews||t.tags||t.templates||t.helpers||t.converters,D="",O={},U=e.length;for(""+t===t?(x=n?'data-link="'+t.replace(Ge," ").slice(1,-1)+'"':t,t=0):(x=t.tmplName||"unnamed",t.allowCode&&(O.allowCode=!0),t.debug&&(O.debug=!0),u=t.bnds,b=t.tmpls),r=0;U>r;r++)if(i=e[r],""+i===i)D+='\n+"'+i+'"';else if(a=i[0],"*"===a)D+=";\n"+i[1]+"\nret=ret";else{if(o=i[1],k=!n&&i[2],s=L(i[3],"params")+"},"+L(g=i[4]),B=i[5],R=i[6],C=i[8]&&i[8].replace(Ye,"$1"),(E="else"===a)?v&&v.push(i[7]):(F=0,u&&(v=i[7])&&(v=[v],F=u.push(1))),P=P||g[1]||g[2]||v||/view.(?!index)/.test(g[0]),(T=":"===a)?o&&(a=o===ct?">":o+a):(k&&(y=A(C,O),y.tmplName=x+"/"+a,y.useViews=y.useViews||P,$(k,y),P=y.useViews,b.push(y)),E||(w=a,P=P||a&&(!De[a]||!De[a].flow),I=D,D=""),j=e[r+1],j=j&&"else"===j[0]),M=B?";\ntry{\nret+=":"\n+",h="",_="",T&&(v||R||o&&o!==ct)){if(N="return {"+s+"};",m='c("'+o+'",view,',N=new Function("data,view,j,u"," // "+x+" "+F+" "+a+"\n"+N),N._er=B,h=m+F+",",_=")",N._tag=a,n)return N;S(N,v),p=!0}if(D+=T?(n?(B?"\ntry{\n":"")+"return ":M)+(p?(p=void 0,P=f=!0,m+(v?(u[F-1]=N,F):"{"+s+"}")+")"):">"===a?(d=!0,"h("+g[0]+")"):(c=!0,"((v="+(g[0]||"data")+')!=null?v:"")')):(l=!0,"\n{view:view,tmpl:"+(k?b.length:"0")+","+s+"},"),w&&!j){if(D="["+D.slice(0,-1)+"]",m='t("'+w+'",view,this,',n||v){if(D=new Function("data,view,j,u"," // "+x+" "+F+" "+w+"\nreturn "+D+";"),D._er=B,D._tag=w,v&&S(u[F-1]=D,v),n)return D;h=m+F+",undefined,",_=")"}D=I+M+m+(F||D)+")",v=0,w=0}B&&(P=!0,D+=";\n}catch(e){ret"+(n?"urn ":"+=")+h+"j._err(e,view,"+B+")"+_+";}\n"+(n?"":"ret=ret"))}D="// "+x+"\nvar v"+(l?",t=j._tag":"")+(f?",c=j._cnvt":"")+(d?",h=j.converters.html":"")+(n?";\n":',ret=""\n')+(O.debug?"debugger;":"")+D+(n?"\n":";\nreturn ret;"),Ue._dbgMode&&(D="try {\n"+D+"\n}catch(e){\nreturn j._err(e, view);\n}");try{D=new Function("data,view,j,u",D)}catch(q){V("Compiled template code:\n\n"+D+'\n: "'+q.message+'"')}return t&&(t.fn=D,t.useViews=!!P),D}function R(e,t){return e&&e!==t?t?d(d({},t),e):e:t&&d({},t)}function F(e){return dt[e]||(dt[e]="&#"+e.charCodeAt(0)+";")}function P(e){var t,n,r=[];if(typeof e===ft)for(t in e)n=e[t],n&&n.toJSON&&!n.toJSON()||Me(n)||r.push({key:t,prop:n});return r}function D(t,n,r){var i=this.jquery&&(this[0]||T('Unknown template: "'+this.selector+'"')),a=i.getAttribute(pt);return I.call(a?e.data(i)[ut]:Re(i),t,n,r)}function O(e){return void 0!=e?at.test(e)&&(""+e).replace(st,F)||e:""}function U(t,n,r){var i,a,o,s,l,d,c,f,p,u,v,g,h,_,m,b,x,y=t.target,w=y._jsvBnd,k=/&(\d+)\+?/g;if(w)for(;u=k.exec(w);)if((u=Nn[u[1]])&&(m=u.to)){if(s=u.linkCtx,p=s.view,_=s.tag,f=e(y),g=p.hlp(sn),h=p.hlp(ln),o=W(y),i=xn[o],void 0===r&&(r=Me(o)?o(y):i?f[i]():f.attr(o)),d=m[1],m=m[0],m=m+""===m?[s.data,m]:m,d&&(l=Me(d)?d:p.getRsc("converters",d)),l&&(r=l.call(_,r)),v=p.linkCtx,p.linkCtx=s,b={change:"change",oldValue:s._val,value:r},!(g&&(a=g.call(s,t,b)===!1)||_&&_.onBeforeChange&&(a=_.onBeforeChange(t,b)===!1)||void 0===r)&&(c=m[0],void 0!==r&&c)){if(c._jsv)for(x=c,c=s.data;x&&x.sb;)c=s._ctxCb(x,c),x=x.sb;_&&(_._.chging=!0),Le(c).setProperty(m[2]||m[1],r),h&&h.call(s,t,b),_&&(_.onAfterChange&&_.onAfterChange(t,b),_._.chging=void 0),s._val=r}p.linkCtx=v}}function q(e,t,n){var r,i,a,o,s,l,d=this,c=d.tag,f=d.data,p=d.elem,u=d.convert,v=p.parentNode,g=d.view,h=g.linkCtx,_=g.hlp(sn);if(g.linkCtx=d,!(!v||_&&t&&_.call(d,e,t)===!1||t&&"*"!==e.data.prop&&e.data.prop!==t.path)){if(t&&(d.eventArgs=t),t||d._toLk){if(d._toLk=0,n._er)try{i=n(f,g)}catch(m){s=n._er,l=T(m,g,new Function("data,view","return "+s+";")(f,g)),i=[{props:{},args:[l]}]}else i=n(f,g,Se);if(r=H(i,d,c=d.tag,d.attr||W(p,!0,void 0!==u)),c){if(o=s||c._er,i=i[0]?i:[i],a=!o&&t&&c.onUpdate&&c.onUpdate(e,t,i)===!1,ve(c,i,o),a||r===un)return r===ct&&c.onBeforeLink&&c.onBeforeLink(),ce(c),G(d,f,p),void(g.linkCtx=h);if(c._.chging)return;i=":"===c.tagName?Se._cnvt(c.cvt,g,i[0]):Se._tag(c,g,g.tmpl,i,!0,l)}else n._tag&&(u=""===u?gn:u,i=u?Se._cnvt(u,g,i[0]||i):Se._tag(n._tag,g,g.tmpl,i,!0,l),c=d.tag,r=d.attr||r);J(i,d,r,c)&&t&&(_=g.hlp(ln))&&_.call(d,e,t),d._noUpd=0,c&&(c._er=s,ce(c,t))}G(d,f,p),g.linkCtx=h}}function H(t,n,r,i){var a,o,s,l,d=r&&r.parentElem||n.elem;if(void 0!==t){if(l=e(d),i=r&&r.attr||i,Me(t)&&T(n.expr+": missing parens"),s=/^css-/.test(i)&&i.slice(4))a=e.style(d,s),+t===t&&(a=parseInt(a));else if("link"!==i){if("value"===i)d.type===fn&&(a=l.prop(i=cn));else if(i===pn){if(d.value!==""+t)return i;a=l.prop(cn)}void 0===a&&(o=xn[i],a=o?l[o]():l.attr(i))}n._val=a}return i}function K(e,t){e._df=t,e[(t?"set":"remove")+"Attribute"](mn,"")}function J(t,n,r,i){var a,o,s,l,d,c,f,p,u,v,g,h,_,m=void 0!==t&&!n._noUpd,b=n.data,x=i&&i.parentElem||n.elem,y=e(x),w=n.view,k=n._val,C=w.linkCtx,A=i||r===ct;if(i&&(i.parentElem=i.parentElem||n.expr||i._elCnt?x:x.parentNode,o=i._prv,s=i._nxt),!m)return void(r===ct&&i&&i.onBeforeLink&&i.onBeforeLink());if("visible"===r&&(r="css-display"),/^css-/.test(r))"visible"===n.attr&&(_=(x.currentStyle||Dn.call(je,x,"")).display,t?(t=x._jsvd||_,t!==un||(t=Vn[h=x.nodeName])||(g=document.createElement(h),document.body.appendChild(g),t=Vn[h]=(g.currentStyle||Dn.call(je,g,"")).display,document.body.removeChild(g))):(x._jsvd=_,t=un)),(A=A||k!==t)&&e.style(x,r.slice(4),t);else if("link"!==r){if(/^data-/.test(r)&&e.data(x,r.slice(5),t),r===cn)c=!0,t=t&&"false"!==t;else if(r===pn){if(x.value!==""+t)return void G(n,b,x);t=c=!0,r=cn}else("selected"===r||"disabled"===r||"multiple"===r||"readonly"===r)&&(t=t&&"false"!==t?r:null);(a=xn[r])?r===ct?(w.linkCtx=n,i&&i._.inline?(d=i.nodes(!0),i._elCnt&&(o&&o!==s?ye(o,s,x,i._tgId,"^",!0):(f=x._df)&&(p=i._tgId+"^",u=f.indexOf("#"+p)+1,v=f.indexOf("/"+p),u&&v>0&&(u+=p.length,v>u&&(K(x,f.slice(0,u)+f.slice(v)),we(f.slice(u,v))))),o=o?o.previousSibling:s?s.previousSibling:x.lastChild),e(d).remove(),i&&i.onBeforeLink&&i.onBeforeLink(),l=w.link(w.data,x,o,s,t,i&&{tag:i._tgId,lazyLink:i.tagCtx.props.lazyLink})):(m&&y.empty(),i&&i.onBeforeLink&&i.onBeforeLink(),m&&(l=w.link(b,x,o,s,t,i&&{tag:i._tgId}))),w.linkCtx=C):(A=A||k!==t)&&("text"===r&&x.children&&!x.children[0]?void 0!==x.textContent?x.textContent=t:x.innerText=null===t?"":t:y[a](t)):(A=A||k!==t)&&y[c?"prop":"attr"](r,void 0!==t||c?t:null),n._val=t}return l||A}function z(e,t){var n=this,r=n.hlp(sn),i=n.hlp(ln);if(!r||r.call(this,e,t)!==!1){if(t){var a=t.change,o=t.index,s=t.items;switch(a){case"insert":n.addViews(o,s);break;case"remove":n.removeViews(o,s.length);break;case"move":n.refresh();break;case"refresh":n.refresh()}}i&&i.call(this,e,t)}}function Q(t){var n,r,i=t.type,a=t.data,o=t._.bnd;!t._.useKey&&o&&((r=t._.bndArr)&&(e([r[1]]).off(It,r[0]),t._.bndArr=void 0),o!==!!o?i?o._.arrVws[t._.id]=t:delete o._.arrVws[t._.id]:i&&a&&(n=function(e){e.data&&e.data.off||z.apply(t,arguments)},e([a]).on(It,n),t._.bndArr=[n,a]))}function W(e,t,n){var r=e.nodeName.toLowerCase(),i=Ue.merge[r]||e.contentEditable===gn&&{to:ct,from:ct};return i?t?"input"===r&&e.type===pn?pn:i.to:i.from:t?n?"text":ct:""}function X(t,n,r,i,a,o,s){var l,d,c,f,p,u=t.parentElem,v=t._prv,g=t._nxt,h=t._elCnt;if(v&&v.parentNode!==u&&T("Missing parentNode"),s){f=t.nodes(),h&&v&&v!==g&&ye(v,g,u,t._.id,"_",!0),t.removeViews(void 0,void 0,!0),d=g,h&&(v=v?v.previousSibling:g?g.previousSibling:u.lastChild),e(f).remove();for(p in t._.bnds)he(p)}else{if(n){if(c=i[n-1],!c)return!1;v=c._nxt}h?(d=v,v=d?d.previousSibling:u.lastChild):d=v.nextSibling}l=r.render(a,o,t._.useKey&&s,t,s||n,!0),t.link(a,u,v,d,l,c)}function Z(e,t,n){var r,i,a;return n?(a="^`",i=t._.tag,r=i._tgId,r||(Nn[r=Sn++]=i,i._tgId=""+r)):(a="_`",nn[r=t._.id]=t),"#"+r+a+(void 0!=e?e:"")+"/"+r+a}function G(e,t,n){var r,i,a,o,s,l=e.tag,c=e.convertBack,f=[],p=e._bndId||""+Sn++,u=e._hdl;if(e._bndId=void 0,l&&(f=l.depends||f,f=Me(f)?l.depends(l):f,a=l.linkedElem),!e._depends||""+e._depends!=""+f){for(e._depends&&Le._apply(!1,[t],e._depends,u,!0),o=e.fn.deps.slice(),i=o.length;i--;)s=o[i],s._jsv&&(o[i]=d({},s));r=Le._apply(!1,[t],o,f,u,e._ctxCb),r.elem=n,r.linkCtx=e,r._tgId=p,n._jsvBnd=n._jsvBnd||"",n._jsvBnd+="&"+p,e._depends=f,e.view._.bnds[p]=p,Nn[p]=r,a&&(r.to=[[],c]),(a||void 0!==c)&&ue(r,l&&l.convertBack||c),l&&(l.onAfterBind&&l.onAfterBind(r),l.flow||l._.inline||(n.setAttribute(an,(n.getAttribute(an)||"")+"#"+p+"^/"+p+"^"),l._tgId=""+p))}if(a&&a[0])for(l._.radio&&(a=a.children("input[type=radio]")),i=a.length;i--;)a[i]._jsvBnd=a[i]._jsvBnd||n._jsvBnd+"+",a[i]._jsvLkEl=l}function Y(e,t,n,r,i,a,o){return ee(this,e,t,n,r,i,a,o)}function ee(t,n,r,i,a,o,s,l){if(i===!0?(a=i,i=void 0):"object"!=typeof i&&(i=void 0),t&&n){n=n.jquery?n:e(n),Wt||(Wt=document.body,e(Wt).on(on,U).on("blur","[contenteditable]",U));for(var d,c,f,p,u,v,g,h,_,m=Z,b=i&&"replace"===i.target,x=n.length;x--;){if(g=n[x],o=o||Zt(g),(_=o===Ne)&&(Ne.data=(Ne.ctx=i||{}).root=r),""+t===t)ne(t,g,o,void 0,!0,r,i);else{if(void 0!==t.markup)o.link===!1&&(i=i||{},i.link=m=!1),b&&(v=g.parentNode),f=t.render(r,i,a,o,void 0,m),v?(s=g.previousSibling,l=g.nextSibling,e.cleanData([g],!0),v.removeChild(g),g=v):(s=l=void 0,e(g).empty());else{if(t!==!0||o!==Ne)break;h={lnk:1}}if(g._df&&!l){for(p=oe(g._df,!0,Mn),d=0,c=p.length;c>d;d++)u=p[d],(u=nn[u.id])&&void 0!==u.data&&u.parent.removeViews(u._.key,void 0,!0);K(g)}o.link(r,g,s,l,f,h,i)}_&&(Ne.data=Ne.ctx=void 0)}}return n}function te(t,n,r,i,a,o,s,l){function d(e,t,n,r,i,o,s,l,d,c,f,p,v,h){var _,m,b="";return h?(u=0,e):(g=d||c||"",r=r||f,n=n||v,q&&!n&&(!e||r||g||o&&!u)&&(q=void 0,U=me.shift()),r=r||n,r&&(u=0,q=void 0,$&&(n||v?Tn[U]||/;svg;|;math;/.test(";"+me.join(";")+";")||(_="'<"+U+".../"):Tn[r]?_="'</"+r:me.length&&r===U||(_="Mismatch: '</"+r),_&&V(_+">' in:\n"+a)),G=X,U=me.shift(),X=In[U],f=f?"</"+f+">":"",G&&(he+=ee,ee="",X?he+="-":(b=f+_n+"@"+he+hn+(p||""),he=be.shift()))),X?(o?ee+=o:t=f||v||"",g&&(t+=g,ee&&(t+=" "+an+'="'+ee+'"',ee=""))):t=o?t+b+i+(u?"":_n+o+hn)+l+g:b||e,$&&s&&(u&&V("{^{ within elem markup ("+u+' ). Use data-link="..."'),"#"===o.charAt(0)?me.unshift(o.slice(1)):o.slice(1)!==(m=me.shift())&&V("Closing tag for {^{...}} under different elem: <"+m+">")),g&&(u=g,me.unshift(U),U=g.slice(1),me[0]&&me[0]===En[U]&&T("Parent of <tr> must be <tbody>"),q=Tn[U],(X=In[U])&&!G&&(be.unshift(he),he=""),G=X,he&&X&&(he+="+")),t)}function c(e,t){var r,i,a,o,s,l,d,c=[];if(e){for("@"===e._tkns.charAt(0)&&(t=y.previousSibling,y.parentNode.removeChild(y),y=void 0),b=e.length;b--;){if(k=e[b],a=k.ch,r=k.path)for(m=r.length-1;i=r.charAt(m--);)"+"===i?"-"===r.charAt(m)?(m--,t=t.previousSibling):t=t.parentNode:t=t.lastChild;"^"===a?(g=Nn[s=k.id])&&(d=t&&(!y||y.parentNode!==t),(!y||d)&&(g.parentElem=t),k.elCnt&&d&&K(t,(k.open?"#":"/")+s+a+(t._df||"")),c.push([d?null:y,k])):(w=nn[s=k.id])&&(w.parentElem||(w.parentElem=t||y&&y.parentNode||n,w._.onRender=Z,w._.onArrayChange=z,Q(w)),o=w.parentElem,k.open?(w._elCnt=k.elCnt,t&&!y?K(t,"#"+s+a+(t._df||"")):(w._prv||K(o,ie(o._df,"#"+s+a)),w._prv=y)):(!t||y&&y.parentNode===t?y&&(w._nxt||K(o,ie(o._df,"/"+s+a)),w._nxt=y):(K(t,"/"+s+a+(t._df||"")),w._nxt=void 0),v=w.linkCtx,(l=w.ctx&&w.ctx.onAfterCreate||xe)&&l.call(v,w)))}for(b=c.length;b--;)_e.push(c[b])}return!e||e.elCnt}function f(e){var t,n,r;if(e)for(b=e.length,m=0;b>m;m++)if(k=e[m],n=g=Nn[k.id].linkCtx.tag,r=g.tagName===L,!g.flow||r){if(!B){for(t=1;n=n.parent;)t++;R=R||t}!B&&t!==R||L&&!r||S.push(g)}}function p(){var o,l,d="",p={},u=en+(ue?",["+mn+"]":"");for(x=jn?n.querySelectorAll(u):e(u,n).get(),_=x.length,r&&r.innerHTML&&(A=jn?r.querySelectorAll(u):e(u,r).get(),r=A.length?A[A.length-1]:r),R=0,h=0;_>h;h++)if(y=x[h],r&&!re)re=y===r;else{if(i&&y===i){ue&&(d+=ae(y));break}if(y.parentNode)if(ue){if(d+=ae(y),y._df){for(o=h+1;_>o&&y.contains(x[o]);)o++;p[o-1]=y._df}p[h]&&(d+=p[h]||"")}else pe&&(k=oe(y,void 0,Rn))&&(k=k[0])&&(de=de?k.id!==de&&de:k.open&&k.id),!de&&ye(oe(y))&&y.getAttribute(Gt)&&_e.push([y])}if(ue&&(d+=n._df||"",(l=d.indexOf("#"+ue.id)+1)&&(d=d.slice(l+ue.id.length)),l=d.indexOf("/"+ue.id),l+1&&(d=d.slice(0,l)),f(oe(d,void 0,Fn))),void 0===a&&n.getAttribute(Gt)&&_e.push([n]),se(r,X),se(i,X),ue)return void(fe&&fe.resolve());for(X&&he+ee&&(y=i,he&&(i?c(oe(he+"+",!0),i):c(oe(he,!0),n)),c(oe(ee,!0),n),i&&(d=i.getAttribute(an),(_=d.indexOf(te)+1)&&(d=d.slice(_+te.length-1)),i.setAttribute(an,ee+d))),_=_e.length,h=0;_>h;h++)y=_e[h],C=y[1],y=y[0],C?(g=Nn[C.id])&&((v=g.linkCtx)&&(g=v.tag,g.linkCtx=v),C.open?(y&&(g.parentElem=y.parentNode,g._prv=y),g._elCnt=C.elCnt,g.onBeforeLink&&g.onBeforeLink(),w=g.tagCtx.view,ne(void 0,g._prv,w,C.id)):(g._nxt=y,g._.unlinked&&(M=g.tagCtx,w=M.view,ce(g)))):ne(y.getAttribute(Gt),y,Zt(y),void 0,pe,t,s);fe&&fe.resolve()}var u,v,g,h,_,m,b,x,y,w,k,C,A,j,I,E,N,S,B,L,M,$,R,F,P,D,O,U,q,H,J,W,X,G,Y,ee,te,re,de,fe,pe,ue,ve=this,ge=ve._.id+"_",he="",_e=[],me=[],be=[],xe=ve.hlp(dn),ye=c;if(o&&(fe=o.lazyLink&&e.Deferred(),o.tmpl?I="/"+o._.id+"_":(pe=o.lnk,o.tag&&(ge=o.tag+"^",o=!0),(ue=o.get)&&(ye=f,S=ue.tags,B=ue.deep,L=ue.name)),o=o===!0),n=n?""+n===n?e(n)[0]:n.jquery?n[0]:n:ve.parentElem||document.body,$=!Ue.noValidate&&n.contentEditable!==gn,U=n.tagName.toLowerCase(),X=!!In[U],r=r&&le(r,X),i=i&&le(i,X)||null,void 0!=a){if(J=document.createElement("div"),H=J,te=ee="",Y="http://www.w3.org/2000/svg"===n.namespaceURI?"svg_ns":(O=rt.exec(a))&&O[1]||"",rn&&O&&O[2]&&T("Unsupported: "+O[2]),X){for(N=i;N&&!(E=oe(N));)N=N.nextSibling;(W=E?E._tkns:n._df)&&(j=I||"",(o||!I)&&(j+="#"+ge),m=W.indexOf(j),m+1&&(m+=j.length,te=ee=W.slice(0,m),W=W.slice(m),E?N.setAttribute(an,W):K(n,W)))}if(q=void 0,a=(""+a).replace(Ln,d),$&&me.length&&V("Mismatched '<"+U+"...>' in:\n"+a),l)return;for(An.appendChild(J),Y=tn[Y]||tn.div,F=Y[0],H.innerHTML=Y[1]+a+Y[2];F--;)H=H.lastChild;for(An.removeChild(J),P=document.createDocumentFragment();D=H.firstChild;)P.appendChild(D);n.insertBefore(P,i)}return fe?setTimeout(p,0):p(),fe&&fe.promise()}function ne(e,t,n,r,i,a,o){var s,l,d,c,f,p,u,v,g,h,_,m,b=[];if(r)h=Nn[r],h=h.linkCtx?h.linkCtx.tag:h,g=h.linkCtx||{data:n.data,elem:h._elCnt?h.parentElem:t,view:n,ctx:n.ctx,attr:ct,fn:h._.bnd,tag:h,_bndId:r},re(g,g.fn);else if(e&&t){for(a=i?a:n.data,s=n.tmpl,e=de(e,W(t)),Xt.lastIndex=0;l=Xt.exec(e);)b.push(l);for(;l=b.shift();){for(_=Xt.lastIndex,d=l[1],u=l[3];b[0]&&"else"===b[0][4];)u+="}{"+b.shift()[3],m=!0;m&&(u+="}{{/"+l[4]+"}"),f=l[10],c=void 0,g={data:a,elem:t,view:n,ctx:o,attr:d,isLk:i,_toLk:1,_noUpd:l[2]},l[6]&&(!d&&(c=/:([\w$]*)$/.exec(f))&&(c=c[1],void 0!==c&&(p=-c.length-1,u=u.slice(0,p-1)+ze)),null===c&&(c=void 0),g.convert=l[5]||""),g.expr=d+u,v=s.links[u],v||(s.links[u]=v=Oe.tmplFn(u,s,!0,c,m)),g.fn=v,d||void 0===c||(g.convertBack=c),re(g,v),Xt.lastIndex=_}}}function re(e,t){function n(n,r){q.call(e,n,r,t)}n.noArray=!0,e.isLk&&(e.view=new Oe.View(e.ctx,"link",Ne,e.data,Ne.tmpl,void 0,void 0,Z)),e._ctxCb=be(e.view),e._hdl=n,n(!0)}function ie(e,t){var n;return e?(n=e.indexOf(t),n+1?e.slice(0,n)+e.slice(n+t.length):e):""}function ae(e){return e&&(""+e===e?e:e.tagName===vn?e.type.slice(3):1===e.nodeType&&e.getAttribute(an)||"")}function oe(e,t,n){function r(e,t,n,r,a,s){o.push({elCnt:i,id:r,ch:a,open:t,close:n,path:s,token:e})}var i,a,o=[];return(a=t?e:ae(e))?(i=o.elCnt=e.tagName!==vn,i="@"===a.charAt(0)||i,o._tkns=a,a.replace(n||Pn,r),o):void 0}function se(e,t){e&&("jsv"===e.type?e.parentNode.removeChild(e):t&&""===e.getAttribute(Gt)&&e.removeAttribute(Gt))}function le(e,t){for(var n=e;t&&n&&1!==n.nodeType;)n=n.previousSibling;return n&&(1!==n.nodeType?(n=document.createElement(vn),n.type="jsv",e.parentNode.insertBefore(n,e)):ae(n)||n.getAttribute(Gt)||n.setAttribute(Gt,"")),n}function de(t,n){return t=e.trim(t).replace(et,"\\$&"),t.slice(-1)!==ze?t=Je+":"+t+(n?":":"")+ze:t}function ce(t,n){var r,i,a,o,s,l,d,c,f=t.tagCtx,p=f.view,u=f.props,v=t.linkCtx=t.linkCtx||{tag:t,data:p.data,view:p,ctx:p.ctx};if(t.onAfterLink&&t.onAfterLink(f,v,n),t._.unlinked=void 0,r=t.targetTag?t.targetTag.linkedElem:t.linkedElem,!t.noVal&&(i=r&&r[0])){if((a=t._.radio)&&(r=r.children("input[type=radio]")),a||!t._.chging){if(o=t.cvtArgs()[0],a||i!==v.elem){for(s=r.length;s--;)i=r[s],l=i._jsvLkEl,t._.inline&&(!l||l!==t&&l.targetTag!==t)&&(i._jsvLkEl=t,ue(Nn[t._tgId],t.convertBack),i._jsvBnd="&"+t._tgId+"+"),a&&(i[cn]=o===i.value);v._val=o}void 0!==o&&(a||void 0===i.value?i.contentEditable===gn&&(i.innerHTML=o):i.type===fn?i[cn]=o&&"false"!==o:r.val(o))}t.setSize&&(u.height&&r.height(u.height),u.width&&r.width(u.width)),u["class"]&&r.addClass(u["class"]),u.id&&(r[0].id=u.id),u.name&&r.attr("name",u.name)}(i=i||":"===t.tagName&&v.elem)&&(d=i._jsvTr,c=u.trigger,d!==c&&(i._jsvTr=c,r=r||e(i),pe(r,d,"off"),pe(r,c,"on")))}function fe(e){setTimeout(function(){U(e)},0)}function pe(e,t,n){t&&e[n](t===!0?"keydown":t,t===!0?fe:U)}function ue(e,t){var n,r,i,a,o,s=e.linkCtx,l=s.data,d=s.fn.paths;if(e&&d)if(d=(n=d._jsvto)||d[0],r=d&&d.length,!r||s.tag&&!s.tag.tagCtx.args.length)e.to=[[],t];else{if(a=d[r-1],a._jsv){for(o=a;a.sb&&a.sb._jsv;)i=a=a.sb;i=a.sb||i&&i.path,a=i?i.slice(1):o.path}e.to=i?[[o,a],t]:[s._ctxCb(i=a.split("^").join("."))||[l,i],t]}}function ve(e,t,n){var r,i,a=e.tagCtx.view,o=e.tagCtxs||[e.tagCtx],s=o.length,l=!t;if(t=t||e._.bnd.call(a.tmpl,(e.linkCtx||a).data,a,Se),n)o=e.tagCtxs=t,e.tagCtx=o[0];else for(;s--;)r=o[s],i=t[s],Le(r.props).setProperty(i.props),d(r.ctx,i.ctx),r.args=i.args,l&&(r.tmpl=i.tmpl);return Oe._ths(e,o[0]),o}function ge(e){for(var t,n,r,i=[],a=e.length,o=a;o--;)i.push(e[o]);for(o=a;o--;)if(n=i[o],n.parentNode){if(r=n._jsvBnd)for(r=r.slice(1).split("&"),n._jsvBnd="",t=r.length;t--;)he(r[t],n._jsvLkEl,n);we(ae(n)+(n._df||""))}}function he(t,n,r){var i,a,o,s,l,d,c,f,p,u,v,g=Nn[t];if(n)r===n.linkedElem[0]&&(r._jsvLkEl=void 0,n.linkedElem=void 0);else if(g){delete Nn[t];for(i in g.bnd)s=g.bnd[i],l=g.cbId,e.isArray(s)?e([s]).off(It+l).off(jt+l):e(s).off(jt+l),delete g.bnd[i];if(a=g.linkCtx){if(o=a.tag){if(d=o.tagCtxs)for(c=d.length;c--;)(f=d[c].map)&&f.unmap();p=o.linkedElem,u=p&&p[0]||a.elem,(v=u&&u._jsvTr)&&(pe(p||e(u),v,"off"),u._jsvTr=void 0),o.onDispose&&o.onDispose(),o._elCnt||(o._prv&&o._prv.parentNode.removeChild(o._prv),o._nxt&&o._nxt.parentNode.removeChild(o._nxt))}delete a.view._.bnds[t]}Oe._cbBnds[g.cbId]=void 0}}function _e(t,n){return void 0===t?(Wt&&(e(Wt).off(on,U).off("blur","[contenteditable]",U),Wt=void 0),t=!0,Ne.removeViews(),ge(document.body.getElementsByTagName("*"))):n&&t===!0&&(n=n.jquery?n:e(n),n.each(function(){for(var e;(e=Zt(this,!0))&&e.parent;)e.parent.removeViews(e._.key,void 0,!0);ge(this.getElementsByTagName("*")),ge([this])})),n}function me(e,t){return _e(this,e,t)}function be(e){return function(t,n){var r,i,a=[n];if(e&&t){if(t._jsv)return t._jsv.call(e.tmpl,n,e,Se);if("~"===t.charAt(0))return"~tag"===t.slice(0,4)&&(i=e.ctx,"."===t.charAt(4)&&(r=t.slice(5).split("."),i=i.tag),r)?i?[i,r.join("."),n]:[]:(t=t.slice(1).split("."),(n=e.hlp(t.shift()))&&(t.length&&a.unshift(t.join(".")),a.unshift(n)),n?a:[]);if("#"===t.charAt(0))return"#data"===t?[]:[e,t.replace(Bn,""),n]}}}function xe(e){return e.type===fn?e[cn]:e.value}function ye(e,t,n,r,i,a){var o,s,l,d,c,f,p,u=0,v=e===t;if(e){for(l=oe(e)||[],o=0,s=l.length;s>o;o++){if(d=l[o],f=d.id,f===r&&d.ch===i){if(!a)break;s=0}v||(c="_"===d.ch?nn[f]:Nn[f].linkCtx.tag,d.open?c._prv=t:d.close&&(c._nxt=t)),u+=f.length+2}u&&e.setAttribute(an,e.getAttribute(an).slice(u)),p=t?t.getAttribute(an):n._df,(s=p.indexOf("/"+r+i)+1)&&(p=l._tkns.slice(0,u)+p.slice(s+(a?-1:r.length+1))),p&&(t?t.setAttribute(an,p):K(n,p))}else K(n,ie(n._df,"#"+r+i)),a||t||K(n,ie(n._df,"/"+r+i))}function we(e){var t,n,r,i;if(i=oe(e,!0,$n))for(t=0,n=i.length;n>t;t++)r=i[t],"_"===r.ch?(r=nn[r.id])&&r.type&&r.parent.removeViews(r._.key,void 0,!0):he(r.id)}function ke(e,t,n){if("set"===n.change){for(var r=e.tgt,i=r.length;i--&&r[i].key!==n.path;);-1===i?n.path&&!n.remove&&Le(r).insert({key:n.path,prop:n.value}):n.remove?Le(r).remove(i):Le(r[i]).setProperty("prop",n.value)}}function Ce(e,t,n){var r,i=e.src,a=n.change;"set"===a?"prop"===n.path?Le(i).setProperty(t.target.key,n.value):(Le(i).setProperty(n.oldValue,null),delete i[n.oldValue],Le(i).setProperty(n.value,t.target.prop)):"remove"===a?(r=n.items[0],Le(i).removeProperty(r.key),delete i[r.key]):"insert"===a&&(r=n.items[0],r.key&&Le(i).setProperty(r.key,r.prop))}function Ae(e){return e.indexOf(".")<0}var je=(0,eval)("this"),Ie=e===!1;if(e=e||je.jQuery,!e||!e.fn)throw"JsViews requires jQuery";var Ee,Te,Ve,Ne,Se,Be,Le,Me,$e,Re,Fe,Pe,De,Oe,Ue,qe,He="v1.0.0-beta",Ke="{",Je="{",ze="}",Qe="}",We="^",Xe=/^(!*?)(?:null|true|false|\d[\d.]*|([\w$]+|\.|~([\w$]+)|#(view|([\w$]+))?)([\w$.^]*?)(?:[.[^]([\w$]+)\]?)?)$/g,Ze=/(\()(?=\s*\()|(?:([([])\s*)?(?:(\^?)(!*?[#~]?[\w$.^]+)?\s*((\+\+|--)|\+|-|&&|\|\||===|!==|==|!=|<=|>=|[<>%*:?\/]|(=))\s*|(!*?[#~]?[\w$.^]+)([([])?)|(,\s*)|(\(?)\\?(?:(')|("))|(?:\s*(([)\]])(?=\s*[.^]|\s*$|[^\(\[])|[)\]])([([]?))|(\s+)/g,Ge=/[ \t]*(\r\n|\n|\r)/g,Ye=/\\(['"])/g,et=/['"\\]/g,tt=/(?:\x08|^)(onerror:)?(?:(~?)(([\w$_\.]+):)?([^\x08]+))\x08(,)?([^\x08]+)/gi,nt=/^if\s/,rt=/<(\w+)[>\s]/,it=/[\x00`><"'&]/g,at=/[\x00`><\"'&]/,ot=/^on[A-Z]|^convert(Back)?$/,st=it,lt=0,dt={
"&":"&amp;","<":"&lt;",">":"&gt;","\x00":"&#0;","'":"&#39;",'"':"&#34;","`":"&#96;"},ct="html",ft="object",pt="data-jsv-tmpl",ut="jsvTmpl",vt="For #index in nested block use #getIndex().",gt={},ht={template:{compile:k},tag:{compile:y},helper:{},converter:{}},_t=je.jsrender,mt=_t&&e&&!e.render;if(Se={jsviews:He,settings:function(e){d(Ue,e),s(Ue._dbgMode),Ue.jsv&&Ue.jsv()},sub:{View:b,Err:l,tmplFn:N,parse:M,extend:d,syntaxErr:V,onStore:{},_ths:r,_tg:function(){}},map:C,_cnvt:g,_tag:m,_err:T},(l.prototype=new Error).constructor=l,p.depends=function(){return[this.get("item"),"index"]},u.depends="index",b.prototype={get:f,getIndex:u,getRsc:_,hlp:v,_is:"view"},!(_t||e&&e.render)){for(Ee in ht)j(Ee,ht[Ee]);Re=Se.templates,Fe=Se.converters,Pe=Se.helpers,De=Se.tags,Oe=Se.sub,Ue=Se.settings,Oe._tg.prototype={baseApply:w,cvtArgs:h},Ne=Oe.topView=new b,e?(e.fn.render=D,e.observable&&(d(Oe,e.views.sub),Se.map=e.views.map)):(e={},Ie&&(je.jsrender=e),e.renderFile=e.__express=e.compile=function(){throw"Node.js: use npm jsrender, or jsrender-node.js"},e.isFunction=function(e){return"function"==typeof e},e.isArray=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)},e.toJq=function(t){e!==t&&(d(t,this),e=t,e.fn.render=D)},e.jsrender=He),Me=e.isFunction,$e=e.isArray,e.render=gt,e.views=Se,e.templates=Re=Se.templates,Se.compile=function(e,t){return t=t||{},t.markup=e,Re(t)},Ue({debugMode:s,delimiters:c,onError:function(e,t,n){return t&&(e=void 0===n?"{Error: "+(e.message||e)+"}":Me(n)?n(e,t):n),void 0==e?"":e},_dbgMode:!1}),De({"if":{render:function(e){var t=this,n=t.tagCtx,r=t.rendering.done||!e&&(arguments.length||!n.index)?"":(t.rendering.done=!0,t.selected=n.index,n.render(n.view,!0));return r},flow:!0},"for":{render:function(e){var t,n=!arguments.length,r=this,i=r.tagCtx,a="",o=0;return r.rendering.done||(t=n?i.view.data:e,void 0!==t&&(a+=i.render(t,n),o+=$e(t)?t.length:1),(r.rendering.done=o)&&(r.selected=i.index)),a},flow:!0},props:{baseTag:"for",dataMap:C(P),flow:!0},include:{flow:!0},"*":{render:i,flow:!0},":*":{render:i,flow:!0},dbg:Pe.dbg=Fe.dbg=o}),Fe({html:O,attr:O,url:function(e){return void 0!=e?encodeURI(""+e):null===e?e:""}}),c()}if(mt&&_t.toJq(e),Se=e.views,Oe=Se.sub,Me=e.isFunction,$e=e.isArray,!e.observe){var bt=e.event.special,xt=[].slice,yt=[].splice,wt=[].concat,kt=e.expando,Ct=parseInt,At=/\S+/g,jt=Oe.propChng=Oe.propChng||"propertyChange",It=Oe.arrChng=Oe.arrChng||"arrayChange",Et=Oe._cbBnds=Oe._cbBnds||{},Tt=jt+".observe",Vt=1,Nt=1,St=1,Bt=e.hasData,Lt=e.data,Mt={},$t=function(e){return e._cId=e._cId||".obs"+Nt++},Rt=function(e){return this._data=e,this},Ft=function(e){return this._data=e,this},Pt=function(e){return $e(e)?[e]:e},Dt=function(e,t){e=$e(e)?e:[e];var n,r,i=t,a=i,o=e.length,s=[];for(n=0;o>n;n++)r=e[n],Me(r)?s=s.concat(Dt(r.call(t,t),t)):""+r===r?(a!==i&&s.push(i=a),s.push(r)):(t=a=r,a!==i&&s.push(i=a));return s},Ot=function(e,t){for(var n in e)return;Et[t]=void 0},Ut=function(e,t){function n(e){return typeof e===ft&&(f[0]||c&&$e(e))}if(!e.data||!e.data.off){var r,i,a,o=t.oldValue,s=t.value,l=e.data,d=l.observeAll,c=!l.cb.noArray,f=l.paths;e.type===It?(l.cb.array||l.cb).call(l,e,t):(l.prop===t.path||"*"===l.prop)&&(d?(r=d._path+"."+t.path,i=d.filter,a=[e.target].concat(d.parents()),n(o)&&qt(c,d.ns,[o],f,l.cb,!0,i,[a],r),n(s)&&qt(c,d.ns,[s],f,l.cb,void 0,i,[a],r)):(n(o)&&qt(c,[o],f,l.cb,!0),n(s)&&qt(c,[s],f,l.cb)),l.cb(e,t))}},qt=function(){var e=wt.apply([],arguments);return Be.apply(e.shift(),e)},Ht=function(e,t,n,r){e+""!==e&&(n=t,t=e,e=""),Jt(e,this._data,t,n,[],"root",r)},Kt=function(e,t,n){Ht.call(this,e,t,n,!0)},Jt=function(e,t,n,r,i,a,o,s){function l(e,t){for(f=e.length,u=a+"[]";f--;)d(e,f,t,1)}function d(t,i,a,o){var l,d;i!==kt&&(l=Le._fltr(u,t[i],v,r))&&(d=v.slice(),o&&g&&d.unshift(g),Jt(e,l,n,r||(o?void 0:0),d,u,a,s))}function c(e,t){switch(a=e.data.observeAll._path,g=e.target,t.change){case"insert":l(t.items);break;case"remove":l(t.items,!0);break;case"refresh":l(t.oldItems,!0),l(e.target);break;case"set":u=a+"."+t.path,d(t,"oldValue",!0),d(t,"value")}g=void 0,n.apply(this,arguments)}var f,p,u,v,g,h,_=!s||s.un||!o;if(t&&typeof t===ft){if(v=[t].concat(i),p=$e(t)?"":"*",s&&_&&Bt(t)&&s[h=Lt(t).obId])return void s[h]++;if(s||(s={un:o}),n){if(p||0!==r)if(c._cId=$t(n),_)Be(e,t,p,c,o,r,v,a),h=Lt(t).obId,s[h]=(s[h]||0)+1;else{if(--s[Lt(t).obId])return;Be(e,t,p,c,o,r,v,a)}}else s&&(s[Lt(t).obId]=1),Be(e,t,p,void 0,o,r,v,a);if(p)for(f in t)u=a+"."+f,d(t,f,o);else l(t,o)}},zt=function(e){return e.indexOf(".")<0&&e.indexOf("[")<0},Qt=function(){return[].push.call(arguments,!0),Be.apply(this,arguments)};Be=function(){function t(){function i(t,r,i,a){var o,s,l=Bt(M),d=Pt(M),c=j,f=I;if(t=n?t+"."+n:t,g||a)l&&e(d).off(t,Ut);else{if(x=l&&e._data(M))for(x=x&&x.events,x=x&&x[i?It:jt],m=x&&x.length;m--;)if((b=x[m].data)&&b.cb&&b.cb._cId===h._cId&&b.ns===n){if(i)return;"*"===r&&b.prop!==r&&e(M).off(t,Ut)}s=i?{}:{fullPath:u,paths:r?[r]:[],prop:p},s.ns=n,s.cb=h,I&&(s.observeAll={_path:f,path:function(){return o=c.length,f.replace(/[[.]/g,function(t){return o--,"["===t?"["+e.inArray(c[o-1],c[o]):"."})},parents:function(){return c},filter:E,ns:n}),e(d).on(t,null,s,Ut),k&&((Et[h._cId]=k)[Lt(M).obId||Lt(M,"obId",Vt++)]=M)}}function o(e){var n=L;return e.ob=y(e,n),e.cb=function(i,a){var o=e.ob,l=e.sb,d=y(e,n);d!==o&&(typeof o===ft&&(s(o,!0),(l||r&&$e(o))&&t([o],l,h,y,!0)),e.ob=d,typeof d===ft&&(s(d),(l||r&&$e(d))&&t([d],l,h,y))),h(i,a)}}function s(e,t,n,a){if(r){var o=M,s=I;M=e,a&&(M=e[a],I+="."+a),E&&M&&(M=Le._fltr(I,M,a?[e].concat(j):j,E)),M&&(n||$e(M))&&i(It+".observe"+(h?_=$t(h):""),void 0,!0,t),M=o,I=s}}var l,d,c,f,p,u,v,g,h,_,m,b,x,y,w,k,C,A,j,I,E,T,V,N=Tt,S=1!=this?wt.apply([],arguments):xt.call(arguments),B=S.pop()||!1,L=S.shift(),M=L,$=S.length;for(B+""===B&&(I=B,j=S.pop(),E=S.pop(),B=!!S.pop(),$-=3),B===!!B&&(g=B,B=S[$-1],B=$&&B+""!==B?($--,S.pop()):void 0),h=B,$&&Me(S[$-1])&&(y=h,h=S.pop(),$--),N+=g?h?h._cId+(h._inId||""):"":(_=$t(h))+(h._inId||""),g||(k=Et[_]=Et[_]||{}),T=n&&n.match(At)||[""],V=T.length;V--;)for(n=T[V],$e(L)?s(L,g,!0):g&&0===$&&L&&i(N,""),C=0,l=0;$>l;l++)if(u=S[l],""!==u&&void 0!==u){if(M=L,""+u===u){if(f=u.split("^"),f[1]&&(C=f[0].split(".").length,u=f.join("."),C=u.split(".").length-C),y&&(w=y(u,L))){$+=w.length-1,yt.apply(S,[l--,1].concat(w));continue}f=u.split(".")}else Me(u)||(u&&u._jsv?(A=g?u.cb:o(u),A.noArray=!r,A._cId=h._cId,A._inId=A._inId||".obIn"+St++,(u.bnd||u.prm&&u.prm.length||!u.sb)&&t([M],u.path,[a],u.prm,A,y,g),u.sb&&t([u.ob],u.sb,h,y,g),u=a,M=void 0):M=u),f=[L=u];for(;M&&void 0!==(p=f.shift());)if(typeof M===ft){if(""+p===p){if(""===p)continue;if(f.length<C+1&&!M.nodeType){if(!g&&(x=Bt(M)&&e._data(M))){for(x=x.events,x=x&&x[jt],m=x&&x.length,c=0;m--;)b=x[m].data,b&&b.cb===h&&b.ns===n&&(b.prop===p||"*"===b.prop)&&((d=f.join("."))&&b.paths.push(d),c++);if(c){M=M[p];continue}}if("*"===p){!g&&x&&x.length&&i(N,"",!1,!0),i(N,"");for(d in M)d!==kt&&s(M,g,void 0,d);break}p&&i(N+"."+p,f.join("^"))}I&&(I+="."+p),p=M[p]}if(Me(p)){(v=p.depends)&&t([M],Dt(v,M),h,y,g);break}M=p}s(M,g)}return _&&Ot(k,_),{cbId:_,bnd:k}}var n,r=0!=this,i=xt.call(arguments),a=i[0];return a+""===a&&r&&(n=a,i.shift(),a=i[0]),t.apply(1,i)},Le=function(e){return $e(e)?new Ft(e):new Rt(e)},Oe.getDeps=function(){var e=arguments;return function(){for(var t,n,r=[],i=e.length;i--;)t=e[i--],n=e[i],n&&(r=r.concat(Me(n)?n(t,t):n));return r}},e.observable=Le,Le._fltr=function(e,t,n,r){return(r&&Me(r)?r(e,t,n):!0)?(t=Me(t)?t.set&&t.call(n[0]):t,typeof t===ft&&t):void 0},Le.Object=Rt,Le.Array=Ft,e.observe=Le.observe=Be,e.unobserve=Le.unobserve=Qt,Le._apply=qt,Rt.prototype={_data:null,observeAll:Ht,unobserveAll:Kt,data:function(){return this._data},setProperty:function(e,t,n){var r,i,a,o=this,s=o._data;if(e=e||"",s)if($e(e))for(r=e.length;r--;)i=e[r],o.setProperty(i.name,i.value,void 0===n||n);else if(""+e!==e)for(r in e)o.setProperty(r,e[r],n);else if(e!==kt){for(a=e.split(".");s&&a.length>1;)s=s[a.shift()];s&&o._setProperty(s,a[0],t,n)}return o},removeProperty:function(e){return this.setProperty(e,Mt),this},_setProperty:function(e,t,n,r){var i,a,o,s=t?e[t]:e;Me(s)&&s.set&&(a=s,i=s.set===!0?s:s.set,s=s.call(e)),(s!==n||r&&s!=n)&&(!(s instanceof Date)||s>n||n>s)&&(i?(i.call(e,n),n=a.call(e)):(o=n===Mt)?(delete e[t],n=void 0):t&&(e[t]=n),this._trigger(e,{change:"set",path:t,value:n,oldValue:s,remove:o}))},_trigger:function(t,n){e(t).triggerHandler(jt,n)}},Ft.prototype={_data:null,observeAll:Ht,unobserveAll:Kt,data:function(){return this._data},insert:function(e,t){var n=this._data;return 1===arguments.length&&(t=e,e=n.length),e=Ct(e),e>-1&&e<=n.length&&(t=$e(t)?t:[t],t.length&&this._insert(e,t)),this},_insert:function(e,t){var n=this._data,r=n.length;yt.apply(n,[e,0].concat(t)),this._trigger({change:"insert",index:e,items:t},r)},remove:function(e,t){var n,r=this._data;return void 0===e&&(e=r.length-1),e=Ct(e),t=t?Ct(t):0===t?0:1,t>-1&&e>-1&&(n=r.slice(e,e+t),t=n.length,t&&this._remove(e,t,n)),this},_remove:function(e,t,n){var r=this._data,i=r.length;r.splice(e,t),this._trigger({change:"remove",index:e,items:n},i)},move:function(e,t,n){if(n=n?Ct(n):0===n?0:1,e=Ct(e),t=Ct(t),n>0&&e>-1&&t>-1&&e!==t){var r=this._data.slice(e,e+n);n=r.length,n&&this._move(e,t,n,r)}return this},_move:function(e,t,n,r){var i=this._data,a=i.length;i.splice(e,n),yt.apply(i,[t,0].concat(r)),this._trigger({change:"move",oldIndex:e,index:t,items:r},a)},refresh:function(e){var t=this._data.slice();return this._refresh(t,e),this},_refresh:function(e,t){var n=this._data,r=n.length;yt.apply(n,[0,n.length].concat(t)),this._trigger({change:"refresh",oldItems:e},r)},_trigger:function(t,n){var r=this._data,i=r.length,a=e([r]);i!==n&&a.triggerHandler(jt,{change:"set",path:"length",value:i,oldValue:n}),a.triggerHandler(It,t)}},bt[jt]=bt[It]={remove:function(t){var n,r,i,a,o,s=t.data;if(s&&(s.off=!0,s=s.cb)&&(n=Et[s._cId])){for(i=e._data(this).events[t.type],a=i.length;a--&&!r;)r=(o=i[a].data)&&o.cb&&o.cb._cId===s._cId;r||(delete n[Lt(this).obId],Ot(n,s._cId))}}},Se.map=function(t){function n(e,n,r,i){var a,o=this;this.src&&this.unmap(),typeof e===ft&&(o.src=e,o.tgt=r||o.tgt||[],o.options=n||o.options,o.update(),i||(t.obsSrc&&Le(o.src).observeAll(o.obs=function(e,n){a||(a=!0,t.obsSrc(o,e,n),a=void 0)},o.srcFlt),t.obsTgt&&Le(o.tgt).observeAll(o.obt=function(e,n){a||(a=!0,t.obsTgt(o,e,n),a=void 0)},o.tgtFlt)))}return Me(t)&&(t={getTgt:t}),t.baseMap&&(t=e.extend({},t.baseMap,t)),t.map=function(e,t,r,i){return new n(e,t,r,i)},(n.prototype={srcFlt:t.srcFlt||zt,tgtFlt:t.tgtFlt||zt,update:function(e){var n=this;Le(n.tgt).refresh(t.getTgt(n.src,n.options=e||n.options))},unmap:function(){var e=this;e.src&&(e.obs&&Le(e.src).unobserveAll(e.obs,e.srcFlt),e.obt&&Le(e.tgt).unobserveAll(e.obt,e.tgtFlt),e.src=void 0)},map:n,_def:t}).constructor=n,t}}if(Ue=Se.settings,Fe=Se.converters,De=Se.tags,rt=/<(?!script)(\w+)(?:[^>]*(on\w+)\s*=)?[^>]*>/,e.link)return e;var Wt,Xt,Zt,Gt,Yt,en,tn,nn,rn,an="data-jsv",on="change.jsv",sn="onBeforeChange",ln="onAfterChange",dn="onAfterCreate",cn="checked",fn="checkbox",pn="radio",un="none",vn="SCRIPT",gn="true",hn='"></script>',_n='<script type="jsv',mn=an+"-df",bn="script,["+an+"]",xn={value:"val",input:"val",html:ct,text:"text"},yn={from:"value",to:"value"},wn=0,kn=e.cleanData,Cn=Ue.delimiters,An=document.createDocumentFragment(),jn=document.querySelector,In={ol:1,ul:1,table:1,tbody:1,thead:1,tfoot:1,tr:1,colgroup:1,dl:1,select:1,optgroup:1,svg:1,svg_ns:1},En={tr:"table"},Tn={br:1,img:1,input:1,hr:1,area:1,base:1,col:1,link:1,meta:1,command:1,embed:1,keygen:1,param:1,source:1,track:1,wbr:1},Vn={},Nn={},Sn=1,Bn=/^#(view\.?)?/,Ln=/((\/>)|<\/(\w+)>|)(\s*)([#\/]\d+(?:_|(\^)))`(\s*)(<\w+(?=[\s\/>]))?|\s*(?:(<\w+(?=[\s\/>]))|<\/(\w+)>(\s*)|(\/>)\s*|(>)|$)/g,Mn=/(#)()(\d+)(_)/g,$n=/(#)()(\d+)([_^])/g,Rn=/(?:(#)|(\/))(\d+)(_)/g,Fn=/(#)()(\d+)(\^)/g,Pn=/(?:(#)|(\/))(\d+)([_^])([-+@\d]+)?/g,Dn=je.getComputedStyle;if(Le=e.observable,!Le)throw requiresStr+"JsObservable";return Be=Le.observe,Yt={contents:function(t,n){t!==!!t&&(n=t,t=void 0);var r,i=e(this.nodes());return i[0]&&(r=n?i.filter(n):i,i=t&&n?r.add(i.find(n)):r),i},nodes:function(e,t,n){var r,i=this,a=i._elCnt,o=!t&&a,s=[];for(t=t||i._prv,n=n||i._nxt,r=o?t===i._nxt?i.parentElem.lastSibling:t:i._.inline===!1?t||i.linkCtx.elem.firstChild:t&&t.nextSibling;r&&(!n||r!==n);)(e||a||r.tagName!==vn)&&s.push(r),r=r.nextSibling;return s},childTags:function(e,t){e!==!!e&&(t=e,e=void 0);var n=this,r=n.link?n:n.tagCtx.view,i=n._prv,a=n._elCnt,o=[];return r.link(void 0,n.parentElem,a?i&&i.previousSibling:i,n._nxt,void 0,{get:{tags:o,deep:e,name:t,id:n.link?n._.id+"_":n._tgId+"^"}}),o},refresh:function(e){var t,n,r=this,i=r.linkCtx,a=r.tagCtx.view;return r.disposed&&T("Removed tag"),void 0===e&&(e=Se._tag(r,a,a.tmpl,ve(r),!0)),e+""===e&&(n=r._.inline?ct:i.attr||W(r.parentElem,!0),t=J(e,i,n,r)),ce(r),t||r},update:function(e){var t=this.linkedElem;t&&U({target:t[0]},void 0,e)}},Oe.onStore.template=function(t,n){n.link=Y,n.unlink=me,t&&(e.link[t]=function(){return Y.apply(n,arguments)},e.unlink[t]=function(){return me.apply(n,arguments)})},d(d(Oe._tg.prototype,Yt),{domChange:function(){var t=this.parentElem,n=e.hasData(t)&&e._data(t).events,r="jsv-domchange";n&&n[r]&&e(t).triggerHandler(r,arguments)}}),Oe.viewInfos=oe,(Ue.delimiters=function(){var e=Cn.apply(0,arguments);return Ke=e[0],Je=e[1],ze=e[2],Qe=e[3],We=e[4],Xt=new RegExp("(?:^|\\s*)([\\w-]*)(\\"+We+")?(\\"+Je+Oe.rTag+"\\"+ze+")","g"),this})(),d(d(Oe.View.prototype,Yt),{addViews:function(e,t,n){var r,i,a=this,o=t.length,s=a.views;if(!a._.useKey&&o&&(n=a.tmpl)&&(i=s.length+o,i===a.data.length&&X(a,e,n,s,t,a.ctx)!==!1))for(r=e+o;i>r;r++)Le(s[r]).setProperty("index",r);return a},removeViews:function(t,n,r){function i(t){var n,i,a,o,s,l,d=c[t];if(d&&d.link){if(n=d._.id,r||(l=d.nodes()),d.removeViews(void 0,void 0,!0),d.type=void 0,o=d._prv,s=d._nxt,a=d.parentElem,r||(d._elCnt&&ye(o,s,a,n,"_"),e(l).remove()),!d._elCnt)try{o.parentNode.removeChild(o),s.parentNode.removeChild(s)}catch(f){}Q(d);for(i in d._.bnds)he(i);delete nn[n]}}var a,o,s,l=this,d=!l._.useKey,c=l.views;if(d&&(s=c.length),void 0===t)if(d){for(a=s;a--;)i(a);l.views=[]}else{for(o in c)i(o);l.views={}}else if(void 0===n&&(d?n=1:(i(t),delete c[t])),d&&n&&s-n===l.data.length){for(a=t+n;a-->t;)i(a);if(c.splice(t,n),s=c.length)for(;s>t;)Le(c[t]).setProperty("index",t++)}return this},refresh:function(e){var t=this,n=t.parent;return n&&(X(t,t.index,t.tmpl,n.views,t.data,e,!0),Q(t)),t},link:te}),Fe.merge=function(e){var t,n=this.linkCtx._val||"",r=this.tagCtx.props.toggle;return r&&(t=r.replace(/[\\^$.|?*+()[{]/g,"\\$&"),t="(\\s(?="+t+"$)|(\\s)|^)("+t+"(\\s|$))",n=n.replace(new RegExp(t),"$2"),e=n+(e?(n&&" ")+r:"")),e},De("on",{attr:un,init:function(e){var t=this,n=e.props,r=e.content,i=n.elem;t._.inline&&(t.attr=ct,i=(i||"span")+">",t.template="<"+i+(n.label||r.markup||e.params.args[0])+"</"+i)},render:function(){var e=this.tagCtx;return e.render(e.view,!0)},onAfterLink:function(t,n){var r,i,a=this,o=0,s=t.args,l=s.length,d=t.props,c=d.data,f=t.view,p=d.context;for(a.activeElem=a.activeElem||e(a._.inline?(a._elCnt&&T('Use data-link="{on...}"'),a.nodes()[0]):n.elem);l>o&&!(i=Me(r=s[o++])););i&&(i=s.slice(o),s=s.slice(0,o-1),p||(p=/^(.*)[\.^][\w$]+$/.exec(t.params.args.slice(-i.length-1)[0]),p=p&&Oe.tmplFn("{:"+p[1]+"}",f.tmpl,!0)(n.data,f)),a._evs&&a.onDispose(),a.activeElem.on(a._evs=s[0]||"click",a._sel=s[1],void 0==c?null:c,a._hlr=function(e){return r.apply(p||n.data,[].concat(i,e,{change:e.type,view:f,linkCtx:n},i.slice.call(arguments,1)))}))},onUpdate:function(){return!1},onDispose:function(){this.activeElem.off(this._evs,this._sel,this._hlr)},flow:!0}),d(De["for"],{onArrayChange:function(e,t,n,r){var i,a=e.target,o=a.length,s=this,l=t.change;if(s._.noVws||s.tagCtxs[1]&&("insert"===l&&o===t.items.length||"remove"===l&&!o||"refresh"===l&&!t.oldItems.length!=!o))s.refresh();else for(i in s._.arrVws)i=s._.arrVws[i],i.data===a&&i._.onArrayChange.apply(i,arguments);s.domChange(n,r,t),e.done=!0},onAfterLink:function(t,n){var r,i,a,o,s=this,l=s._ars||{},d=s.tagCtxs,c=d.length,f=s.selected||0;for(r=0;f>=r;r++)t=d[r],o=t.map?t.map.tgt:t.args.length?t.args[0]:t.view.data,(a=l[r])&&o!==a[0]&&(Be(a[0],a[1],!0),delete l[r]),!l[r]&&e.isArray(o)&&(Be(o,i=function(e,r){var i=t;s.onArrayChange(e,r,i,n)}),l[r]=[o,i]);for(r=f+1;c>r;r++)(a=l[r])&&(Be(a[0],a[1],!0),delete l[r]);s._ars=l},onDispose:function(){var e,t=this;for(e in t._ars)Be(t._ars[e][0],t._ars[e][1],!0)}}),d(De["for"],Yt),d(De["if"],Yt),d(De.include,Yt),d(De["if"],{onUpdate:function(e,t,n){var r,i,a;for(r=0;(i=this.tagCtxs[r])&&i.args.length;r++)if(i=i.args[0],a=!i!=!n[r].args[0],!this.convert&&i||a)return a;return!1},onAfterLink:function(e,t,n){n&&this.domChange(e,t,n)}}),De("props",{baseTag:"for",dataMap:Se.map({getTgt:De.props.dataMap.getTgt,obsSrc:ke,obsTgt:Ce,tgtFlt:Ae}),flow:!0}),d(e,{view:Se.view=Zt=function(t,n,r){function i(e,t){if(e)for(o=oe(e,t,Mn),l=0,d=o.length;d>l&&(!(a=nn[o[l].id])||!(a=a&&r?a.get(!0,r):a));l++);}n!==!!n&&(r=n,n=void 0);var a,o,s,l,d,c,f,p=0,u=document.body;if(t&&t!==u&&Ne._.useKey>1&&(t=""+t===t?e(t)[0]:t.jquery?t[0]:t)){if(n){if(i(t._df,!0),!a)for(f=jn?t.querySelectorAll(bn):e(bn,t).get(),c=f.length,s=0;!a&&c>s;s++)i(f[s]);return a}for(;t;){if(o=oe(t,void 0,Rn))for(c=o.length;c--;)if(a=o[c],a.open){if(1>p)return a=nn[a.id],a&&r?a.get(r):a||Ne;p--}else p++;t=t.previousSibling||t.parentNode}}return Ne},link:Se.link=ee,unlink:Se.unlink=_e,cleanData:function(t){t.length&&wn&&ge(t),kn.apply(e,arguments)}}),Se.utility={validate:function(e){try{Ne.link(void 0,document.createElement("div"),void 0,void 0,e,void 0,void 0,1)}catch(t){return t.message}}},d(e.fn,{link:function(e,t,n,r,i,a,o){return ee(e,this,t,n,r,i,a,o)},unlink:function(e){return _e(e,this)},view:function(e,t){return Zt(this[0],e,t)}}),e.each([ct,"replaceWith","empty","remove"],function(t,n){var r=e.fn[n];e.fn[n]=function(){var e;wn=1;try{e=r.apply(this,arguments)}finally{wn=0}return e}}),d(Ne=Oe.topView,{tmpl:{links:{}}}),nn={0:Ne},Ue({wrapMap:tn={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],svg_ns:[1,"<svg>","</svg>"],div:e.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},linkAttr:Gt="data-link",merge:{input:{from:xe,to:"value"},textarea:yn,select:yn,optgroup:{to:"label"}},jsrDbgMode:Ue.debugMode,debugMode:function(e){Ue._dbgMode=e!==!1,je._jsv=Ue._dbgMode?{views:nn,bindings:Nn}:void 0},jsv:function(){Ue.debugMode(Ue._dbgMode),Gt=Ue.linkAttr,T=Se._err,en=bn+",["+Gt+"]",rn=Ue.noDomLevel0,tn.optgroup=tn.option,tn.tbody=tn.tfoot=tn.colgroup=tn.caption=tn.thead,tn.th=tn.td}}),e});
//# sourceMappingURL=jsviews.min.js.map