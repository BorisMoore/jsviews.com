{"version":3,"sources":["validate.js"],"names":["$","views","tags","validation","init","this","childValidates","validate","l","length","result","clearMessage","refreshValidates","refresh","addChild","child","push","removeChild","splice","updateIsValid","onChildValidate","groupIsValid","isValid","observable","setProperty","dataBoundOnly","baseTag","linkedElement","boundProps","tagCtx","linkCtx","tag","radiogroup","props","baseApply","arguments","_","inline","content","template","validationGroup","parents","render","val","ret","view","onBind","targetTag","target","linkedElem","childTags","undefined","onBeforeChange","ev","call","onAfterLink","arg0","cvtArgs","update","preventInvalidData","messageElem","parentNode","elem","nextSibling","addClass","sub","_glt","displayElem","label","insertAfter","onUpdate","eventArgs","tagCtxs","value","onDispose","message","testName","condition","linkedElems","radio","find","type","checked","bndArgs","validator","validators","test","isFunction","replace","textContent","innerText","removeClass","required","equal","min","max","maxLength","minLength","regex","RegExp","jQuery"],"mappings":"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","file":"validate.min.js","sourcesContent":["/*! Sample JsViews tag control: {{validate}} control v0.9.84 (Beta)\nsee: http://www.jsviews.com/#download/sample-tagcontrols */\n/*\n * Copyright 2017, Boris Moore\n * Released under the MIT License.\n */\n\n(function($) {\n\"use strict\";\n\n  $.views.tags({\n  validation: {\n    init: function() {\n      this.childValidates = [];\n    },\n    validate: function() {\n      var l = this.childValidates.length,\n          result = true;\n      while (l-- && result !== false) {\n        result = this.childValidates[l].validate();\n      }\n      return result;\n    },\n    clearMessage: function() {\n      var l = this.childValidates.length;\n      while (l--) {\n        this.childValidates[l].clearMessage();\n      }\n    },\n    refreshValidates: function() {\n      var l = this.childValidates.length;\n      while (l--) {\n        this.childValidates[l].refresh();\n      }\n    },\n    addChild: function(child) {\n      this.childValidates.push(child);\n    },\n    removeChild: function(child) {\n      var l = this.childValidates.length;\n      while (l--) {\n        if (this.childValidates[l] === child) {\n          this.childValidates.splice(l, 1);\n          this.updateIsValid();\n          break;\n        }\n      }\n    },\n    onChildValidate: function() {\n      this.updateIsValid();\n    },\n    updateIsValid: function() {\n      var groupIsValid = true,\n        l = this.childValidates.length;\n      while (l--) {\n        if (!this.childValidates[l].isValid) {\n          groupIsValid = false;\n          break;\n        }\n      }\n      $.observable(this).setProperty(\"isValid\", groupIsValid);\n    },\n    isValid: true,\n    dataBoundOnly: true\n  },\n  validate: {\n    baseTag: \"radiogroup\",\n    linkedElement: \"select,textarea,input\",\n    boundProps: [\"preventInvalidData\"],\n    init: function(tagCtx, linkCtx) {\n      var tag = this;\n      if (tag.radiogroup = tagCtx.props.radiogroup) {\n        tag.baseApply(arguments);\n      } else if (tag._.inline && !tagCtx.content) {\n        tag.template = \"<input/>\";\n      }\n      tag.validationGroup = this.parents.validation;\n      if (tag.validationGroup) {\n        tag.validationGroup.addChild(this);\n      }\n    },\n    render: function(val) {\n      var ret,\n        tag = this,\n        tagCtx = this.tagCtx;\n      if (tag._.inline) {\n         // Keep same data context for content\n        ret = tagCtx.render(tagCtx.view, true);\n        // For radio buttons provide wrapper for validation messages\n        ret = tag.radiogroup ? (\"<div>\" + ret + \"</div>\") : ret;\n        return ret;\n      }\n    },\n    onBind: function(tagCtx, linkCtx) {\n      var targetTag,\n        tag = this,\n        target = tag.linkedElem && tag.linkedElem[0];\n\n      if (targetTag = tag.childTags()[0]) {\n        // {{validate}} may wrap another tag, such as {{slider}}\n        // or {{datepicker}} rather than an element such as <input/>\n        tag.targetTag = targetTag;\n        if (target && $.view(target).tag === targetTag) {\n          tag.linkedElem = undefined;\n        }\n        targetTag.onBeforeChange = function(ev, val) {\n          return tag.onBeforeChange.call(tag, ev, val);\n        };\n      }\n      if (tag.radiogroup) {\n        this.baseApply(arguments);\n      }\n    },\n    onAfterLink: function(tagCtx, linkCtx) {\n      var tag = this,\n        targetTag = tag.targetTag,\n        props = tagCtx.props,\n        arg0 = tag.cvtArgs()[0];\n\n      if (targetTag) {\n        targetTag.update(arg0);\n      }\n\n      if (props.preventInvalidData !== undefined) {\n        tag.preventInvalidData = props.preventInvalidData;\n      } else if (tag.parents.validation) {\n        tag.preventInvalidData = tag.parents.validation.tagCtx.props.preventInvalidData;\n      }\n      if (!tag.messageElem || !tag.messageElem.parentNode) {\n        if (tag.radiogroup) {\n          // messageElem is the div which wraps the group of radio buttons and/or labels\n          tag.messageElem = $(tag._.inline ? linkCtx.elem.nextSibling : linkCtx.elem);\n          tag.messageElem.addClass(\"radiogroup\");\n        } else {\n          if (!tag._.inline && (targetTag = $.views.sub._glt(linkCtx.elem)[0])) {\n            // Scenario with data-link=\"{targetTag ...}{validate ...}\" (both tags data-linked on same linkedElem)\n            tag.targetTag = targetTag;\n          }\n          tag.messageElem = targetTag && (targetTag.displayElem || targetTag.linkedElem)\n            || tag.displayElem || tag.linkedElem;\n        }\n        tag.messageElem.addClass(\"val-msg\");\n      }\n\n      if (!tag.label || !tag.label.parentNode) {\n        tag.label = $(\"<label class=\\\"error\\\"></label><br/>\").insertAfter(tag.messageElem)[0];\n      }\n      tag.validate(arg0); // Validate initial data\n    },\n    onUpdate: function(ev, eventArgs, tagCtxs) {\n      this.clearMessage();\n      return false; // don't rerender\n    },\n    onBeforeChange: function(ev, eventArgs) {\n      if (this.preventInvalidData) {\n        this.validate(eventArgs.value);\n        return this.isValid;\n        // Allow data to be updated to invalid values - unless preventInvalidData set to true\n      }\n    },\n    onDispose: function() {\n      if (this.validationGroup) {\n        this.validationGroup.removeChild(this);\n      }\n    },\n    validate: function(val) {\n      var message, linkedElem, testName, condition,\n        tag = this,\n        props = tag.tagCtx.props,\n        linkedElems = tag.linkedElem;\n\n      if (val === undefined) {\n        // If no val passed in, get current value from linkedElem, and validate that\n        if (tag._.radio && linkedElems) {\n          linkedElems = linkedElems.find(\"input:checked\");\n        }\n        linkedElem = linkedElems && linkedElems[0];\n        val = \"\";\n        if (linkedElem) {\n          val = linkedElem.type === \"checkbox\" ? linkedElem.checked : linkedElem.value;\n        } else if (tag.targetTag) {\n          val = tag.targetTag.bndArgs()[0];\n        }\n        val = val || \"\";\n      }\n      tag.clearMessage();\n\n      // Test the validation conditions, one after the other.\n      this.isValid = true;\n      for (var validator in this.validators) {\n        condition = props[validator];\n        if (condition !== undefined && this.validators[validator].test(condition, val)) {\n          testName = validator;\n          this.isValid = false;\n          break;\n        }\n      }\n      if (!this.isValid) {// A test failed. Show message for first failed test.\n        message = props[\"msg_\" + testName] || this.validators[testName].message;\n        if ($.isFunction(message)) {\n          message = message(condition, val);\n        }\n        message = message.replace(/%cond%/g, condition).replace(/%val%/g, val)\n        if (tag.label.textContent !== undefined) {\n          tag.label.textContent = message;\n        } else {\n          tag.label.innerText = message; // Older IE does not support textContent\n        }\n        tag.messageElem.addClass(\"invalid\");\n      }\n      if (this.validationGroup) {\n        this.validationGroup.onChildValidate();\n      }\n      return this.isValid;\n    },\n    validators: function(validators) {\n      for (var validator in validators) {\n        this.validators[validator] = validators[validator];\n      }\n    },\n    clearMessage: function() {\n      // Clear previous message.\n      var tag = this,\n        label = tag.label;\n      if (tag.messageElem) {\n        tag.messageElem.removeClass(\"invalid\");\n        if (label.textContent !== undefined) {\n          label.textContent = \"\";\n        } else {\n          label.innerText = \"\"; // Older IE does not support textContent\n        }\n      }\n    }\n}\n});\n\n$.views.tags.validate.validators({\n  required: {\n    message: \"Please provide a value\",\n    test: function(condition, val) {\n      return condition && val === \"\";\n    }\n  },\n  equal: {\n    message: \"Value must be %cond%\",\n    test: function(condition, val) {\n      return val !== \"\" + condition;\n    }\n  },\n  checked: {\n    message: function(condition, val) {\n      return \"Must be \" + (condition ? \"checked\" : \"unchecked\");\n    },\n    test: function(condition, val) {\n      return (val && val !== \"false\") !== condition;\n    }\n  },\n  min: {\n    message: \"Minimum: %cond%\",\n    test: function(condition, val) {\n      return val < condition;\n    }\n  },\n  max: {\n    message: \"Maximum:  %cond%\",\n    test: function(condition, val) {\n      return val > condition;\n    }\n  },\n  maxLength: {\n    message: \"Maximum length: %cond%\",\n    test: function(condition, val) {\n      return val.length > condition;\n    }\n  },\n  minLength: {\n    message: \"Minimum length: %cond%\",\n    test: function(condition, val) {\n      return val.length < condition;\n    }\n  },\n  regex: {\n    message: \"Invalid string format\",\n    test: function(condition, val) {\n      var regex = condition.test ? condition : new RegExp(condition);\n      return !regex.test(val);\n    }\n  }\n});\n\n})(this.jQuery);\n"]}