{"version":3,"sources":["jsviews-jqueryui-widgets.js"],"names":["global","$","undefined","keepParentDataCtx","val","this","tagCtx","view","checkboxRadioOnAfterLink","linkCtx","tag","props","elem","linkedElem","cvtArgs","name","value","checked","type","baseApply","arguments","displayElem","widget","label","option","unlinkedClone","clone","find","addBack","removeAttr","remove","tagDefs","linkedElement","init","content","elemType","_","inline","tmpl","markup","template","wrap","trim","attr","onBind","prop","i","optionKey","presets","initOptions","widgetName","widgetFullName","split","pop","length","tagName","data","onAfterLink","options","isFunction","each","key","charAt","slice","apply","onUpdate","dataBoundOnly","button","baseTag","setSize","innerHTML","ctx","event","refresh","contentCtx","autocomplete","change","evt","ui","item","update","select","focus","setValue","getValue","checkbox","radio","controlgroup","on","datepicker","onSelect","dateText","inst","css","trigger","droppable","menu","progressbar","args","busy","resizable","selectable","selectmenu","unlinked","slider","slide","setTimeout","spinner","spin","tabs","element","views","tags","version","id","parent","chkBx","params","paramprops","Math","random","convert","convertBack","after","buttonset","buttons","sortable","_create","innerView","moveFrom","startOption","start","stopOption","stop","index","moveTo","prevAll","cancel","observable","move","_super","draggable","_createHelper","helper","accordion","header","replace","jQuery"],"mappings":"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","file":"jsviews-jqueryui-widgets.min.js","sourcesContent":["/*! JsViews jQueryUI widget integration v0.9.81 (Beta)\nsee: http://www.jsviews.com/#download/tag-controls */\n/*\n * Copyright 2016, Boris Moore\n * Released under the MIT License.\n */\n\n/* Wrap behavior (wrapping HTML content) and default element, for each widget: */\n\n/*         autocomplete button   buttonset  droppable  menu      progressbar  resizable\n * wrap:   -            wrap     -          wrap       wrap      wrap         wrap     \n * elem:   input        button   -          -          ul        div          div      \n */\n\n/*         selectable   slider   spinner    tabs       sortable  draggable    accordion\n * wrap:   wrap         -        -          wrap       wrap      wrap         wrap\n * elem:   -            div      input      div        -         -            -\n */\n\n/*         controlgroup checkbox radio      selectmenu datepicker\n * wrap:   wrap         -        -          wrap       wrap\n * elem:   span         div      input      selectv    input\n */\n\n(function (global, $, undefined) {\n\"use strict\";\n\nfunction keepParentDataCtx(val) {\n  return this.tagCtx.view; // Return the parent view as data context for rendering block content\n}\n\nfunction checkboxRadioOnAfterLink(tagCtx, linkCtx) {\n  var tag = this,\n    props = tagCtx.props,\n    elem = tag.linkedElem[0],\n    val = tag.cvtArgs()[0];\n  // Set the value to arg[0] (after applying converter, if there is one)\n\n  if (props.name) {\n    elem.name = props.name;\n  }\n  if (props.value) {\n    elem.value = props.value;\n  }\n  elem.checked = elem.type === \"radio\"\n    ? (val === elem.value)\n    : val && val !== \"false\";\n\n  tag.baseApply(arguments);\n\n  tag.displayElem = tag.widget.label;\n\n  if (props.label) {\n    tag.widget.option(\"label\", props.label);\n  }\n}\n\nvar tagDefs = {\n\nwidget: {\n  linkedElement: \"*\",\n  init: function(tagCtx) {\n    var content, elemType, props,\n      tag = this;\n\n    if (tag._.inline) {\n      props = tagCtx.props;\n      content = tagCtx.tmpl.markup;\n      if (!tag.template && (elemType = props.elem || tag.elem)) {\n        if (content) {\n          if (tag.wrap) {\n            tag.template = \"<\" + elemType + \">\" + $.trim(content) + \"</\" + elemType + \">\";\n          }\n        } else {\n          tag.template = (elemType === \"input\") ? \"<input/>\" : \"<\"+ elemType +\"></\"+ elemType +\">\";\n        }\n      }\n      tag.attr = \"html\";\n    }\n  },\n  onBind: function(tagCtx) {\n    var linkedElem, prop, i, optionKey,\n      tag = this,\n      presets = tag.initOptions,\n      widgetName = tag.widgetName,\n      widgetFullName = widgetName;\n      widgetName = widgetName.split(\"-\").pop();\n\n    if (i = presets && presets.length) {\n      presets = {};\n      while (i--) {\n        optionKey = tag.initOptions[i];\n        if (prop = tagCtx.props[\"_\" + optionKey]) {\n          presets[optionKey] = prop;\n        }\n      }\n    }\n    if (widgetFullName === widgetName) {\n      widgetFullName = \"ui-\" + widgetName;\n    }\n    linkedElem = tag.linkedElem;\n    if (!linkedElem[0]) {\n      // This may be due to using {{myWidget}} No element found here {{/myWidget}} \n      throw \"No element found for tag '\" + tag.tagName +\"'\";\n    }\n    // Instantiate widget\n    linkedElem[widgetName](presets);\n\n    // Store widget instance\n    tag.widget = linkedElem.data(widgetFullName) || linkedElem.data(widgetName);\n\n    if (!tag.widget) {\n      // widget failed to load, or is not a valid widget factory type\n      throw \"widget '\" + widgetName + \"' failed\";\n    }\n  },\n  onAfterLink: function(tagCtx) {\n    var linkedElem,\n      tag = this,\n      options = tag.options,\n      props = tagCtx.props,\n      widgetName = tag.widgetName.split(\"-\").pop();\n\n    linkedElem = tag.linkedElem;\n    if (options) {\n      if ($.isFunction(options)) {\n        options = tag.options();\n      }\n      tag.linkedElem[widgetName](\"option\", options);\n    }\n    $.each(props, function(key, prop) {\n      var option;\n      if (key.charAt(0) === \"_\") {\n        key = key.slice(1);\n        option = options && options[key];\n        linkedElem[widgetName](\"option\", key,\n          option && $.isFunction(option)\n            ? function() {\n              // if the same event function option is overridden on the tagDef options and\n              // the tagCtx.props, call first the one on the initOptions options, and then\n              // the one declared on the tag properties. \n              option.apply(linkedElem[0], arguments);\n              return prop.apply(linkedElem[0], arguments);\n            }\n            : prop\n          );\n      }\n    });\n  },\n  onUpdate: function() {\n    return false;\n  },\n  dataBoundOnly: true,\n  attr: \"none\"\n},\n\nbutton: {\n  baseTag: \"widget\",\n  widgetName: \"button\",\n  elem: \"button\",\n  setSize: true,\n  wrap: true,\n  onBind: function(tagCtx, linkCtx) {\n    var elem = this.linkedElem[0];\n      elem.innerHTML = elem.innerHTML || \"&nbsp;\"; // Fixes jQuery UI button issue if no label text\n    this.baseApply(arguments);\n  },\n  onAfterLink: function(tagCtx, linkCtx, ctx, event) {\n    this.baseApply(arguments);\n    if (event) {\n      this.widget.refresh();\n    }\n  },\n  contentCtx: keepParentDataCtx\n},\nautocomplete: {\n  baseTag: \"widget\",\n  widgetName: \"autocomplete\",\n  elem: \"input\",\n  setSize: true,\n  options: function() {\n    var tag = this;\n    return {\n      change: function(evt, ui) {\n        if (ui.item) {\n          tag.update(ui.item.value);\n          // If there is a selected item, update bound value on keydown.\n          // (Alternatively can set trigger=false to update on change)\n        }\n      },\n      select: function(evt, ui) {\n        if (ui.item) {\n          tag.update(ui.item.value);\n        }\n      },\n      focus: function(evt, ui) {\n        return false;\n      }\n    };\n  },\n  setValue: function(value) {\n    this.linkedElem.val(value);\n  },\n  getValue: function() {\n    return this.linkedElem.val();\n  }\n},\ncheckbox: {\n  baseTag: \"widget\",\n  widgetName: \"checkboxradio\",\n  template: \"<label><input type='checkbox'/></label>\",\n  linkedElement: \"input\",\n  onAfterLink: checkboxRadioOnAfterLink\n},\nradio: {\n  baseTag: \"widget\",\n  widgetName: \"checkboxradio\",\n  template: \"<label><input type='radio'/></label>\",\n  linkedElement: \"input\",\n  onAfterLink: checkboxRadioOnAfterLink\n},\ncontrolgroup: {\n  baseTag: \"widget\",\n  widgetName: \"controlgroup\",\n  wrap: true,\n  elem: \"span\",\n  contentCtx: keepParentDataCtx,\n  onBind: function() {\n    var tag = this;\n    tag.baseApply(arguments);\n    tag.linkedElem.on(\"jsv-domchange\", function() {\n      tag.widget.refresh();\n    });\n\t}\n},\ndatepicker: {\n  baseTag: \"widget\",\n  widgetName: \"datepicker\",\n  elem: \"input\",\n\n  options: function() {\n    var tag = this;\n    return {\n      onSelect: function(dateText, inst) {\n        tag.value = dateText;\n        tag.update(dateText);\n      }\n    };\n  },\n  setValue: function(value) {\n    if (value !== undefined && value !== this.value) {\n      this.value = value;\n      this.linkedElem.datepicker(\"setDate\", value);\n    }\n  },\n  getValue: function() {\n    return this.value;\n  },\n  onAfterLink: function(tagCtx) {\n    var tag = this;\n    tag.baseApply(arguments);\n    tag.setValue(tag.cvtArgs()[0]);\n    if (tag.linkedElem[0].tagName !== \"INPUT\") {\n      // This datepicker is not using an input (e.g. using a div) - so set to inline-block\n      tag.linkedElem.css(\"display\", \"inline-block\");\n    } else {\n      tag.tagCtx.props.trigger = false;\n    }\n  }\n},\n//dialog: { // Currently not supported. (Support would require overriding _createWrapper code.)\n//  baseTag: \"widget\",\n//  widgetName: \"dialog\",\n//  wrap: true,\n//  elem: \"div\"\n//},\ndroppable: {\n  baseTag: \"widget\",\n  widgetName: \"droppable\",\n  wrap: true\n},\nmenu: {\n  baseTag: \"widget\",\n  widgetName: \"menu\",\n  elem: \"ul\",\n  wrap: true,\n  initOptions: [\"menus\", \"items\"] // Options which need to be set on creation, not later\n},\nprogressbar: {\n  baseTag: \"widget\",\n  widgetName: \"progressbar\",\n  elem: \"div\",\n  wrap: true,\n  setSize: true,\n  setValue: function(value) {\n    var tag = this;\n    tag.widget.value(value || 0);\n  },\n  getValue: function() {\n    return this.widget.value();\n  },\n  onAfterLink: function(tagCtx) {\n    var tag = this;\n    tag.baseApply(arguments);\n    if (tagCtx.args.length) {\n      // Set the value to arg[0] (after applying converter, if there is one)\n      tag.setValue(tag.cvtArgs()[0]);\n    }\n    if (tagCtx.props.busy) {\n      // Set the value to arg[0] (after applying converter, if there is one)\n      tag.widget.value(false);\n    }\n  },\n  contentCtx: keepParentDataCtx\n},\nresizable: {\n  baseTag: \"widget\",\n  widgetName: \"resizable\",\n  wrap: true,\n  elem: \"div\"\n},\nselectable: {\n  baseTag: \"widget\",\n  widgetName: \"selectable\",\n  wrap: true\n},\nselectmenu: {\n  baseTag: \"widget\",\n  widgetName: \"selectmenu\",\n  elem: \"select\",\n  wrap: true,\n  options: function() {\n    var tag = this;\n    return {\n      change: function(evt, ui) {\n        tag.update(ui.value);\n      }\n    };\n  },\n  setValue: function(value) {\n    this.linkedElem[0].value = value;\n    this.widget.refresh();\n  },\n  getValue: function() {\n    return this.linkedElem[0].value;\n  },\n  onAfterLink: function() {\n    var tag = this;\n    tag.baseApply(arguments);\n    if (tag._.unlinked) {\n      tag.linkedElem.on(\"jsv-domchange\", function() {\n        tag.widget.refresh();\n      });\n      tag.displayElem = tag.widget.button;\n    }\n    // Set the value to arg[0] (after applying converter, if there is one)\n    tag.setValue(tag.cvtArgs()[0]);\n  },\n  contentCtx: keepParentDataCtx\n},\nslider: {\n  baseTag: \"widget\",\n  widgetName: \"slider\",\n  elem: \"div\",\n  setSize: true,\n  options: function() {\n    var tag = this;\n    return {\n      slide: function(evt, ui) {\n        setTimeout(function() {\n          tag.update(ui.value);\n        }, 0);\n      }\n    };\n  },\n  setValue: function(value) {\n    this.widget.value(value || 0);\n  },\n  getValue: function() {\n    return this.widget.value();\n  },\n  onAfterLink: function() {\n    var tag = this;\n    tag.baseApply(arguments);\n    // Set the value to arg[0] (after applying converter, if there is one)\n    tag.setValue(tag.cvtArgs()[0]);\n  }\n},\nspinner: {\n  baseTag: \"widget\",\n  widgetName: \"spinner\",\n  elem: \"input\",\n  setSize: true,\n  options: function() {\n    var tag = this;\n    return {\n      spin: function(evt, ui) {\n        tag.update(ui.value);\n      }\n    };\n  },\n  setValue: function(value) {\n    this.widget.value(value || 0);\n  },\n  getValue: function() {\n    return this.widget.value();\n  }\n},\ntabs: {\n  baseTag: \"widget\",\n  widgetName: \"tabs\",\n  elem: \"div\",\n  setSize: true,\n  onBind: function() {\n    var tag = this;\n    tag.baseApply(arguments);\n    tag.displayElem = tag.widget.element;\n  },\n  wrap: true\n}\n\n};\n\n$.views.tags(tagDefs);\n\nif ($.ui.version.slice(0, 4) === \"1.11\") {\n  // Add backward compatibility for {{buttonset}} and {{button}}\n  tagDefs.button = {\n    baseTag: \"widget\",\n    widgetName: \"button\",\n    elem: \"button\",\n    setSize: true,\n    init: function(tagCtx, linkCtx) {\n      var template,\n        tag = this,\n        content = tagCtx.tmpl,\n        props = tagCtx.props,\n        id = props.id,\n        parent = tag.parent;\n\n      if (tag._.radio = parent && parent.tagName === \"buttonset\") {\n        tagCtx = parent.tagCtx;\n      } else {\n        tag._.chkBx = (tag._.inline ? props : linkCtx.elem).type === \"checkbox\";\n      }\n\n      var  params = tagCtx.params,\n        paramprops = params.props || {};\n\n      tag.baseApply(arguments);\n\n      if (tag._.inline) {\n        content = content && content.markup || \"&nbsp;\"; // (&nbsp; fixes a jQueryUI button rendering issue)\n        if (tag._.radio || tag._.chkBx) {\n          id = id || \"jsv\" + Math.random();\n          template = '<input id=\"' + id + '\" data-link=\"' + params.args[0] \n            + (paramprops.convert ? \" convert=\" + paramprops.convert : \"\")\n            + (paramprops.convertBack ? \" convertBack=\" + paramprops.convertBack : \"\")\n            + (tag._.radio\n              ? '\" name=\"' + parent.id + '\" type=\"radio\" value=\"' + props.value + \n                '\"/><label for=\"' + id + '\">' + content + '</label>'\n              : '\" type=\"checkbox\"/><label for=\"' + id + '\">' + content + '</label>');\n        } else {\n          template = \"<button>\" + content + \"</button>\";\n        }\n        tag.template = template;\n      }\n    },\n    onAfterLink: function(tagCtx, linkCtx) {\n      var tag = this,\n        elem = linkCtx.elem,\n        val = tag.cvtArgs()[0];\n\n      if (tag._.radio || tag._.chkBx) {\n        if (!tag._.inline) {\n          if (tag._.unlinked && !elem.id) {\n            elem.id = \"jsv\" + Math.random();\n            $(elem).after('<label for=\"' + elem.id + '\">&nbsp;</label>');\n          }\n          elem.checked = tag._.radio\n            ? (elem.name = tag.parent.id, val === elem.value)\n            : val && val !== \"false\";\n        }\n\n        tag.baseApply(arguments);\n\n        elem = tag.linkedElem[0];\n\n        if (tag._.radio) {\n          // Use {^{button value=\"xxx\"}}Label{{/button}}\n          if (elem.value === \"undefined\") {\n            // Default, for {^{button}}xxx{{/button}} or {^{button _label=\"xxx\"/}}\n            elem.value = tag.widget.option(\"label\"); \n          }\n          elem.checked = val === elem.value;\n        } else {\n          elem.checked = val && val !== \"false\";\n        }\n\n        if (tag._.chkBx) {\n          tag.widget.refresh();\n        }\n      } else {\n        if (!tag._.inline) {\n          elem.innerHTML = elem.innerHTML || \"&nbsp;\"; // Fixes jQuery UI button issue if no label text\n        }\n        tag.baseApply(arguments);\n      }\n    },\n    contentCtx: keepParentDataCtx\n  };\n\n  tagDefs.buttonset = {\n    baseTag: \"widget\",\n    widgetName: \"buttonset\",\n    setSize: true,\n    init: function(tagCtx) {\n      var id,\n        tag = this;\n\n      tag.baseApply(arguments);\n\n      if (tag._.inline) {\n        tag.id = tagCtx.props.id || \"jsv\" + Math.random();\n        tag.template = '<span id=\"' + tag.id + '\">' + tagCtx.tmpl.markup + \"</span>\";\n      }\n    },\n    onAfterLink: function(tagCtx, linkCtx) {\n      var tag = this,\n        elem = linkCtx.elem,\n        val = tag.cvtArgs()[0];\n      tag.baseApply(arguments);\n      tag.widget.buttons.each(function(i, elem) {\n        elem.checked = val === elem.value;\n        $(elem).button(\"refresh\");\n      });\n    },\n    contentCtx: keepParentDataCtx\n  };\n}\n\n// Compile tags\n$.views.tags(tagDefs);\n\nif ($.ui.sortable) {\n  $.widget(\"jsv.sortable\", $.ui.sortable, {\n    _create: function() {\n      var innerView, moveFrom,\n        widget = this,\n        startOption = widget.options.start,\n        stopOption = widget.options.stop;\n\n      widget.option({\n        start: function(event, ui) {\n          startOption && startOption.apply(this, arguments);\n\n          innerView = ui.item.view(); // The view of the item that is being dragged\n          if (innerView.type === \"item\") {\n            // The sortable items are within a {{for}} loop, so this is a data-linked sortable list\n            moveFrom = innerView.index + 1; // 1-based starting index of dragged item\n          }\n        },\n        stop: function(event, ui) {\n          var moveTo;\n\n          if (moveFrom) {\n            // This is a data-linked sortable list\n            moveTo = ui.item.prevAll(ui.item[0].tagName).length; // The new index after\n            // being dragged (count of previous siblings of same tagName)\n            widget.cancel(); // Now cancel the DOM changes, since we are data-driven,\n            // and should use JsViews data-linking to move the sorted items\n            $.observable(innerView.parent.data).move(moveFrom-1, moveTo); // Make the equivalent\n            // observable change to the underlying data\n            moveFrom = undefined;\n            // Remove the starting index, ready for new sorting actions on this sortable list\n          }\n          stopOption && stopOption.apply(this, arguments);\n        }\n      });\n      widget._super();\n    }\n  });\n}\n\nfunction unlinkedClone() {\n  // Ensure that cloned element (and its contents) created by jQuery UI to show dragging element does not\n  // have any data-jsv tokens (since deleting the element would them remove those views associated with\n  // the original element)\n  var clone = $(this).clone();\n  clone.find(\"*\").addBack().removeAttr( \"id data-link data-jsv data-jsv-df\" );\n  clone.find(\"script\").remove();\n  return clone;\n}\n\nif ($.ui.draggable) {\n  // Create derived draggable widget\n  $.widget(\"jsv.draggable\", $.ui.draggable, {\n    _createHelper: function() {\n      if (this.options.helper === \"clone\") {\n        this.options.helper = unlinkedClone;\n      }\n      return this._super();\n    }\n  });\n\n  $.views.tags(\"draggable\", {\n    baseTag: \"widget\",\n    widgetName: \"jsv-draggable\",\n    wrap: true\n  });\n}\n\nif ($.ui.accordion) {\n  // Create derived accordion widget\n  $.widget(\"jsv.accordion\", $.ui.accordion, {\n    _create: function() {\n      var widget = this;\n      widget.options.header = widget.options.header.replace(\":not(li):even\", \":not(li,script):even\");\n      widget.element.on(\"jsv-domchange\", function() {\n        widget.refresh();\n      });\n      widget._super();\n    }\n  });\n  $.views.tags(\"accordion\", {\n    baseTag: \"widget\",\n    widgetName: \"jsv-accordion\",\n    wrap: true,\n    initOptions: [\"header\"] // Options which need to be set on creation, not later\n  });\n}\n\nif ($.ui.sortable) {\n  $.views.tags(\"sortable\", {\n    baseTag: \"widget\",\n    widgetName: \"jsv-sortable\",\n    wrap: true\n  });\n}\n\n})(this, this.jQuery);"]}