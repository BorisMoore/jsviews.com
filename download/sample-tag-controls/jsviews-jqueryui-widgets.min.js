/*! JsViews jQueryUI widget integration v0.9.87 (Beta)
see: http://www.jsviews.com/#download/jqueryui-tagcontrols */
!function(e,t,i){"use strict";function n(e,t){return t+""===t?e.tagCtx.contentView.getRsc("converters",t):t}function a(e,t){var i=this,n=e.props,a=i.mainElem[0];i.bndArgs()[0];n.name&&(a.name=n.name),n.value&&(a.value=n.value),i.baseApply(arguments),i.displayElem=i.widget.label,n.label&&i.widget.option("label",n.label)}function o(e,t){var i=this;i.baseApply(arguments),i.mainElem.on("jsv-domchange",function(e,t,n,a){var o,s=i.widget.option("active");i.widget.refresh(),o=i.widget.option("active"),s!==o&&i.updateValue(o)})}function s(){var e=this;return{activate:function(t,i){e.updateValue(e.widget.option("active"))}}}function r(e,t){var n,a=t.props.dataFormat;return a===i&&(a=e.dataFormat),n=a&&a.parse?a:e.dataFormatter,e.parseData=function(t){return n.parse.call(e,t,e.tagCtx.props)},e.formatData=function(t){return n.format.call(e,t,e.tagCtx.props)},a}function l(){var e=t(this).clone();return e.find("*").addBack().removeAttr("id data-link data-jsv data-jsv-df"),e.find("script").remove(),e}if(!(t&&t.fn&&t.ui&&t.views))throw"jsviews-jqueryui-widgets.js requires jQuery, jQuery UI and JsViews";var u={widget:{argDefault:!1,mainElement:"*",init:function(e){var i,n,a=this;a.inline&&(i=e.tmpl.markup,!a.template&&(n=e.props.elem||a.elem)&&(i?a.wrap&&(a.template="<"+n+">"+t.trim(i)+"</"+n+">"):a.template="input"===n?"<input/>":"<"+n+"></"+n+">"),a.attr="html")},onBeforeBind:function(e){var i,n,a,o,s=this,r=s.initOptions,l=s.widgetName,u=s.options,p=l;if(l=l.split("-").pop(),a=r&&r.length)for(r={};a--;)o=s.initOptions[a],(n=e.props["_"+o])&&(r[o]=n);if(p===l&&(p="ui-"+l),i=s.mainElem,!i||!i[0])throw"No element found for tag '"+s.tagName+"'";if(e.props.id&&!i[0].id&&(i[0].id=e.props.id),i[l](r),s.widget=i.data(p)||i.data(l),!s.widget)throw"widget '"+l+"' failed";u&&(t.isFunction(u)&&(u=s.options()),i[l]("option",u))},onAfterLink:function(e){var i,n=this,a=n.options,o=e.props,s=n.widgetName.split("-").pop();t.isFunction(a)&&(a=n.options()),i=n.mainElem,t.each(o,function(e,n){var o;"_"===e.charAt(0)&&(e=e.slice(1),o=a&&a[e],i[s]("option",e,o&&t.isFunction(o)&&n&&t.isFunction(n)?function(){return o.apply(i[0],arguments),n.apply(i[0],arguments)}:n))})},onUpdate:!1,dataBoundOnly:!0,attr:"none"},button:{baseTag:"widget",widgetName:"button",elem:"button",wrap:!0,setSize:!0,contentCtx:!0,onBind:function(e,t){var i=this.mainElem[0];i.innerHTML=i.innerHTML||"&nbsp;",this.baseApply(arguments)},onAfterLink:function(e,t,i,n){this.baseApply(arguments),n&&this.widget.refresh()}},autocomplete:{baseTag:"widget",widgetName:"autocomplete",linkedElement:"*",elem:"input",setSize:!0,options:function(){var e=this;return{change:function(t,i){i.item&&e.updateValue(i.item.value)},select:function(t,i){i.item&&e.updateValue(i.item.value)},focus:function(e,t){return!1}}}},checkbox:{baseTag:"widget",widgetName:"checkboxradio",template:"<label><input type='checkbox'/></label>",mainElement:"input",linkedElement:"input",setSize:!0,onBeforeBind:a,setValue:function(e){if(e!==i){var t=this.mainElem[0];t.checked=e&&"false"!==e}}},radio:{baseTag:"widget",widgetName:"checkboxradio",template:"<label><input type='radio'/></label>",mainElement:"input",linkedElement:"input",setSize:!0,onBeforeBind:a,onBind:function(){var e=this,t=e.parents.radiogroup;e.baseApply(arguments),t&&!t.onAfterLink&&(t.onAfterLink=function(e){for(var t=this.bndArgs()[0],i=this.childTags("radio"),n=i.length;n--;)i[n].setValue(t)})},setValue:function(e){if(e!==i){var t=this.mainElem[0];t.checked=e===t.value}this.widget.refresh()}},controlgroup:{baseTag:"widget",widgetName:"controlgroup",elem:"span",wrap:!0,contentCtx:!0,onBind:function(){var e=this;e.baseApply(arguments),e.mainElem.on("jsv-domchange",function(){e.widget.refresh()})}},datepicker:{baseTag:"widget",widgetName:"datepicker",linkedElement:"*",elem:"input",setSize:!0,dataFormat:!0,dataFormatter:{parse:function(e,i){return t.datepicker.parseDate(this.dataFormat,e)},format:function(e,i){return t.datepicker.formatDate(this.dataFormat,e)}},init:function(e){var i=this,a=i.dateFormat=e.props.dateFormat||e.props._dateFormat||i.dateFormat||t.datepicker._defaults.dateFormat,o=n(i,i.convert),s=n(i,i.convertBack),l=r(i,e);i.dataFormat=l===!0?i.dateFormat:l,i.convert=function(e){return e=o?o.call(i,e):e,i.dataFormat&&""+e===e&&(e=i.parseData(e)),t.datepicker.formatDate(a,0===l?new Date(e):e)},i.convertBack=function(e){return e=t.datepicker.parseDate(a,e),e=l?i.formatData(e):0===l?+e:e,s?s.call(i,e):e},i.convert.fix=i.convertBack.fix=!0,i.baseApply(arguments)},options:function(){var e=this;return{onSelect:function(t){e.value=t,e.updateValue(t)}}},onBind:function(e){var t=this;t.baseApply(arguments),t.mainElem.datepicker("option","dateFormat",t.dateFormat),"INPUT"!==t.mainElem[0].tagName?t.mainElem.css("display","inline-block"):t.tagCtx.props.trigger=!1},setValue:function(e){var t=this;e!==i&&e!==t.value&&(t.value=e,t.mainElem.datepicker("setDate",e))},getValue:function(){return this.value}},droppable:{baseTag:"widget",widgetName:"droppable",elem:"div",wrap:!0,setSize:!0,contentCtx:!0,setValue:function(e){t.isFunction(e)&&this.widget.option("drop",e)}},menu:{baseTag:"widget",widgetName:"menu",elem:"ul",wrap:!0,setSize:!0,contentCtx:!0,initOptions:["menus","items","role"],setValue:function(e){t.isFunction(e)&&this.widget.option("select",e)}},progressbar:{baseTag:"widget",widgetName:"progressbar",boundProps:["busy"],bindTo:0,elem:"div",wrap:!0,setSize:!0,contentCtx:!0,setValue:function(e){this.tagCtx.props.busy||this.widget.value(parseFloat(e)||0)},getValue:function(){return this.widget.value()},onAfterLink:function(e){var t=this;t.baseApply(arguments),e.props.busy&&t.widget.value(!1)}},resizable:{baseTag:"widget",widgetName:"resizable",bindTo:["width","height"],linkedCtxParam:["width","height"],elem:"div",wrap:!0,contentCtx:!0,options:function(){var e=this;return{resize:function(t,i){setTimeout(function(){e.updateValues(i.size.width,i.size.height)},0)}}},setValue:function(e,t){var i=this.mainElem;i[t?"height":"width"](e||0)},getValue:function(){var e=this.mainElem;return[e.width(),e.height()]}},selectmenu:{baseTag:"widget",widgetName:"selectmenu",linkedElement:"select",elem:"select",wrap:!0,setSize:!0,contentCtx:!0,options:function(){var e=this;return{change:function(t,i){e.updateValue(i.item.value)}}},onBeforeBind:function(){var e=this;e.baseApply(arguments),e.displayElem=e.widget.button},onBind:function(){var e=this;e.baseApply(arguments),e.mainElem.on("jsv-domchange",function(){e.widget.refresh()})},setValue:function(e){this.mainElem[0].value=e,this.widget.refresh()},getValue:function(){return this.mainElem[0].value}},slider:{baseTag:"widget",widgetName:"slider",bindTo:[0,1],linkedElement:["*","~foo"],elem:"div",setSize:!0,options:function(){var e=this;return{slide:function(t,i){setTimeout(function(){e.updateValue(i.value)},0)}}},onAfterLink:function(e){var t=this;t.linkCtx.elem._jsvChg||t.baseApply(arguments)},setValue:function(e){this.widget.value(e||0)},getValue:function(){return this.widget.value()}},spinner:{baseTag:"widget",widgetName:"spinner",mainElement:"input",linkedElement:"input",elem:"input",setSize:!0,displayFormat:{parse:function(e,t){return window.Globalize?Globalize.parseFloat(e,10,t._culture):e},format:function(e,t){return window.Globalize?Globalize.format(e,this.widget.options.numberFormat,t._culture):e}},options:function(){var e=this;return{spin:function(t,i){e.updateValue(e.widget._format(i.value))}}},init:function(e){var t,n=this,a=e.props.displayFormat;n.parse=function(e){return a.parse.call(n,e,n.tagCtx.props)},n.format=function(e,t){return a.format.call(n,e,n.tagCtx.props)},a===i&&(a=n.displayFormat),n.dataFormat=t=r(n,e),n.baseApply(arguments)},onBeforeBind:function(e){var t=this;t.linkCtx.elem._jsvChg||(t.baseApply(arguments),t.displayElem=t.mainElem.parent(),e.props.width&&t.mainElem.width(e.props.width-t.displayElem.find(".ui-spinner-up").width()-9))},onBind:function(e){var t=this,i=n(t,t.convert),a=n(t,t.convertBack);t.baseApply(arguments),t.convert=function(e){return e=i?i.call(t,e):e,e=t.dataFormat?+t.parseData(e):e,t.widget._format(e)},t.convertBack=function(e){return e=t.widget._parse(e),e=t.dataFormat?t.formatData(e):e,a?a.call(t,e):e},t.convert.fix=t.convertBack.fix=!0,t.widget._parse=function(i){return i+""===i&&i?+t.parse(i,e.props):i},t.widget._format=function(i){return""!==i?t.format(i,e.props):i}}},timespinner:{baseTag:"spinner",dataFormat:{parse:function(e,t){return+e},format:function(e,t){return new Date(e)}},displayFormat:{parse:function(e,t){var i;if(e)return window.Globalize?Globalize.parseDate(e,"t",t._culture):((i=new Date).setHours(e.slice(0,2),e.slice(3)),i)},format:function(e,t){if(e.getDay)return window.Globalize?Globalize.format(e,"t",t._culture):(100+e.getHours()+"").slice(1)+":"+(100+e.getMinutes()+"").slice(1)}},options:function(){return t.extend(this.baseApply(),{step:6e4,page:60})},init:function(e){this.baseApply(arguments),this.tagCtx.props.width=this.tagCtx.props.width||80},onBind:function(e){var t=this;t.baseApply(arguments),e.props.trigger=!1,t.widget._parse=function(i){if(""+i===i&&i&&(i=t.parse(i,e.props),i&&!t.keepDay)){var n=new Date(t.value);n.setHours(i.getHours()),n.setMinutes(i.getMinutes()),i=n}return+i},t.widget._format=function(i){if(+i===i)return t.value=i,t.format(new Date(i),e.props)}},onAfterLink:function(e){var t=e.props.keepDay;t!==i&&(this.keepDay=t),this.baseApply(arguments)}},tabs:{baseTag:"widget",widgetName:"tabs",bindTo:0,elem:"div",wrap:!0,setSize:!0,contentCtx:!0,options:s,onBind:o,setValue:function(e){this.widget.option("active",parseInt(e))},onBeforeBind:function(e){var i,n=window.location.href.replace(/#.*$/,"");t('ul>li>a[href^="#"]',this.mainElem).each(function(){i=t(this),i.attr("href",n+i.attr("href"))}),this.baseApply(arguments)},getValue:function(){return this.widget.option("active")}}};t.views.tags(u),"1.11"===t.ui.version.slice(0,4)&&(u.button={baseTag:"widget",widgetName:"button",elem:"button",setSize:!0,contentCtx:!0,init:function(e,t){var i,n=this,a=e.tmpl,o=e.props,s=o.id,r=n.parent;(n._.radio=r&&"buttonset"===r.tagName)?e=r.tagCtx:n._.chkBx="checkbox"===(n.inline?o:t.elem).type;var l=e.params,u=l.props||{};n.baseApply(arguments),n.inline&&(a=a&&a.markup||"&nbsp;",n._.radio||n._.chkBx?(s=s||"jsv"+Math.random(),i='<input id="'+s+'" data-link="'+l.args[0]+(u.convert?" convert="+u.convert:"")+(u.convertBack?" convertBack="+u.convertBack:"")+(n._.radio?'" name="'+r.id+'" type="radio" value="'+o.value+'"/><label for="'+s+'">'+a+"</label>":'" type="checkbox"/><label for="'+s+'">'+a+"</label>")):i="<button>"+a+"</button>",n.template=i)},onAfterLink:function(e,i){var n=this,a=i.elem,o=n.bndArgs()[0];n._.radio||n._.chkBx?(n.inline||(n._.unlinked&&!a.id&&(a.id="jsv"+Math.random(),t(a).after('<label for="'+a.id+'">&nbsp;</label>')),a.checked=n._.radio?(a.name=n.parent.id,o===a.value):o&&"false"!==o),n.baseApply(arguments),a=n.mainElem[0],n._.radio?("undefined"===a.value&&(a.value=n.widget.option("label")),a.checked=o===a.value):a.checked=o&&"false"!==o,n._.chkBx&&n.widget.refresh()):(n.inline||(a.innerHTML=a.innerHTML||"&nbsp;"),n.baseApply(arguments))}},u.buttonset={baseTag:"widget",widgetName:"buttonset",setSize:!0,contentCtx:!0,init:function(e){var t=this;t.baseApply(arguments),t.inline&&(t.id=e.props.id||"jsv"+Math.random(),t.template='<span id="'+t.id+'">'+e.tmpl.markup+"</span>")},onAfterLink:function(e,i){var n=this,a=(i.elem,n.bndArgs()[0]);n.baseApply(arguments),n.widget.buttons.each(function(e,i){i.checked=a===i.value,t(i).button("refresh")})}}),t.views.tags(u),t.ui.draggable&&(t.widget("jsv.draggable",t.ui.draggable,{_createHelper:function(){return"clone"===this.options.helper&&(this.options.helper=l),this._super()}}),t.views.tags("draggable",{baseTag:"widget",widgetName:"jsv-draggable",bindTo:["left","top"],linkedCtxParam:["left","top"],elem:"div",wrap:!0,setSize:!0,contentCtx:!0,options:function(){var e=this;return{drag:function(t,i){setTimeout(function(){e.updateValues(i.offset.left,i.offset.top)},0)}}},setValue:function(e,t){this.mainElem.offset(t?{top:e}:{left:e})},getValue:function(e,t){var i=this.mainElem.offset();return[i.left,i.top]}})),t.ui.accordion&&(t.widget("jsv.accordion",t.ui.accordion,{_create:function(){var e=this;e.options.header=e.options.header.replace(":not(li):even",":not(li,script):even"),e._super()}}),t.views.tags("accordion",{baseTag:"widget",widgetName:"jsv-accordion",bindTo:0,wrap:!0,setSize:!0,contentCtx:!0,options:s,initOptions:["header"],onBind:o,setValue:function(e){this.widget.option("active",parseInt(e))},getValue:function(){return this.widget.option("active")}})),t.ui.sortable&&(t.widget("jsv.sortable",t.ui.sortable,{_create:function(){var e,n,a=this,o=a.options.start,s=a.options.stop;a.option({start:function(t,i){o&&o.apply(this,arguments),a.option("bindArray")!==!1&&(e=i.item.view(),"item"===e.type&&(n=e.index+1))},stop:function(o,r){var l;n&&(l=r.item.prevAll(r.item[0].tagName).length,a.cancel(),t.observable(e.parent.data).move(n-1,l),n=i),s&&s.apply(this,arguments)}}),a._super()}}),t.views.tags("sortable",{baseTag:"widget",widgetName:"jsv-sortable",wrap:!0,contentCtx:!0})),t.ui.selectable&&(t.widget("jsv.selectable",t.ui.selectable,{_create:function(){var e=this;e.options.filter+=":not(script)",e._super()}}),t.views.tags("selectable",{baseTag:"widget",widgetName:"jsv-selectable",bindTo:0,wrap:!0,setSize:!0,contentCtx:!0,options:function(){var e=this;return{stop:function(t,i){e.setSelectedItems()}}},initOptions:["filter"],onBind:function(){function e(e,i){i.refresh||t.setSelection()}var t=this;t.selected=[],t.selObs=e,t.baseApply(arguments),t.mainElem.on("jsv-domchange.sel",function(){t.widget.refresh(),t.selected._domChg=2,t.setSelectedItems(),t.selected._domChg=i})},onDispose:function(){t.unobserve(this.selected,this.selObs)},setValue:function(e){var i=this;t.isArray(e)&&i.selected!==e&&(t.unobserve(i.selected,i.selObs),i.selected=e,e!==i.bndArgs[0]&&i.updateValue(e),t.observe(e,i.selObs),i.setSelection())},getValue:function(){return this.selected},setSelection:function(){var e=this,t=e.selected.length;if(!e.selected._domChg)for(e.widget.selectees.removeClass("ui-selected");t--;)e.widget.selectees.eq(e.selected[t]).addClass("ui-selected")},setSelectedItems:function(){var e=this,i=[];e.selected&&1!==e.selected._domChg&&(e.selected._domChg&&e.selected._domChg--,e.widget.selectees.each(function(e,t){(" "+t.className+" ").indexOf(" ui-selected ")>-1&&i.push(e)}),e.setValue(e.selected),t.observable(e.selected).refresh(i))}}))}(this,this.jQuery);
//# sourceMappingURL=jsviews-jqueryui-widgets.min.js.map
