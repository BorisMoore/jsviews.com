/*! JsViews jQueryUI widget integration v1.0.4
see: http://www.jsviews.com/#download/jqueryui-tagcontrols */
!function(e,t,i){"use strict";function a(e,t){return t+""===t?e.tagCtx.view.getRsc("converters",t):t}function n(){var e=this,t=e.tagCtx.props,i=e.mainElem[0];e.baseApply(arguments),t.name&&(i.name=t.name),t.value&&(i.value=t.value),e.displayElem=e.widget.label}function s(e,t){var i=this,a=e.props;i.baseApply(arguments),a.label&&a.label!==i.widget.options.label&&i.widget.option("label",a.label)}function o(){var e=this;e.mainElem.on("jsv-domchange",function(t,i,a,n){var s,o=e.widget.options.active;e.widget.refresh(),s=e.widget.options.active,o!==s&&e.updateValue(s)})}function r(){var e=this;return{activate:function(t,i){e.updateValue(e.widget.options.active)}}}function l(e,t){var a,n=t.props.dataFormat;return n===i&&(n=e.dataFormat),a=n&&n.parse?n:e.dataFormatter,e.parseData=function(t){return a.parse.call(e,t,e.tagCtx.props)},e.formatData=function(t){return a.format.call(e,t,e.tagCtx.props)},n}function u(){var e=t(this).clone();return e.find("*").addBack().removeAttr("id data-link data-jsv data-jsv-df"),e.find("script").remove(),e}if(!(t&&t.fn&&t.ui&&t.views))throw"jsviews-jqueryui-widgets.js requires jQuery, jQuery UI and JsViews";var p={widget:{argDefault:!1,mainElement:"*",init:function(e){var i,a,n=this;n.inline&&(i=e.tmpl.markup,!n.template&&(a=e.props.elem||n.elem)&&(i?n.wrap&&(n.template="<"+a+">"+t.trim(i)+"</"+a+">"):n.template="input"===a?"<input/>":"<"+a+"></"+a+">"),n.attr="html")},onBind:function(e){var i,a,n,s,o=this,r=o.initOptions||[],l=o.widgetName,u=o.options,p=l,d={};for(r.push("create"),l=l.split("-").pop(),n=r.length;n--;)s=r[n],(a=e.props["_"+s])&&(d[s]=a);if(p===l&&(p="ui-"+l),i=o.mainElem,!i||!i[0])throw"No element found for tag '"+o.tagName+"'";if(e.props.id&&!i[0].id&&(i[0].id=e.props.id),i[l](d),o.widget=i.data(p)||i.data(l),!o.widget)throw"widget '"+l+"' failed";u&&(t.isFunction(u)&&(u=o.options()),i[l]("option",u))},onAfterLink:function(e){var i,a=this,n=a.options,s=e.props,o=a.widgetName.split("-").pop();t.isFunction(n)&&(n=a.options()),i=a.mainElem,t.each(s,function(e,a){var s;"_"===e.charAt(0)&&(e=e.slice(1),s=n&&n[e],i[o]("option",e)!=a&&i[o]("option",e,s&&t.isFunction(s)&&a&&t.isFunction(a)?function(){return s.apply(i[0],arguments),a.apply(i[0],arguments)}:a))})},onUpdate:!1,dataBoundOnly:!0,attr:"none"},button:{baseTag:"widget",widgetName:"button",elem:"button",wrap:!0,setSize:!0,contentCtx:!0,onBind:function(e,t){var i=this.mainElem[0];i.innerHTML=i.innerHTML||"&nbsp;",this.baseApply(arguments)},onAfterLink:function(e,t,i,a){this.baseApply(arguments),a&&this.widget.refresh()}},autocomplete:{baseTag:"widget",widgetName:"autocomplete",linkedElement:"*",elem:"input",setSize:!0,options:function(){var e=this;return{change:function(t,i){i.item&&e.updateValue(i.item.value)},select:function(t,i){i.item&&e.updateValue(i.item.value)},focus:function(e,t){return!1}}}},checkbox:{baseTag:"widget",widgetName:"checkboxradio",template:"<label><input type='checkbox'/></label>",mainElement:"input",linkedElement:"input",setSize:!0,onBind:n,onAfterLink:s,setValue:function(e){var t=this,i=this.mainElem[0],a=e&&"false"!==e;i.checked!==a&&(i.checked=a,t.widget.refresh())}},radio:{baseTag:"widget",widgetName:"checkboxradio",template:"<label><input type='radio'/></label>",mainElement:"input",setSize:!0,onBind:function(){var e=this.parents.radiogroup;n.apply(this,arguments),e&&!e._d&&(e.onAfterLink=t.views.sub._gm(e.onAfterLink,function(){for(var t,i=e.bndArgs()[0],a=!!e.tagCtx.props.disabled,n=e.childTags("radio"),s=n.length;s--;)n[s].setValue(i),t=n[s].widget,a!==t.options.disabled&&t.option("disabled",a);this.baseApply(arguments)}),e._d=!0)},onAfterLink:s,setValue:function(e){var t=this.mainElem[0],i=e===t.value;t.checked!==i&&(t.checked=i),this.widget.refresh()}},controlgroup:{baseTag:"widget",widgetName:"controlgroup",elem:"span",wrap:!0,contentCtx:!0,onBind:function(){var e=this;e.baseApply(arguments),e.mainElem.on("jsv-domchange",function(){e.widget.refresh()})}},datepicker:{baseTag:"widget",widgetName:"datepicker",linkedElement:"*",elem:"input",setSize:!0,dataFormat:!0,dataFormatter:{parse:function(e,i){return t.datepicker.parseDate(this.dataFormat,e)},format:function(e,i){return t.datepicker.formatDate(this.dataFormat,e)}},init:function(e){var i=this,n=i.dateFormat=e.props.dateFormat||e.props._dateFormat||i.dateFormat||t.datepicker._defaults.dateFormat,s=a(i,i.convert),o=a(i,i.convertBack),r=l(i,e);i.dataFormat=r===!0?i.dateFormat:r,i.convert=function(e){return e=s?s.call(i,e):e,i.dataFormat&&""+e===e&&(e=i.parseData(e)),t.datepicker.formatDate(n,0===r?new Date(e):e)},i.convertBack=function(e){return e=t.datepicker.parseDate(n,e),e=r?i.formatData(e):0===r?+e:e,o?o.call(i,e):e},i.convert.fix=i.convertBack.fix=!0,i.baseApply(arguments)},options:function(){var e=this;return{onSelect:function(t){e.value=t,e.updateValue(t)}}},onBind:function(e){var t=this;t.baseApply(arguments),t.mainElem.datepicker("option","dateFormat",t.dateFormat),"INPUT"!==t.mainElem[0].tagName?t.mainElem.css("display","inline-block"):t.tagCtx.props.trigger=!1},setValue:function(e){var t=this;e!==i&&e!==t.value&&(t.value=e,t.mainElem.datepicker("setDate",e))},getValue:function(){return this.value}},droppable:{baseTag:"widget",widgetName:"droppable",elem:"div",wrap:!0,setSize:!0,contentCtx:!0,setValue:function(e){t.isFunction(e)&&this.widget.option("drop",e)}},menu:{baseTag:"widget",widgetName:"menu",elem:"ul",wrap:!0,setSize:!0,contentCtx:!0,initOptions:["menus","items","role"],setValue:function(e){t.isFunction(e)&&this.widget.option("select",e)}},progressbar:{baseTag:"widget",widgetName:"progressbar",boundProps:["busy"],elem:"div",wrap:!0,setSize:!0,contentCtx:!0,setValue:function(e){this.tagCtx.props.busy||this.widget.value(parseFloat(e)||0)},getValue:function(){return this.widget.value()},onAfterLink:function(e){var t=this;t.baseApply(arguments),e.props.busy&&t.widget.value(!1)}},resizable:{baseTag:"widget",widgetName:"resizable",bindTo:["width","height"],linkedCtxParam:["width","height"],elem:"div",wrap:!0,contentCtx:!0,options:function(){var e=this;return{resize:function(t,i){e.updateValues(i.size.width,i.size.height,!0),e.setValues(i.size.width,i.size.height)}}},setValue:function(e,t){e!==i&&this.mainElem[t?"height":"width"](e||0)},getValue:function(){return[this.mainElem.width(),this.mainElem.height()]}},selectmenu:{baseTag:"widget",widgetName:"selectmenu",elem:"select",wrap:!0,setSize:!0,contentCtx:!0,options:function(){var e=this;return{change:function(t,i){e.updateValue(i.item.value)}}},onBind:function(){var e=this;e.baseApply(arguments),e.displayElem=e.widget.button,e.mainElem.on("jsv-domchange",function(){e.widget.refresh()})},setValue:function(e){e!==i&&(this.mainElem[0].value=e,this.widget.refresh())},getValue:function(){return this.mainElem[0].value}},slider:{bindTo:[0,1],baseTag:"widget",widgetName:"slider",elem:"div",setSize:!0,options:function(){var e=this;return{slide:function(t,i){i.values?e.updateValues.apply(e,i.values):e.updateValue(i.value)}}},onAfterLink:function(e){var t=this;t.linkCtx.elem._jsvChg||t.baseApply(arguments)},setValue:function(e,t){var a=this.widget;e!==i&&(e=e||0,a.options.range===!0?a.values(t,e):a.value(e))},getValue:function(){return this.widget.value()}},spinner:{baseTag:"widget",widgetName:"spinner",mainElement:"input",linkedElement:"input",elem:"input",setSize:!0,displayFormat:{parse:function(e,t){return window.Globalize?Globalize.parseFloat(e,10,t._culture):e},format:function(e,t){return window.Globalize?Globalize.format(e,this.widget.options.numberFormat,t._culture):e}},options:function(){var e=this;return{spin:function(t,i){e.updateValue(e.widget._format(i.value))}}},init:function(e){var t,a=this,n=e.props.displayFormat;a.parse=function(e){return n.parse.call(a,e,a.tagCtx.props)},a.format=function(e,t){return n.format.call(a,e,a.tagCtx.props)},n===i&&(n=a.displayFormat),a.dataFormat=t=l(a,e),a.baseApply(arguments)},onBind:function(e){var t=this,i=a(t,t.convert),n=a(t,t.convertBack);t.dataCvt=i,t.dataCvtBk=n,t.baseApply(arguments),t.linkCtx.elem._jsvChg||(t.displayElem=t.mainElem.parent(),e.props.width&&t.mainElem.width(e.props.width-t.displayElem.find(".ui-spinner-up").width()-9)),t.convert=function(e){return e=i?i.call(t,e):e,e=t.dataFormat?+t.parseData(e):e,t.widget._format(e)},t.convertBack=function(e){return e=t.widget._parse(e),e=t.dataFormat?t.formatData(e):e,n?n.call(t,e):e},t.convert.fix=t.convertBack.fix=!0,t.widget._parse=function(i){return i+""===i&&i?+t.parse(i,e.props):i},t.widget._format=function(i){return""!==i?t.format(i,e.props):i}}},timespinner:{baseTag:"spinner",dataFormat:{parse:function(e,t){return+e},format:function(e,t){return new Date(e)}},displayFormat:{parse:function(e,t){var i;if(e)return window.Globalize?Globalize.parseDate(e,"t",t._culture):((i=new Date).setHours(e.slice(0,2),e.slice(3)),i)},format:function(e,t){if(e.getDay)return window.Globalize?Globalize.format(e,"t",t._culture):(100+e.getHours()+"").slice(1)+":"+(100+e.getMinutes()+"").slice(1)}},options:function(){return t.extend(this.baseApply(),{step:6e4,page:60})},init:function(e){this.baseApply(arguments),this.tagCtx.props.width=this.tagCtx.props.width||80},onBind:function(e){var t=this;t.baseApply(arguments),t.widget._parse=function(i){var a;return""+i===i&&i&&(i=t.parse(i,e.props))&&(t.keepDay?(a=t.tagCtx.args[0],t.dataCvt&&(a=t.dataCvt(a)),t.dataFormat&&(a=t.parseData(a))):a=t.value,a=new Date(a),a.setHours(i.getHours()),a.setMinutes(i.getMinutes()),i=a),+i},t.widget._format=function(i){if(+i===i)return t.value=i,t.format(new Date(i),e.props)}},onAfterLink:function(e){var t=e.props.keepDay;t!==i&&(this.keepDay=t),this.baseApply(arguments)},trigger:!1},tabs:{baseTag:"widget",widgetName:"tabs",elem:"div",wrap:!0,setSize:!0,contentCtx:!0,options:r,setValue:function(e){e!==i&&this.widget.option("active",parseInt(e))},onBind:function(e){this.baseApply(arguments);var i,a=window.location.href.replace(/#.*$/,"");t('ul>li>a[href^="#"]',this.mainElem).each(function(){i=t(this),i.attr("href",a+i.attr("href"))}),o.call(this)},getValue:function(){return this.widget.options.active}}};t.views.tags(p),"1.11"===t.ui.version.slice(0,4)&&(p.button={baseTag:"widget",widgetName:"button",elem:"button",setSize:!0,contentCtx:!0,init:function(e,t){var i,a=this,n=e.tmpl,s=e.props,o=s.id,r=a.parent;(a._.radio=r&&"buttonset"===r.tagName)?e=r.tagCtx:a._.chkBx="checkbox"===(a.inline?s:t.elem).type;var l=e.params,u=l.props||{};a.baseApply(arguments),a.inline&&(n=n&&n.markup||"&nbsp;",a._.radio||a._.chkBx?(o=o||"jsv"+Math.random(),i='<input id="'+o+'" data-link="'+l.args[0]+(u.convert?" convert="+u.convert:"")+(u.convertBack?" convertBack="+u.convertBack:"")+(a._.radio?'" name="'+r.id+'" type="radio" value="'+s.value+'"/><label for="'+o+'">'+n+"</label>":'" type="checkbox"/><label for="'+o+'">'+n+"</label>")):i="<button>"+n+"</button>",a.template=i)},onAfterLink:function(e,i){var a=this,n=i.elem,s=a.bndArgs()[0];a._.radio||a._.chkBx?(a.inline||(a._.unlinked&&!n.id&&(n.id="jsv"+Math.random(),t(n).after('<label for="'+n.id+'">&nbsp;</label>')),n.checked=a._.radio?(n.name=a.parent.id,s===n.value):s&&"false"!==s),a.baseApply(arguments),n=a.mainElem[0],a._.radio?("undefined"===n.value&&(n.value=a.widget.options.label),n.checked=s===n.value):n.checked=s&&"false"!==s,a._.chkBx&&a.widget.refresh()):(a.inline||(n.innerHTML=n.innerHTML||"&nbsp;"),a.baseApply(arguments))}},p.buttonset={baseTag:"widget",widgetName:"buttonset",setSize:!0,contentCtx:!0,init:function(e){var t=this;t.baseApply(arguments),t.inline&&(t.id=e.props.id||"jsv"+Math.random(),t.template='<span id="'+t.id+'">'+e.tmpl.markup+"</span>")},onAfterLink:function(e,i){var a=this,n=(i.elem,a.bndArgs()[0]);a.baseApply(arguments),a.widget.buttons.each(function(e,i){i.checked=n===i.value,t(i).button("refresh")})}}),t.views.tags(p),t.ui.draggable&&(t.widget("jsv.draggable",t.ui.draggable,{_createHelper:function(){return"clone"===this.options.helper&&(this.options.helper=u),this._super()}}),t.views.tags("draggable",{baseTag:"widget",widgetName:"jsv-draggable",bindTo:["left","top"],linkedCtxParam:["left","top"],elem:"div",wrap:!0,setSize:!0,contentCtx:!0,options:function(){var e=this;return{drag:function(t,i){e.updateValues(i.offset.left,i.offset.top,!0),e.convert&&e.setValues(i.offset.left,i.offset.top)}}},setValue:function(e,t){if(e===i)this.ctxPrm(this.linkedCtxParam[t],this.getValue()[t]);else{var a={},n=t?"top":"left";a[n]=e+parseInt(this.mainElem.css("margin-"+n)),this.mainElem.offset(a)}},getValue:function(){var e=this.mainElem.position();return[e.left,e.top]}})),t.ui.accordion&&(t.widget("jsv.accordion",t.ui.accordion,{_create:function(){var e=this;e.options.header=e.options.header.replace(":not(li):even",":not(li,script):even"),e._super()}}),t.views.tags("accordion",{baseTag:"widget",widgetName:"jsv-accordion",wrap:!0,setSize:!0,contentCtx:!0,options:r,initOptions:["header"],onBind:function(e){this.baseApply(arguments),o.call(this)},setValue:function(e){e!==i&&this.widget.option("active",parseInt(e))},getValue:function(){return this.widget.options.active}})),t.ui.sortable&&(t.widget("jsv.sortable",t.ui.sortable,{_create:function(){var e,a,n=this,s=n.options.start,o=n.options.stop;n.option({start:function(t,i){s&&s.apply(this,arguments),n.options.bindArray!==!1&&(e=i.item.view(),"item"===e.type&&(a=e.index+1))},stop:function(s,r){var l;a&&(l=r.item.prevAll(r.item[0].tagName).length,n.cancel(),t.observable(e.parent.data).move(a-1,l),a=i),o&&o.apply(this,arguments)}}),n._super()}}),t.views.tags("sortable",{baseTag:"widget",widgetName:"jsv-sortable",wrap:!0,contentCtx:!0})),t.ui.selectable&&(t.widget("jsv.selectable",t.ui.selectable,{_create:function(){var e=this;e.options.filter+=":not(script)",e._super()}}),t.views.tags("selectable",{baseTag:"widget",widgetName:"jsv-selectable",wrap:!0,setSize:!0,contentCtx:!0,options:function(){var e=this;return{stop:function(t,i){e.setSelectedItems()}}},initOptions:["filter"],onBind:function(){function e(e,i){i.refresh||t.setSelection()}var t=this;t.selected=[],t.selObs=e,t.baseApply(arguments),t.mainElem.on("jsv-domchange.sel",function(){t.widget.refresh(),t.selected._domChg=2,t.setSelectedItems(),t.selected._domChg=i})},onDispose:function(){t.unobserve(this.selected,this.selObs)},setValue:function(e){var a=this;e!==i&&t.isArray(e)&&a.selected!==e&&(t.unobserve(a.selected,a.selObs),a.selected=e,t.observe(e,a.selObs),a.setSelection())},getValue:function(){return this.selected},setSelection:function(){var e=this,t=e.selected.length;if(!e.selected._domChg)for(e.widget.selectees.removeClass("ui-selected");t--;)e.widget.selectees.eq(e.selected[t]).addClass("ui-selected")},setSelectedItems:function(){var e=this,i=[];e.selected&&1!==e.selected._domChg&&(e.selected._domChg&&e.selected._domChg--,e.widget.selectees.each(function(e,t){(" "+t.className+" ").indexOf(" ui-selected ")>-1&&i.push(e)}),e.setValue(e.selected),t.observable(e.selected).refresh(i))}}))}(this,this.jQuery);
//# sourceMappingURL=jsviews-jqueryui-widgets.min.js.map
