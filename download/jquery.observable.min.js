/*! JsObservable v1.0.0-alpha: http://www.jsviews.com/#jsobservable
informal pre V1.0 commit counter: 64 (Beta Candidate)*/
!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(this.jQuery)}(function(t){"use strict";function e(t){return t._cId=t._cId||".obs"+S++}function n(t){return A(t)?new i(t):new r(t)}function r(t){return this._data=t,this}function i(t){return this._data=t,this}function a(t){return A(t)?[t]:t}function o(t,e){t=A(t)?t:[t];var n,r,i=e,a=i,s=t.length,c=[];for(n=0;s>n;n++)r=t[n],I(r)?c=c.concat(o(r.call(e,e),e)):""+r===r?(a!==i&&c.push(i=a),c.push(r)):(e=a=r,a!==i&&c.push(i=a));return c}function s(t,e){for(var n in t)return;D[e]=void 0}function c(t,e){function n(t){return typeof t===j&&(p[0]||f&&A(t))}if(!t.data||!t.data.off){var r,i,a,o=e.oldValue,s=e.value,c=t.data,l=c.observeAll,f=!c.cb.noArray,p=c.paths;t.type===V?(c.cb.array||c.cb).call(c,t,e):(c.prop===e.path||"*"===c.prop)&&(l?(r=l._path+"."+e.path,i=l.filter,a=[t.target].concat(l.parents()),n(o)&&u(f,l.ns,[o],p,c.cb,!0,i,[a],r),n(s)&&u(f,l.ns,[s],p,c.cb,void 0,i,[a],r)):(n(o)&&u(f,[o],p,c.cb,!0),n(s)&&u(f,[s],p,c.cb)),c.cb(t,e))}}function l(){function r(){function f(e,n,r,o){var s,l,f=B(ee),u=a(ee),p=N,h=R;if(e=i?e+"."+i:e,P||o)f&&t(u).off(e,c);else{if(J=f&&t._data(ee))for(J=J&&J.events,J=J&&J[r?V:T],M=J&&J.length;M--;)if((Q=J[M].data)&&Q.cb._cId===C._cId&&Q.ns===i){if(r)return;"*"===n&&Q.prop!==n&&t(ee).off(e,c)}l=r?{}:{fullPath:y,paths:n?[n]:[],prop:_},l.ns=i,l.cb=C,R&&(l.observeAll={_path:h,path:function(){return s=p.length,h.replace(/[[.]/g,function(e){return s--,"["===e?"["+t.inArray(p[s-1],p[s]):"."})},parents:function(){return p},filter:U,ns:i}),t(u).on(e,null,l,c),G&&((D[C._cId]=G)[t.data(ee,"obId")||t.data(ee,"obId",O++)]=ee)}}function p(t){var e=te;return t.ob=z(t,e),t.cb=function(n,i){var a=t.ob,o=t.sb,s=z(t,e);s!==a&&(typeof a===j&&(h(a,!0),(o||l&&A(a))&&r([a],o,C,z,!0)),t.ob=s,typeof s===j&&(h(s),(o||l&&A(s))&&r([s],o,C,z))),C(n,i)}}function h(t,r,i,a){if(l){var o=ee,s=R;ee=t,a&&(ee=t[a],R+="."+a),U&&ee&&(ee=n._fltr(R,ee,a?[t].concat(N):N,U)),ee&&(i||A(ee))&&f(V+".observe"+(C?S=e(C):""),void 0,!0,r),ee=o,R=s}}var d,g,v,b,_,y,m,P,C,S,M,Q,J,z,E,G,K,L,N,R,U,W,X,Y=H,Z=1!=this?x.apply([],arguments):w.call(arguments),$=Z.pop()||!1,te=Z.shift(),ee=te,ne=Z.length;for($+""===$&&(R=$,N=Z.pop(),U=Z.pop(),$=!!Z.pop(),ne-=3),$===!!$&&(P=$,$=Z[ne-1],$=ne&&$+""!==$?(ne--,Z.pop()):void 0),C=$,ne&&I(Z[ne-1])&&(z=C,C=Z.pop(),ne--),Y+=P?C?C._cId+(C._inId||""):"":(S=e(C))+(C._inId||""),P||(G=D[S]=D[S]||{}),W=i&&i.match(k)||[""],X=W.length;X--;)for(i=W[X],A(te)?h(te,P,!0):P&&0===ne&&te&&f(Y,""),K=0,d=0;ne>d;d++)if(y=Z[d],""!==y&&void 0!==y){if(ee=te,""+y===y){if(b=y.split("^"),b[1]&&(K=b[0].split(".").length,y=b.join("."),K=y.split(".").length-K),z&&(E=z(y,te))){ne+=E.length-1,F.apply(Z,[d--,1].concat(E));continue}b=y.split(".")}else I(y)||(y&&y._jsv?(L=P?y.cb:p(y),L.noArray=!l,L._cId=C._cId,L._inId=L._inId||".obIn"+q++,(y.bnd||y.prm&&y.prm.length||!y.sb)&&r([ee],y.path,[u],y.prm,L,z,P),y.sb&&r([y.ob],y.sb,C,z,P),y=u,ee=void 0):ee=y),b=[te=y];for(;ee&&void 0!==(_=b.shift());)if(typeof ee===j){if(""+_===_){if(""===_)continue;if(b.length<K+1&&!ee.nodeType){if(!P&&(J=B(ee)&&t._data(ee))){for(J=J.events,J=J&&J[T],M=J&&J.length,v=0;M--;)Q=J[M].data,Q&&Q.cb===C&&Q.ns===i&&(Q.prop===_||"*"===Q.prop)&&((g=b.join("."))&&Q.paths.push(g),v++);if(v){ee=ee[_];continue}}if("*"===_){!P&&J&&J.length&&f(Y,"",!1,!0),f(Y,"");for(g in ee)h(ee,P,void 0,g);break}_&&f(Y+"."+_,b.join("^"))}R&&(R+="."+_),_=ee[_]}if(I(_)){(m=_.depends)&&r([ee],o(m,ee),C,z,P);break}ee=_}h(ee,P)}return S&&s(G,S),{cbId:S,bnd:G}}var i,l=0!=this,f=w.call(arguments),u=f[0];return u+""===u&&l&&(i=u,f.shift(),u=f[0]),r.apply(1,f)}function f(){return[].push.call(arguments,!0),l.apply(this,arguments)}function u(){var t=x.apply([],arguments);return l.apply(t.shift(),t)}function p(t,e,n,r){t+""!==t&&(n=e,e=t,t=""),d(t,this._data,e,n,[],"root",r)}function h(t,e,n){p.call(this,t,e,n,!0)}function d(t,r,i,a,o,s,c){function f(t,e){for(h=t.length,v=s+"[]";h--;)u(t,h,e,1)}function u(e,r,o,s){var c,l;r!==P&&(c=n._fltr(v,e[r],b,a))&&(l=b.slice(),s&&_&&l.unshift(_),d(t,c,i,a||(s?void 0:0),l,v,o))}function p(t,e){switch(s=t.data.observeAll._path,_=t.target,e.change){case"insert":f(e.items);break;case"remove":f(e.items,!0);break;case"refresh":f(e.oldItems,!0),f(t.target);break;case"set":v=s+"."+e.path,u(e,"oldValue",!0),u(e,"value")}_=void 0,i.apply(this,arguments)}var h,g,v,b,_;if(typeof r===j)if(b=[r].concat(o),g=A(r)?"":"*",i?(g||0!==a)&&(p._cId=e(i),l(t,r,g,p,c,a,b,s)):l(t,r,g,void 0,c,a,b,s),g)for(h in r)v=s+"."+h,u(r,h,c);else f(r,c)}function g(t){return t.indexOf(".")<0&&t.indexOf("[")<0}var v="v1.0.0-alpha",b="JsViews requires ";if(!t)throw b+"jQuery";if(t.observable)return t;var _=t.event.special,y=t.views=t.views||{jsviews:v,sub:{}},m=y.sub,I=t.isFunction,A=t.isArray,j="object",w=[].slice,F=[].splice,x=[].concat,P=t.expando,C=parseInt,k=/\S+/g,T=m.propChng=m.propChng||"propertyChange",V=m.arrChng=m.arrChng||"arrayChange",D=m._cbBnds=m._cbBnds||{},H=T+".observe",O=1,S=1,q=1,B=t.hasData,M={};return m.getDeps=function(){var t=arguments;return function(){for(var e,n,r=[],i=t.length;i--;)e=t[i--],n=t[i],n&&(r=r.concat(I(n)?n(e,e):n));return r}},t.observable=n,n._fltr=function(t,e,n,r){return(r&&I(r)?r(t,e,n):!0)?(e=I(e)?e.set&&e.call(n[0]):e,typeof e===j&&e):void 0},n.Object=r,n.Array=i,t.observe=n.observe=l,t.unobserve=n.unobserve=f,n._apply=u,r.prototype={_data:null,observeAll:p,unobserveAll:h,data:function(){return this._data},setProperty:function(t,e,n){var r,i,a,o=this,s=o._data;if(t=t||"",s)if(A(t))for(r=t.length;r--;)i=t[r],o.setProperty(i.name,i.value,void 0===n||n);else if(""+t!==t)for(r in t)o.setProperty(r,t[r],e);else if(t!==P){for(a=t.split(".");s&&a.length>1;)s=s[a.shift()];s&&o._setProperty(s,a[0],e,n)}return o},removeProperty:function(t){return this.setProperty(t,M),this},_setProperty:function(t,e,n,r){var i,a,o,s=e?t[e]:t;I(s)&&s.set&&(a=s,i=s.set===!0?s:s.set,s=s.call(t)),(s!==n||r&&s!=n)&&(!(s instanceof Date)||s>n||n>s)&&(i?(i.call(t,n),n=a.call(t)):(o=n===M)?(delete t[e],n=void 0):e&&(t[e]=n),this._trigger(t,{change:"set",path:e,value:n,oldValue:s,remove:o}))},_trigger:function(e,n){t(e).triggerHandler(T,n)}},i.prototype={_data:null,observeAll:p,unobserveAll:h,data:function(){return this._data},insert:function(t,e){var n=this._data;return 1===arguments.length&&(e=t,t=n.length),t=C(t),t>-1&&t<=n.length&&(e=A(e)?e:[e],e.length&&this._insert(t,e)),this},_insert:function(t,e){var n=this._data,r=n.length;F.apply(n,[t,0].concat(e)),this._trigger({change:"insert",index:t,items:e},r)},remove:function(t,e){var n,r=this._data;return void 0===t&&(t=r.length-1),t=C(t),e=e?C(e):0===e?0:1,e>-1&&t>-1&&(n=r.slice(t,t+e),e=n.length,e&&this._remove(t,e,n)),this},_remove:function(t,e,n){var r=this._data,i=r.length;r.splice(t,e),this._trigger({change:"remove",index:t,items:n},i)},move:function(t,e,n){if(n=n?C(n):0===n?0:1,t=C(t),e=C(e),n>0&&t>-1&&e>-1&&t!==e){var r=this._data.slice(t,t+n);n=r.length,n&&this._move(t,e,n,r)}return this},_move:function(t,e,n,r){var i=this._data,a=i.length;i.splice(t,n),F.apply(i,[e,0].concat(r)),this._trigger({change:"move",oldIndex:t,index:e,items:r},a)},refresh:function(t){var e=this._data.slice();return this._refresh(e,t),this},_refresh:function(t,e){var n=this._data,r=n.length;F.apply(n,[0,n.length].concat(e)),this._trigger({change:"refresh",oldItems:t},r)},_trigger:function(e,n){var r=this._data,i=r.length,a=t([r]);i!==n&&a.triggerHandler(T,{change:"set",path:"length",value:i,oldValue:n}),a.triggerHandler(V,e)}},_[T]=_[V]={remove:function(e){var n,r,i,a,o,c=e.data;if(c&&(c.off=!0,c=c.cb)&&(n=D[c._cId])){for(i=t._data(this).events[e.type],a=i.length;a--&&!r;)r=(o=i[a].data)&&o.cb._cId===c._cId;r||(delete n[t.data(this,"obId")],s(n,c._cId))}}},y.map=function(e){function r(t,r,i){var a,o=this;this.src&&this.unmap(),typeof t===j&&(o.src=t,o.tgt=i||o.tgt||[],o.options=r||o.options,o.update(),e.obsSrc&&n(o.src).observeAll(o.obs=function(t,n){a||(a=!0,e.obsSrc(o,t,n),a=void 0)},o.srcFlt),e.obsTgt&&n(o.tgt).observeAll(o.obt=function(t,n){a||(a=!0,e.obsTgt(o,t,n),a=void 0)},o.tgtFlt))}return I(e)&&(e={getTgt:e}),e.baseMap&&(e=t.extend({},e.baseMap,e)),e.map=function(t,e,n){return new r(t,e,n)},(r.prototype={srcFlt:e.srcFlt||g,tgtFlt:e.tgtFlt||g,update:function(t){var r=this;n(r.tgt).refresh(e.getTgt(r.src,r.options=t||r.options))},unmap:function(){var t=this;t.src&&(t.obs&&n(t.src).unobserveAll(t.obs,t.srcFlt),t.obt&&n(t.tgt).unobserveAll(t.obt,t.tgtFlt),t.src=void 0)},map:r,_def:e}).constructor=r,e},t});
//# sourceMappingURL=jquery.observable.min.js.map