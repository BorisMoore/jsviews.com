/*! JsObservable v1.0.0-alpha: http://github.com/BorisMoore/jsviews and http://jsviews.com/jsviews
informal pre V1.0 commit counter: 51 (Beta Candidate) */
(function(n,t,i){"use strict";function u(n){return r(n)?new d(n):new k(n)}function k(n){return this._data=n,this}function d(n){return this._data=n,this}function lt(n){return r(n)?[n]:n}function ut(n,t){n=r(n)?n:[n];for(var i,e=t,o=e,h=n.length,u=[],s=0;s<h;s++){if(i=n[s],f(i)){u=u.concat(ut(i.call(t,t),t));continue}else if(""+i!==i){t=o=i;o!==e&&u.push(e=o);continue}o!==e&&u.push(e=o);u.push(i)}return u}function ft(n,t){var r,i;for(r in n){i=!0;break}i||delete p[t]}function g(n,t){if(!(n.data&&n.data.off)){var a,y,p,f=t.oldValue,o=t.value,u=n.data,l=u.observeAll,h=!u.cb.noArray,c=u.paths;n.type===v?(u.cb.array||u.cb).call(u,n,t):(u.prop===t.path||u.prop==="*")&&(f=typeof f===s&&(c[0]||h&&r(f))&&f,o=typeof(o=t.value)===s&&(c[0]||h&&r(o))&&o,l?(a=l._path+"."+t.path,y=l.filter,p=[l.parents().slice(0)],f&&e(h,[f],c,u.cb,!0,y,p,a),o&&e(h,[o],c,u.cb,i,y,p,a)):(f&&e(h,[f],c,u.cb,!0),o&&e(h,[o],c,u.cb)),u.cb(n,t))}}function y(){function kt(i,r,u,f){var e,s,p=rt(n),w=lt(n);if(o=0,k||f)p&&(t(w).off(i,g),o&&delete o[t.data(n,"obId")]);else{if(a=p&&t._data(n))for(a=a&&a.events,a=a&&a[u?v:l],bt=a&&a.length;bt--;)if((et=a[bt].data)&&et.cb._cId===c._cId){if(u)return;(r==="*"&&et.prop!==r||et.prop===y)&&(t(n).off(i,g),o&&delete o[t.data(n,"obId")])}s=u?{cb:c}:{fullPath:h,paths:r?[r]:[],prop:y,cb:c};ot&&(s.observeAll={_path:ot,path:function(){return e=ti.length,ot.replace(/[[.]/g,function(n){return e--,n==="["?"["+t.inArray(ti[e-1],ti[e]):"."})},parents:function(){return ti},filter:fi});t(w).on(i,null,s,g);gt&&(gt[t.data(n,"obId")||t.data(n,"obId",ct++)]=n)}}function ci(n,t){n._ob=st(n,wt);var i=wt;return function(u,f){var o=n._ob,h=t.length;typeof o===s&&(dt(o,!0),(h||at&&r(o))&&e(at,[o],t,c,st,!0));o=n._ob=st(n,i);typeof o===s&&(dt(o),(h||at&&r(o))&&e(at,[o],t,c,st,[i]));c(u,f)}}function dt(t,f,e,o){if(at){var s=n,h=ot;n=t;o&&(n=t[o],ot+="."+o,fi&&(n=u._fltr(o,t,ot,fi)));n&&(e||r(n))&&kt(v+".observe"+(c?".obs"+(pt=c._cId=c._cId||b++):""),i,!0,f);n=s;ot=h}}var yt,ri,ei,it,y,h,ui,k,c,pt,bt,et,a,st,oi,gt,ni,si,ti,ot,fi,at=this!=!1,hi=1,ii=ht,d=Array.apply(0,arguments),nt=d.pop(),wt=d.shift(),vt=wt,n=vt,tt=d.length;for(f(nt)?c=nt:(nt+""===nt&&(ot=nt,ti=d.pop(),fi=d.pop(),nt=d.pop(),tt=tt-3),nt===!0?k=nt:nt&&(wt=nt,hi=0),nt=d[tt-1],(tt&&nt===i||f(nt))&&(c=d.pop(),tt--)),tt&&f(d[tt-1])&&(st=c,c=d.pop(),tt--),ii+=k?c?".obs"+c._cId:"":".obs"+(pt=c._cId=c._cId||b++),k||(gt=p[pt]=p[pt]||{}),r(vt)?dt(vt,k,!0):k&&tt===0&&vt&&kt(ii,""),ni=0,yt=0;yt<tt;yt++)if(h=d[yt],h!==""){if(n=vt,""+h===h){if(it=h.split("^"),it[1]&&(ni=it[0].split(".").length,h=it.join("."),ni=h.split(".").length-ni),st&&(oi=st(h,vt))){tt+=oi.length-1;w.apply(d,[yt--,1].concat(oi));continue}it=h.split(".")}else hi&&!f(h)&&(h._jsvOb&&(k||(h._cb=si=ci(h,d.slice(yt+1)),si.noArray=at===!1,h._rt=wt,si._cId=c._cId),e(at,[h._rt],d.slice(0,yt),h._cb,st,k),h=h._ob),n=h),vt=h,it=[vt];while(n&&(y=it.shift())!==i)if(typeof n===s){if(""+y===y){if(y==="")continue;if(it.length<ni+1&&!n.nodeType){if(!k&&(a=rt(n)&&t._data(n))){for(a=a.events,a=a&&a[l],bt=a&&a.length,ei=0;bt--;)et=a[bt].data,et&&et.cb===c&&(et.prop===y||et.prop==="*")&&((ri=it.join("."))&&et.paths.push(ri),ei++);if(ei){n=n[y];continue}}if(y==="*"){!k&&a&&a.length&&kt(ii,"",!1,!0);f(n)?(ui=n.depends)&&e(at,[ui],c,k||wt):kt(ii,"");for(ri in n)dt(n,k,i,ri);break}else y&&kt(ii+"."+y,it.join("."))}ot&&(ot+="."+y);y=n[y]}if(f(y)){(ui=y.depends)&&e(at,[n],ut(ui,n),c,st,k||[wt]);break}n=y}dt(n,k)}return pt&&ft(gt,pt),{cbId:pt,bnd:gt,leaf:n}}function at(){return[].push.call(arguments,!0),y.apply(this,arguments)}function e(){var n=[].concat.apply([],arguments);return y.apply(n.shift(),n)}function et(n,t,i){return i.indexOf(".")<0&&i.indexOf("[")<0&&t[n]}function vt(n,r,u,f,e){return f=f||et,e=e||et,{getTgt:n,obsSrc:r,obsTgt:u,map:function(i){var o=this,h,c;return o.src!==i&&(o.src&&o.unmap(),typeof i===s&&(c=n.apply(o,arguments),t.observable&&(t.observable(i).observeAll(o.obs=function(n,t){!h&&r&&(h=!0,r.call(o,i,c,n,t),h=!1)},f),t.observable(c).observeAll(o.obt=function(n,t){!h&&u&&(h=!0,u.call(o,i,c,n,t),h=!1)},e)),o.src=i,o.tgt=c)),o},unmap:function(){if(t.observable){var n=this;n.src&&(t.observable(n.src).unobserveAll(n.obs,f),t.observable(n.tgt).unobserveAll(n.obt,e),n.src=n.tgt=i)}}}}function ot(n,t){a(this._data,n,t,[],"root")}function st(n,t){a(this._data,n,t,[],"root",!0)}function a(n,t,f,e,o,h){function v(n,i){for(l=n.length,c=o+"[]";l--;)(w=u._fltr(l,n,c,f))&&a(w,t,f||"",e.slice(0),c,i)}function k(n,i){o=n.data.observeAll._path;var r=e;e[0]!==n.target&&(e=e.slice(0),e.unshift(n.target));switch(i.change){case"insert":v(i.items);break;case"remove":v(i.items,!0);break;case"refresh":v(i.oldItems,!0);v(n.target);break;case"set":c=o+"."+i.path;a(i.oldValue,t,0,e.slice(0),c,!0);a(i.value,t,0,e.slice(0),c)}t.apply(this,arguments);e=r}var l,p,c,w;if(typeof n===s)if(p=r(n)?"":"*",e.unshift(n),t?(p||f!==0)&&(k._cId=t._cId=t._cId||b++,y(n,p,k,h,f,e.slice(),o)):y(n,p,i,h,f,e.slice(),o),p)for(l in n)l.charAt(0)!=="_"&&l!==it&&(c=o+"."+l,(w=u._fltr(l,n,c,f))&&a(w,t,f||0,e.slice(0),c,h));else v(n,h)}if(!t)throw"requires jQuery or JsRender";if(!t.observable){var o,nt,tt=t.event.special,h=t.views?t.views.sub:u.sub={},w=[].splice,r=t.isArray,it=t.expando,s="object",c=parseInt,l=h.propChng=h.propChng||"propertyChange",v=h.arrChng=h.arrChng||"arrayChange",p=h._cbBnds=h._cbBnds||{},ht=l+".observe",f=t.isFunction,ct=1,b=1,rt=t.hasData;h.DataMap=vt;t.observable=u;u._fltr=function(n,t,i,r){var u=r&&f(r)?r(n,t,i):t[n];return u&&(u=f(u)?u.set&&u.call(t):u),typeof u===s&&u};u.Object=k;u.Array=d;t.observe=u.observe=y;t.unobserve=u.unobserve=at;u._apply=e;k.prototype={_data:null,observeAll:ot,unobserveAll:st,data:function(){return this._data},setProperty:function(n,t,u){var f,h,s,e=this,o=e._data;if(n=n||"",o)if(r(n))for(f=n.length;f--;)h=n[f],e.setProperty(h.name,h.value,u===i||u);else if(""+n!==n)for(f in n)e.setProperty(f,n[f],t);else if(n!==it){for(s=n.split(".");o&&s.length>1;)o=o[s.shift()];e._setProperty(o,s.join("."),t,u)}return e},_setProperty:function(n,t,i,r){var e,o,u=t?n[t]:n;f(u)&&u.set&&(o=u,e=u.set===!0?u:u.set,u=u.call(n));(u!==i||r&&u!=i)&&(!(u instanceof Date)||u>i||u<i)&&(e?(e.call(n,i),i=o.call(n)):t&&(n[t]=i),this._trigger(n,{change:"set",path:t,value:i,oldValue:u}))},_trigger:function(n,i){t(n).triggerHandler(l,i)}};d.prototype={_data:null,observeAll:ot,unobserveAll:st,data:function(){return this._data},insert:function(n,t){var i=this._data;return arguments.length===1&&(t=n,n=i.length),n=c(n),n>-1&&n<=i.length&&(t=r(t)?t:[t],t.length&&this._insert(n,t)),this},_insert:function(n,t){var i=this._data,r=i.length;w.apply(i,[n,0].concat(t));this._trigger({change:"insert",index:n,items:t},r)},remove:function(n,t){var r,u=this._data;return n===i&&(n=u.length-1),n=c(n),t=t?c(t):t===0?0:1,t>-1&&n>-1&&(r=u.slice(n,n+t),t=r.length,t&&this._remove(n,t,r)),this},_remove:function(n,t,i){var r=this._data,u=r.length;r.splice(n,t);this._trigger({change:"remove",index:n,items:i},u)},move:function(n,t,i){if(i=i?c(i):i===0?0:1,n=c(n),t=c(t),i>0&&n>-1&&t>-1&&n!==t){var r=this._data.slice(n,n+i);i=r.length;i&&this._move(n,t,i,r)}return this},_move:function(n,t,i,r){var u=this._data,f=u.length;u.splice(n,i);u.splice.apply(u,[t,0].concat(r));this._trigger({change:"move",oldIndex:n,index:t,items:r},f)},refresh:function(n){var t=this._data.slice(0);return this._refresh(t,n),this},_refresh:function(n,t){var i=this._data,r=i.length;w.apply(i,[0,i.length].concat(t));this._trigger({change:"refresh",oldItems:n},r)},_trigger:function(n,i){var r=this._data,u=r.length,f=t([r]);f.triggerHandler(v,n);u!==i&&f.triggerHandler(l,{change:"set",path:"length",value:u,oldValue:i})}};tt[l]=tt[v]={remove:function(n){(n=n.data)&&(n.off=1,n=n.cb)&&(o=p[nt=n._cId])},teardown:function(){o&&(delete o[t.data(this,"obId")],ft(o,nt))}}}})(this,this.jQuery||this.jsviews);
/*
//# sourceMappingURL=jquery.observable.min.js.map
*/